#include "rwmake.ch"
#include "protheus.ch"

User Function JUNTABD()

Processa({||Junta()},"Junta Base de Dados")
Return

Static Function Junta()

/*
_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SC2010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY C2_FILIAL, C2_NUM, C2_ITEM, C2_SEQUEN, C2_ITEMGRD"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "C2_EMISSAO", "D" )
TcSetField( "QUERY", "C2_DATPRI", "D" )
TcSetField( "QUERY", "C2_DATPRF", "D" )
TcSetField( "QUERY", "C2_DATAJF", "D" )
TcSetField( "QUERY", "C2_DATRF", "D" )
TcSetField( "QUERY", "C2_DATAJI", "D" )
TcSetField( "QUERY", "C2_DTUPROG", "D" )
TcSetField( "QUERY", "C2_DTENTR", "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SC2 "+QUERY->(C2_FILIAL+C2_NUM+C2_ITEM+C2_SEQUEN+C2_ITEMGRD))
	
	dbSelectArea("SC2")
	dbSetOrder(1)
	If !dbSeek(QUERY->(C2_FILIAL+C2_NUM+C2_ITEM+C2_SEQUEN+C2_ITEMGRD),.F.)
		RecLock("SC2",.T.)
		SC2->C2_FILIAL:=QUERY->C2_FILIAL
		SC2->C2_NUM:=QUERY->C2_NUM
		SC2->C2_ITEM:=QUERY->C2_ITEM
		SC2->C2_SEQUEN:=QUERY->C2_SEQUEN
		SC2->C2_TIPO:=QUERY->C2_TIPO
		SC2->C2_PRODUTO:=QUERY->C2_PRODUTO
		SC2->C2_LOCAL:=QUERY->C2_LOCAL
		SC2->C2_CC:=QUERY->C2_CC
		SC2->C2_QUANT:=QUERY->C2_QUANT
		SC2->C2_UM:=QUERY->C2_UM
		SC2->C2_DATPRI:=QUERY->C2_DATPRI
		SC2->C2_DATPRF:=QUERY->C2_DATPRF
		SC2->C2_OBS:=QUERY->C2_OBS
		SC2->C2_EMISSAO:=QUERY->C2_EMISSAO
		SC2->C2_PRIOR:=QUERY->C2_PRIOR
		SC2->C2_QUJE:=QUERY->C2_QUJE
		SC2->C2_PERDA:=QUERY->C2_PERDA
		SC2->C2_DATAJF:=QUERY->C2_DATAJF
		SC2->C2_DATRF:=QUERY->C2_DATRF
		SC2->C2_STATUS:=QUERY->C2_STATUS
		SC2->C2_DESTINA:=QUERY->C2_DESTINA
		SC2->C2_VATU1:=QUERY->C2_VATU1
		SC2->C2_VINI1:=QUERY->C2_VINI1
		SC2->C2_VFIM1:=QUERY->C2_VFIM1
		SC2->C2_VATU2:=QUERY->C2_VATU2
		SC2->C2_VINI2:=QUERY->C2_VINI2
		SC2->C2_VFIM2:=QUERY->C2_VFIM2
		SC2->C2_VATU3:=QUERY->C2_VATU3
		SC2->C2_VINI3:=QUERY->C2_VINI3
		SC2->C2_VFIM3:=QUERY->C2_VFIM3
		SC2->C2_VATU4:=QUERY->C2_VATU4
		SC2->C2_VINI4:=QUERY->C2_VINI4
		SC2->C2_VFIM4:=QUERY->C2_VFIM4
		SC2->C2_VATU5:=QUERY->C2_VATU5
		SC2->C2_VINI5:=QUERY->C2_VINI5
		SC2->C2_VFIM5:=QUERY->C2_VFIM5
		SC2->C2_APRATU1:=QUERY->C2_APRATU1
		SC2->C2_APRINI1:=QUERY->C2_APRINI1
		SC2->C2_APRFIM1:=QUERY->C2_APRFIM1
		SC2->C2_APRATU2:=QUERY->C2_APRATU2
		SC2->C2_APRINI2:=QUERY->C2_APRINI2
		SC2->C2_APRFIM2:=QUERY->C2_APRFIM2
		SC2->C2_APRATU3:=QUERY->C2_APRATU3
		SC2->C2_APRINI3:=QUERY->C2_APRINI3
		SC2->C2_APRFIM3:=QUERY->C2_APRFIM3
		SC2->C2_APRATU4:=QUERY->C2_APRATU4
		SC2->C2_APRINI4:=QUERY->C2_APRINI4
		SC2->C2_APRFIM4:=QUERY->C2_APRFIM4
		SC2->C2_APRATU5:=QUERY->C2_APRATU5
		SC2->C2_APRINI5:=QUERY->C2_APRINI5
		SC2->C2_APRFIM5:=QUERY->C2_APRFIM5
		SC2->C2_NIVEL:=QUERY->C2_NIVEL
		SC2->C2_DATAJI:=QUERY->C2_DATAJI
		SC2->C2_AGLUT:=QUERY->C2_AGLUT
		SC2->C2_SEGUM:=QUERY->C2_SEGUM
		SC2->C2_OK:=QUERY->C2_OK
		SC2->C2_DTUPROG:=QUERY->C2_DTUPROG
		SC2->C2_QTUPROG:=QUERY->C2_QTUPROG
		SC2->C2_SEQPAI:=QUERY->C2_SEQPAI
		SC2->C2_HORAJI:=QUERY->C2_HORAJI
		SC2->C2_HORAJF:=QUERY->C2_HORAJF
		SC2->C2_ROTEIRO:=QUERY->C2_ROTEIRO
		SC2->C2_IDENT:=QUERY->C2_IDENT
		SC2->C2_RECURSO:=QUERY->C2_RECURSO
		SC2->C2_PV_TERC:=QUERY->C2_PV_TERC
		SC2->C2_IT_TERC:=QUERY->C2_IT_TERC
		SC2->C2_PEDIDO:=QUERY->C2_PEDIDO
		SC2->C2_ITEMPV:=QUERY->C2_ITEMPV
		SC2->C2_OPC:=QUERY->C2_OPC
		SC2->C2_QTSEGUM:=QUERY->C2_QTSEGUM
		SC2->C2_VINIFF1:=QUERY->C2_VINIFF1
		SC2->C2_VINIFF2:=QUERY->C2_VINIFF2
		SC2->C2_VINIFF3:=QUERY->C2_VINIFF3
		SC2->C2_VINIFF4:=QUERY->C2_VINIFF4
		SC2->C2_VINIFF5:=QUERY->C2_VINIFF5
		SC2->C2_VFIMFF1:=QUERY->C2_VFIMFF1
		SC2->C2_VFIMFF2:=QUERY->C2_VFIMFF2
		SC2->C2_VFIMFF3:=QUERY->C2_VFIMFF3
		SC2->C2_VFIMFF4:=QUERY->C2_VFIMFF4
		SC2->C2_VFIMFF5:=QUERY->C2_VFIMFF5
		SC2->C2_APINFF1:=QUERY->C2_APINFF1
		SC2->C2_APINFF2:=QUERY->C2_APINFF2
		SC2->C2_APINFF3:=QUERY->C2_APINFF3
		SC2->C2_APINFF4:=QUERY->C2_APINFF4
		SC2->C2_APINFF5:=QUERY->C2_APINFF5
		SC2->C2_APFIFF1:=QUERY->C2_APFIFF1
		SC2->C2_APFIFF2:=QUERY->C2_APFIFF2
		SC2->C2_APFIFF3:=QUERY->C2_APFIFF3
		SC2->C2_APFIFF4:=QUERY->C2_APFIFF4
		SC2->C2_APFIFF5:=QUERY->C2_APFIFF5
		SC2->C2_TPOP:=QUERY->C2_TPOP
		SC2->C2_REVI:=QUERY->C2_REVI
		SC2->C2_CHAVE:=QUERY->C2_CHAVE
		SC2->C2_CERQUA:=QUERY->C2_CERQUA
		SC2->C2_REVISAO:=QUERY->C2_REVISAO
		SC2->C2_OPERAC:=QUERY->C2_OPERAC
		SC2->C2_OPORI:=QUERY->C2_OPORI
		SC2->C2_URDUME:=QUERY->C2_URDUME
		SC2->C2_LAUDO:=QUERY->C2_LAUDO
		SC2->C2_LOTURTM:=QUERY->C2_LOTURTM
		SC2->C2_TRAMA:=QUERY->C2_TRAMA
		SC2->C2_LOTTRAM:=QUERY->C2_LOTTRAM
		SC2->C2_COR:=QUERY->C2_COR
		SC2->C2_TEAR:=QUERY->C2_TEAR
		SC2->C2_TERCEI:=QUERY->C2_TERCEI
		SC2->C2_DTENTR:=QUERY->C2_DTENTR
		SC2->C2_MOTTINT:=QUERY->C2_MOTTINT
		SC2->C2_POSICOP:=QUERY->C2_POSICOP
		SC2->C2_PECAS_1:=QUERY->C2_PECAS_1
		SC2->C2_QUANT_1:=QUERY->C2_QUANT_1
		SC2->C2_PECAS_2:=QUERY->C2_PECAS_2
		SC2->C2_QUANT_2:=QUERY->C2_QUANT_2
		SC2->C2_PECAS_3:=QUERY->C2_PECAS_3
		SC2->C2_QUANT_3:=QUERY->C2_QUANT_3
		SC2->C2_PECAS_4:=QUERY->C2_PECAS_4
		SC2->C2_QUANT_4:=QUERY->C2_QUANT_4
		SC2->C2_PECAS_5:=QUERY->C2_PECAS_5
		SC2->C2_QUANT_5:=QUERY->C2_QUANT_5
		SC2->C2_PECAS_6:=QUERY->C2_PECAS_6
		SC2->C2_QUANT_6:=QUERY->C2_QUANT_6
		SC2->C2_PECAS_7:=QUERY->C2_PECAS_7
		SC2->C2_QUANT_7:=QUERY->C2_QUANT_7
		SC2->C2_PECAS_8:=QUERY->C2_PECAS_8
		SC2->C2_QUANT_8:=QUERY->C2_QUANT_8
		SC2->C2_PECAS_9:=QUERY->C2_PECAS_9
		SC2->C2_QUANT_9:=QUERY->C2_QUANT_9
		SC2->C2_PECAS_A:=QUERY->C2_PECAS_A
		SC2->C2_QUANT_A:=QUERY->C2_QUANT_A
		SC2->C2_PECAS_B:=QUERY->C2_PECAS_B
		SC2->C2_QUANT_B:=QUERY->C2_QUANT_B
		SC2->C2_PECAS_C:=QUERY->C2_PECAS_C
		SC2->C2_QUANT_C:=QUERY->C2_QUANT_C
		SC2->C2_PECAS_D:=QUERY->C2_PECAS_D
		SC2->C2_QUANT_D:=QUERY->C2_QUANT_D
		SC2->C2_PECAS_E:=QUERY->C2_PECAS_E
		SC2->C2_QUANT_E:=QUERY->C2_QUANT_E
		SC2->C2_PECAS_F:=QUERY->C2_PECAS_F
		SC2->C2_QUANT_F:=QUERY->C2_QUANT_F
		SC2->C2_PECAS_G:=QUERY->C2_PECAS_G
		SC2->C2_QUANT_G:=QUERY->C2_QUANT_G
		SC2->C2_PECAS:=QUERY->C2_PECAS
		SC2->C2_NF_TERC:=QUERY->C2_NF_TERC
		SC2->C2_CP_TERC:=QUERY->C2_CP_TERC
		SC2->C2_PR_TERC:=QUERY->C2_PR_TERC
		SC2->C2_GRADE:=QUERY->C2_GRADE
		SC2->C2_ITEMGRD:=QUERY->C2_ITEMGRD
		SC2->C2_ITEMCTA:=QUERY->C2_ITEMCTA
		SC2->C2_CLVL:=QUERY->C2_CLVL
		SC2->C2_VERIFI:=QUERY->C2_VERIFI
		SC2->C2_GRUPO:=QUERY->C2_GRUPO
		SC2->C2_IDEINV:=QUERY->C2_IDEINV
		SC2->C2_CHVQIP:=QUERY->C2_CHVQIP
		SC2->C2_SEQMRP:=QUERY->C2_SEQMRP
		SC2->C2_NF_AGLU:=QUERY->C2_NF_AGLU
		SC2->C2_PV_AGLU:=QUERY->C2_PV_AGLU
		SC2->C2_X_CODCL:=QUERY->C2_X_CODCL
		SC2->C2_X_LOJCL:=QUERY->C2_X_LOJCL
		SC2->C2_X_NOMCL:=QUERY->C2_X_NOMCL
		SC2->C2_LINHA:=QUERY->C2_LINHA
		SC2->C2_USERLGI:=QUERY->C2_USERLGI
		SC2->C2_USERLGA:=QUERY->C2_USERLGA
		SC2->C2_PEDCLI:=QUERY->C2_PEDCLI
		SC2->C2_PMACNUT:=QUERY->C2_PMACNUT
		SC2->C2_PMICNUT:=QUERY->C2_PMICNUT
		SC2->C2_X_FACCI:=QUERY->C2_X_FACCI
		SC2->C2_X_BLOQU:=QUERY->C2_X_BLOQU
		SC2->C2_VFIMRP1:=QUERY->C2_VFIMRP1
		SC2->C2_VFIMRP2:=QUERY->C2_VFIMRP2
		SC2->C2_VFIMRP3:=QUERY->C2_VFIMRP3
		SC2->C2_VFIMRP4:=QUERY->C2_VFIMRP4
		SC2->C2_VFIMRP5:=QUERY->C2_VFIMRP5
		SC2->C2_VINIRP1:=QUERY->C2_VINIRP1
		SC2->C2_VINIRP2:=QUERY->C2_VINIRP2
		SC2->C2_VINIRP3:=QUERY->C2_VINIRP3
		SC2->C2_VINIRP4:=QUERY->C2_VINIRP4
		SC2->C2_VINIRP5:=QUERY->C2_VINIRP5
		SC2->C2_APRIRP1:=QUERY->C2_APRIRP1
		SC2->C2_APRIRP2:=QUERY->C2_APRIRP2
		SC2->C2_APRIRP3:=QUERY->C2_APRIRP3
		SC2->C2_APRIRP4:=QUERY->C2_APRIRP4
		SC2->C2_APRIRP5:=QUERY->C2_APRIRP5
		SC2->C2_APRFRP1:=QUERY->C2_APRFRP1
		SC2->C2_APRFRP2:=QUERY->C2_APRFRP2
		SC2->C2_APRFRP3:=QUERY->C2_APRFRP3
		SC2->C2_APRFRP4:=QUERY->C2_APRFRP4
		SC2->C2_APRFRP5:=QUERY->C2_APRFRP5
		SC2->C2_PROGRAM:=QUERY->C2_PROGRAM
		SC2->C2_BATUSR:=QUERY->C2_BATUSR
		SC2->C2_BATROT:=QUERY->C2_BATROT
		SC2->C2_BATCH:=QUERY->C2_BATCH
		SC2->C2_BATORCA:=QUERY->C2_BATORCA
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SC5010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY C5_FILIAL, C5_NUM"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "C5_EMISSAO", "D" )
TcSetField( "QUERY", "C5_DATA1"  , "D" )
TcSetField( "QUERY", "C5_DATA2"  , "D" )
TcSetField( "QUERY", "C5_DATA3"  , "D" )
TcSetField( "QUERY", "C5_DATA4"  , "D" )
TcSetField( "QUERY", "C5_DATA5"  , "D" )
TcSetField( "QUERY", "C5_DATA6"  , "D" )
TcSetField( "QUERY", "C5_DATA7"  , "D" )
TcSetField( "QUERY", "C5_DATA8"  , "D" )
TcSetField( "QUERY", "C5_DTLANC" , "D" )
TcSetField( "QUERY", "C5_FECENT" , "D" )
TcSetField( "QUERY", "C5_SUGENT" , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SC5 "+QUERY->(C5_FILIAL+C5_NUM))
	
	dbSelectArea("SC5")
	dbSetOrder(1)
	If !dbSeek(QUERY->(C5_FILIAL+C5_NUM),.F.)
		RecLock("SC5",.T.)
		SC5->C5_FILIAL:=QUERY->C5_FILIAL
		SC5->C5_NUM:=QUERY->C5_NUM
		SC5->C5_PEDCLI:=QUERY->C5_PEDCLI
		SC5->C5_TIPO:=QUERY->C5_TIPO
		SC5->C5_CLIENTE:=QUERY->C5_CLIENTE
		SC5->C5_LOJAENT:=QUERY->C5_LOJAENT
		SC5->C5_LOJACLI:=QUERY->C5_LOJACLI
		SC5->C5_TRANSP:=QUERY->C5_TRANSP
		SC5->C5_TIPOCLI:=QUERY->C5_TIPOCLI
		SC5->C5_CONDPAG:=QUERY->C5_CONDPAG
		SC5->C5_TABELA:=QUERY->C5_TABELA
		SC5->C5_PAPELET:=QUERY->C5_PAPELET
		SC5->C5_TPCOBR:=QUERY->C5_TPCOBR
		SC5->C5_VEND1:=QUERY->C5_VEND1
		SC5->C5_NATUREZ:=QUERY->C5_NATUREZ
		SC5->C5_COMIS1:=QUERY->C5_COMIS1
		SC5->C5_VEND2:=QUERY->C5_VEND2
		SC5->C5_COMIS2:=QUERY->C5_COMIS2
		SC5->C5_VEND3:=QUERY->C5_VEND3
		SC5->C5_COMIS3:=QUERY->C5_COMIS3
		SC5->C5_VEND4:=QUERY->C5_VEND4
		SC5->C5_COMIS4:=QUERY->C5_COMIS4
		SC5->C5_VEND5:=QUERY->C5_VEND5
		SC5->C5_COMIS5:=QUERY->C5_COMIS5
		SC5->C5_DESC1:=QUERY->C5_DESC1
		SC5->C5_DESC2:=QUERY->C5_DESC2
		SC5->C5_DESC3:=QUERY->C5_DESC3
		SC5->C5_DESC4:=QUERY->C5_DESC4
		SC5->C5_BANCO:=QUERY->C5_BANCO
		SC5->C5_DESCFI:=QUERY->C5_DESCFI
		SC5->C5_EMISSAO:=QUERY->C5_EMISSAO
		SC5->C5_COTACAO:=QUERY->C5_COTACAO
		SC5->C5_PARC1:=QUERY->C5_PARC1
		SC5->C5_DATA1:=QUERY->C5_DATA1
		SC5->C5_PARC2:=QUERY->C5_PARC2
		SC5->C5_DATA2:=QUERY->C5_DATA2
		SC5->C5_PARC3:=QUERY->C5_PARC3
		SC5->C5_DATA3:=QUERY->C5_DATA3
		SC5->C5_PARC4:=QUERY->C5_PARC4
		SC5->C5_DATA4:=QUERY->C5_DATA4
		SC5->C5_TPFRETE:=QUERY->C5_TPFRETE
		SC5->C5_FRETE:=QUERY->C5_FRETE
		SC5->C5_SEGURO:=QUERY->C5_SEGURO
		SC5->C5_DESPESA:=QUERY->C5_DESPESA
		SC5->C5_FRETAUT:=QUERY->C5_FRETAUT
		SC5->C5_REAJUST:=QUERY->C5_REAJUST
		SC5->C5_MOEDA:=QUERY->C5_MOEDA
		SC5->C5_VOLUME1:=QUERY->C5_VOLUME1
		SC5->C5_PESOL:=QUERY->C5_PESOL
		SC5->C5_PBRUTO:=QUERY->C5_PBRUTO
		SC5->C5_REIMP:=QUERY->C5_REIMP
		SC5->C5_REDESP:=QUERY->C5_REDESP
		SC5->C5_VOLUME2:=QUERY->C5_VOLUME2
		SC5->C5_VOLUME3:=QUERY->C5_VOLUME3
		SC5->C5_VOLUME4:=QUERY->C5_VOLUME4
		SC5->C5_ESPECI1:=QUERY->C5_ESPECI1
		SC5->C5_ESPECI2:=QUERY->C5_ESPECI2
		SC5->C5_ESPECI3:=QUERY->C5_ESPECI3
		SC5->C5_ESPECI4:=QUERY->C5_ESPECI4
		SC5->C5_ACRSFIN:=QUERY->C5_ACRSFIN
		SC5->C5_MENNOTA:=QUERY->C5_MENNOTA
		SC5->C5_MENPAD:=QUERY->C5_MENPAD
		SC5->C5_OBSVEN1:=QUERY->C5_OBSVEN1
		SC5->C5_OBSVEN2:=QUERY->C5_OBSVEN2
		SC5->C5_INCISS:=QUERY->C5_INCISS
		SC5->C5_LIBEROK:=QUERY->C5_LIBEROK
		SC5->C5_OK:=QUERY->C5_OK
		SC5->C5_NOTA:=QUERY->C5_NOTA
		SC5->C5_SERIE:=QUERY->C5_SERIE
		SC5->C5_VENDA:=QUERY->C5_VENDA
		SC5->C5_KITREP:=QUERY->C5_KITREP
		SC5->C5_TIPLIB:=QUERY->C5_TIPLIB
		SC5->C5_OS:=QUERY->C5_OS
		SC5->C5_DESCPON:=QUERY->C5_DESCPON
		SC5->C5_NF_TERC:=QUERY->C5_NF_TERC
		SC5->C5_SERVICO:=QUERY->C5_SERVICO
		SC5->C5_DESCONT:=QUERY->C5_DESCONT
		SC5->C5_PEDEXP:=QUERY->C5_PEDEXP
		SC5->C5_TXMOEDA:=QUERY->C5_TXMOEDA
		SC5->C5_TPCARGA:=QUERY->C5_TPCARGA
		SC5->C5_PREPEMB:=QUERY->C5_PREPEMB
		SC5->C5_CLIENT:=QUERY->C5_CLIENT
		SC5->C5_PDESCAB:=QUERY->C5_PDESCAB
		SC5->C5_BLQ:=QUERY->C5_BLQ
		SC5->C5_X_NREDU:=QUERY->C5_X_NREDU
		SC5->C5_FORNISS:=QUERY->C5_FORNISS
		SC5->C5_CONTRA:=QUERY->C5_CONTRA
		SC5->C5_VLR_FRT:=QUERY->C5_VLR_FRT
		SC5->C5_USERLGI:=QUERY->C5_USERLGI
		SC5->C5_USERLGA:=QUERY->C5_USERLGA
		SC5->C5_RECISS:=QUERY->C5_RECISS
		SC5->C5_RECFAUT:=QUERY->C5_RECFAUT
		SC5->C5_PARC5:=QUERY->C5_PARC5
		SC5->C5_DATA5:=QUERY->C5_DATA5
		SC5->C5_PARC6:=QUERY->C5_PARC6
		SC5->C5_DATA6:=QUERY->C5_DATA6
		SC5->C5_PARC7:=QUERY->C5_PARC7
		SC5->C5_DATA7:=QUERY->C5_DATA7
		SC5->C5_PARC8:=QUERY->C5_PARC8
		SC5->C5_DATA8:=QUERY->C5_DATA8
		SC5->C5_DTLANC:=QUERY->C5_DTLANC
		SC5->C5_MDCONTR:=QUERY->C5_MDCONTR
		SC5->C5_MDNUMED:=QUERY->C5_MDNUMED
		SC5->C5_GERAWMS:=QUERY->C5_GERAWMS
		SC5->C5_MDPLANI:=QUERY->C5_MDPLANI
		SC5->C5_SOLFRE:=QUERY->C5_SOLFRE
		SC5->C5_FECENT:=QUERY->C5_FECENT
		SC5->C5_SOLOPC:=QUERY->C5_SOLOPC
		SC5->C5_SUGENT:=QUERY->C5_SUGENT
		SC5->C5_CODED:=QUERY->C5_CODED
		SC5->C5_NUMPR:=QUERY->C5_NUMPR
		SC5->C5_ORCRES:=QUERY->C5_ORCRES
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SC6010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY C6_FILIAL, C6_NUM, C6_ITEM, C6_PRODUTO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "C6_ENTREG"  , "D" )
TcSetField( "QUERY", "C6_TINTURA" , "D" )
TcSetField( "QUERY", "C6_TECELAG" , "D" )
TcSetField( "QUERY", "C6_DTVALID" , "D" )
TcSetField( "QUERY", "C6_DATFAT" , "D" )
TcSetField( "QUERY", "C6_SUGENTR" , "D" )


dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SC6 "+QUERY->(C6_FILIAL+C6_NUM+C6_ITEM+C6_PRODUTO))
	
	dbSelectArea("SC6")
	dbSetOrder(1)
	If !dbSeek(QUERY->(C6_FILIAL+C6_NUM+C6_ITEM+C6_PRODUTO),.F.)
		RecLock("SC6",.T.)
		SC6->C6_FILIAL:=QUERY->C6_FILIAL
		SC6->C6_ITEM:=QUERY->C6_ITEM
		SC6->C6_PRODUTO:=QUERY->C6_PRODUTO
		SC6->C6_UM:=QUERY->C6_UM
		SC6->C6_FORMATO:=QUERY->C6_FORMATO
		SC6->C6_BARRAS:=QUERY->C6_BARRAS
		SC6->C6_TES:=QUERY->C6_TES
		SC6->C6_CF:=QUERY->C6_CF
		SC6->C6_QTDVEN:=QUERY->C6_QTDVEN
		SC6->C6_PRCVEN:=QUERY->C6_PRCVEN
		SC6->C6_VALOR:=QUERY->C6_VALOR
		SC6->C6_QTDLIB:=QUERY->C6_QTDLIB
		SC6->C6_SEGUM:=QUERY->C6_SEGUM
		SC6->C6_UNSVEN:=QUERY->C6_UNSVEN
		SC6->C6_LOCAL:=QUERY->C6_LOCAL
		SC6->C6_QTDEMP:=QUERY->C6_QTDEMP
		SC6->C6_QTDENT:=QUERY->C6_QTDENT
		SC6->C6_CLI:=QUERY->C6_CLI
		SC6->C6_DESCONT:=QUERY->C6_DESCONT
		SC6->C6_VALDESC:=QUERY->C6_VALDESC
		SC6->C6_ENTREG:=QUERY->C6_ENTREG
		SC6->C6_TECELAG:=QUERY->C6_TECELAG
		SC6->C6_TINTURA:=QUERY->C6_TINTURA
		SC6->C6_LA:=QUERY->C6_LA
		SC6->C6_LOJA:=QUERY->C6_LOJA
		SC6->C6_NOTA:=QUERY->C6_NOTA
		SC6->C6_SERIE:=QUERY->C6_SERIE
		SC6->C6_DATFAT:=QUERY->C6_DATFAT
		SC6->C6_NUM:=QUERY->C6_NUM
		SC6->C6_COMIS1:=QUERY->C6_COMIS1
		SC6->C6_COMIS2:=QUERY->C6_COMIS2
		SC6->C6_COMIS3:=QUERY->C6_COMIS3
		SC6->C6_COMIS4:=QUERY->C6_COMIS4
		SC6->C6_COMIS5:=QUERY->C6_COMIS5
		SC6->C6_PEDCLI:=QUERY->C6_PEDCLI
		SC6->C6_DESCRI:=QUERY->C6_DESCRI
		SC6->C6_PRUNIT:=QUERY->C6_PRUNIT
		SC6->C6_BLOQUEI:=QUERY->C6_BLOQUEI
		SC6->C6_GEROUPV:=QUERY->C6_GEROUPV
		SC6->C6_RESERVA:=QUERY->C6_RESERVA
		SC6->C6_OP:=QUERY->C6_OP
		SC6->C6_OK:=QUERY->C6_OK
		SC6->C6_NFORI:=QUERY->C6_NFORI
		SC6->C6_SERIORI:=QUERY->C6_SERIORI
		SC6->C6_ITEMORI:=QUERY->C6_ITEMORI
		SC6->C6_IPIDEV:=QUERY->C6_IPIDEV
		SC6->C6_IDENTB6:=QUERY->C6_IDENTB6
		SC6->C6_BLQ:=QUERY->C6_BLQ
		SC6->C6_PICMRET:=QUERY->C6_PICMRET
		SC6->C6_CODISS:=QUERY->C6_CODISS
		SC6->C6_GRADE:=QUERY->C6_GRADE
		SC6->C6_ITEMGRD:=QUERY->C6_ITEMGRD
		SC6->C6_LOTECTL:=QUERY->C6_LOTECTL
		SC6->C6_NUMLOTE:=QUERY->C6_NUMLOTE
		SC6->C6_DTVALID:=QUERY->C6_DTVALID
		SC6->C6_NUMORC:=QUERY->C6_NUMORC
		SC6->C6_CHASSI:=QUERY->C6_CHASSI
		SC6->C6_OPC:=QUERY->C6_OPC
		SC6->C6_NUMOP:=QUERY->C6_NUMOP
		SC6->C6_LOCALIZ:=QUERY->C6_LOCALIZ
		SC6->C6_NUMSERI:=QUERY->C6_NUMSERI
		SC6->C6_ITEMOP:=QUERY->C6_ITEMOP
		SC6->C6_CLASFIS:=QUERY->C6_CLASFIS
		SC6->C6_QTDRESE:=QUERY->C6_QTDRESE
		SC6->C6_NUMOS:=QUERY->C6_NUMOS
		SC6->C6_NUMOSFA:=QUERY->C6_NUMOSFA
		SC6->C6_CODFAB:=QUERY->C6_CODFAB
		SC6->C6_LOJAFA:=QUERY->C6_LOJAFA
		SC6->C6_TPOP:=QUERY->C6_TPOP
		SC6->C6_REVISAO:=QUERY->C6_REVISAO
		SC6->C6_VEND1:=QUERY->C6_VEND1
		SC6->C6_VEND2:=QUERY->C6_VEND2
		SC6->C6_VEND3:=QUERY->C6_VEND3
		SC6->C6_VEND4:=QUERY->C6_VEND4
		SC6->C6_VEND5:=QUERY->C6_VEND5
		SC6->C6_QTDLIB2:=QUERY->C6_QTDLIB2
		SC6->C6_QTDENT2:=QUERY->C6_QTDENT2
		SC6->C6_SERVIC:=QUERY->C6_SERVIC
		SC6->C6_ENDPAD:=QUERY->C6_ENDPAD
		SC6->C6_CONTRT:=QUERY->C6_CONTRT
		SC6->C6_TPCONTR:=QUERY->C6_TPCONTR
		SC6->C6_ITCONTR:=QUERY->C6_ITCONTR
		SC6->C6_PROJPMS:=QUERY->C6_PROJPMS
		SC6->C6_TASKPMS:=QUERY->C6_TASKPMS
		SC6->C6_LICITA:=QUERY->C6_LICITA
		SC6->C6_QTDEMP2:=QUERY->C6_QTDEMP2
		SC6->C6_CONTRAT:=QUERY->C6_CONTRAT
		SC6->C6_ITEMCON:=QUERY->C6_ITEMCON
		SC6->C6_TPESTR:=QUERY->C6_TPESTR
		SC6->C6_EDTPMS:=QUERY->C6_EDTPMS
		SC6->C6_TRT:=QUERY->C6_TRT
		SC6->C6_PROJET:=QUERY->C6_PROJET
		SC6->C6_ITPROJ:=QUERY->C6_ITPROJ
		SC6->C6_POTENCI:=QUERY->C6_POTENCI
		SC6->C6_REGWMS:=QUERY->C6_REGWMS
		SC6->C6_NUMCP:=QUERY->C6_NUMCP
		SC6->C6_NUMSC:=QUERY->C6_NUMSC
		SC6->C6_ITEMSC:=QUERY->C6_ITEMSC
		SC6->C6_SUGENTR:=QUERY->C6_SUGENTR
		SC6->C6_USERLGI:=QUERY->C6_USERLGI
		SC6->C6_USERLGA:=QUERY->C6_USERLGA
		SC6->C6_QT2LIB:=QUERY->C6_QT2LIB
		SC6->C6_ABSCINS:=QUERY->C6_ABSCINS
		SC6->C6_ABATISS:=QUERY->C6_ABATISS
		SC6->C6_ABATMAT:=QUERY->C6_ABATMAT
		SC6->C6_ITEMED:=QUERY->C6_ITEMED
		SC6->C6_FUNRURA:=QUERY->C6_FUNRURA
		SC6->C6_FETAB:=QUERY->C6_FETAB
		SC6->C6_CODROM:=QUERY->C6_CODROM
		SC6->C6_PROGRAM:=QUERY->C6_PROGRAM
		SC6->C6_TURNO:=QUERY->C6_TURNO
		SC6->C6_PEDCOM:=QUERY->C6_PEDCOM
		SC6->C6_PVCOMOP:=QUERY->C6_PVCOMOP
		SC6->C6_FILPED:=QUERY->C6_FILPED
		SC6->C6_ITPC:=QUERY->C6_ITPC
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")



_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SC7010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY C7_FILIAL, C7_NUM, C7_ITEM, C7_SEQUEN"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "C7_EMISSAO"  , "D" )
TcSetField( "QUERY", "C7_KULTCOM"  , "D" )
TcSetField( "QUERY", "C7_DATPRF"  , "D" )
TcSetField( "QUERY", "C7_DTLANC"  , "D" )
TcSetField( "QUERY", "C7_DT_IMP"  , "D" )
TcSetField( "QUERY", "C7_DT_EMB"  , "D" )
TcSetField( "QUERY", "C7_CONF_PE"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SC7 "+QUERY->(C7_FILIAL+C7_NUM+C7_ITEM+C7_SEQUEN))
	
	dbSelectArea("SC7")
	dbSetOrder(1)
	If !dbSeek(QUERY->(C7_FILIAL+C7_NUM+C7_ITEM+C7_SEQUEN),.F.)
		RecLock("SC7",.T.)
		SC7->C7_FILIAL:=QUERY->C7_FILIAL
		SC7->C7_TIPO:=QUERY->C7_TIPO
		SC7->C7_ITEM:=QUERY->C7_ITEM
		SC7->C7_PRODUTO:=QUERY->C7_PRODUTO
		SC7->C7_QUANT:=QUERY->C7_QUANT
		SC7->C7_QUJE:=QUERY->C7_QUJE
		SC7->C7_PRECO:=QUERY->C7_PRECO
		SC7->C7_KULTPRC:=QUERY->C7_KULTPRC
		SC7->C7_KULTCPG:=QUERY->C7_KULTCPG
		SC7->C7_KULTCOM:=QUERY->C7_KULTCOM
		SC7->C7_TOTAL:=QUERY->C7_TOTAL
		SC7->C7_UM:=QUERY->C7_UM
		SC7->C7_SEGUM:=QUERY->C7_SEGUM
		SC7->C7_QTSEGUM:=QUERY->C7_QTSEGUM
		SC7->C7_IPI:=QUERY->C7_IPI
		SC7->C7_NUMSC:=QUERY->C7_NUMSC
		SC7->C7_ITEMSC:=QUERY->C7_ITEMSC
		SC7->C7_DATPRF:=QUERY->C7_DATPRF
		SC7->C7_LOCAL:=QUERY->C7_LOCAL
		SC7->C7_OBS:=QUERY->C7_OBS
		SC7->C7_FORNECE:=QUERY->C7_FORNECE
		SC7->C7_CC:=QUERY->C7_CC
		SC7->C7_CONTA:=QUERY->C7_CONTA
		SC7->C7_ITEMCTA:=QUERY->C7_ITEMCTA
		SC7->C7_LOJA:=QUERY->C7_LOJA
		SC7->C7_COND:=QUERY->C7_COND
		SC7->C7_CONTATO:=QUERY->C7_CONTATO
		SC7->C7_FILENT:=QUERY->C7_FILENT
		SC7->C7_DESC1:=QUERY->C7_DESC1
		SC7->C7_DESC2:=QUERY->C7_DESC2
		SC7->C7_DESC3:=QUERY->C7_DESC3
		SC7->C7_EMISSAO:=QUERY->C7_EMISSAO
		SC7->C7_NUM:=QUERY->C7_NUM
		SC7->C7_REAJUST:=QUERY->C7_REAJUST
		SC7->C7_FRETE:=QUERY->C7_FRETE
		SC7->C7_EMITIDO:=QUERY->C7_EMITIDO
		SC7->C7_DESCRI:=QUERY->C7_DESCRI
		SC7->C7_TPFRETE:=QUERY->C7_TPFRETE
		SC7->C7_QTDREEM:=QUERY->C7_QTDREEM
		SC7->C7_CODLIB:=QUERY->C7_CODLIB
		SC7->C7_RESIDUO:=QUERY->C7_RESIDUO
		SC7->C7_NUMCOT:=QUERY->C7_NUMCOT
		SC7->C7_MSG:=QUERY->C7_MSG
		SC7->C7_TX:=QUERY->C7_TX
		SC7->C7_CONTROL:=QUERY->C7_CONTROL
		SC7->C7_IPIBRUT:=QUERY->C7_IPIBRUT
		SC7->C7_ENCER:=QUERY->C7_ENCER
		SC7->C7_OP:=QUERY->C7_OP
		SC7->C7_VLDESC:=QUERY->C7_VLDESC
		SC7->C7_SEQUEN:=QUERY->C7_SEQUEN
		SC7->C7_NUMIMP:=QUERY->C7_NUMIMP
		SC7->C7_ORIGEM:=QUERY->C7_ORIGEM
		SC7->C7_QTDACLA:=QUERY->C7_QTDACLA
		SC7->C7_VALEMB:=QUERY->C7_VALEMB
		SC7->C7_FLUXO:=QUERY->C7_FLUXO
		SC7->C7_TPOP:=QUERY->C7_TPOP
		SC7->C7_APROV:=QUERY->C7_APROV
		SC7->C7_CONAPRO:=QUERY->C7_CONAPRO
		SC7->C7_GRUPCOM:=QUERY->C7_GRUPCOM
		SC7->C7_USER:=QUERY->C7_USER
		SC7->C7_STATME:=QUERY->C7_STATME
		SC7->C7_OK:=QUERY->C7_OK
		SC7->C7_KAPROVA:=QUERY->C7_KAPROVA
		SC7->C7_BASEICM:=QUERY->C7_BASEICM
		SC7->C7_BASEIPI:=QUERY->C7_BASEIPI
		SC7->C7_DESC:=QUERY->C7_DESC
		SC7->C7_DESPESA:=QUERY->C7_DESPESA
		SC7->C7_MOEDA:=QUERY->C7_MOEDA
		SC7->C7_PENDEN:=QUERY->C7_PENDEN
		SC7->C7_PICM:=QUERY->C7_PICM
		SC7->C7_QTDSOL:=QUERY->C7_QTDSOL
		SC7->C7_SEGURO:=QUERY->C7_SEGURO
		SC7->C7_TES:=QUERY->C7_TES
		SC7->C7_TXMOEDA:=QUERY->C7_TXMOEDA
		SC7->C7_VALFRE:=QUERY->C7_VALFRE
		SC7->C7_VALICM:=QUERY->C7_VALICM
		SC7->C7_VALIPI:=QUERY->C7_VALIPI
		SC7->C7_CLVL:=QUERY->C7_CLVL
		SC7->C7_BASEIR:=QUERY->C7_BASEIR
		SC7->C7_ALIQIR:=QUERY->C7_ALIQIR
		SC7->C7_VALIR:=QUERY->C7_VALIR
		SC7->C7_ICMCOMP:=QUERY->C7_ICMCOMP
		SC7->C7_ICMSRET:=QUERY->C7_ICMSRET
		SC7->C7_SEQMRP:=QUERY->C7_SEQMRP
		SC7->C7_CODORCA:=QUERY->C7_CODORCA
		SC7->C7_DTLANC:=QUERY->C7_DTLANC
		SC7->C7_CODTAB:=QUERY->C7_CODTAB
		SC7->C7_CODCRED:=QUERY->C7_CODCRED
		SC7->C7_TIPOEMP:=QUERY->C7_TIPOEMP
		SC7->C7_ESPEMP:=QUERY->C7_ESPEMP
		SC7->C7_KCUSTD:=QUERY->C7_KCUSTD
		SC7->C7_CONTRA:=QUERY->C7_CONTRA
		SC7->C7_CONTREV:=QUERY->C7_CONTREV
		SC7->C7_PLANILH:=QUERY->C7_PLANILH
		SC7->C7_MEDICAO:=QUERY->C7_MEDICAO
		SC7->C7_ITEMED:=QUERY->C7_ITEMED
		SC7->C7_POLREPR:=QUERY->C7_POLREPR
		SC7->C7_PERREPR:=QUERY->C7_PERREPR
		SC7->C7_BASESOL:=QUERY->C7_BASESOL
		SC7->C7_USERLGI:=QUERY->C7_USERLGI
		SC7->C7_USERLGA:=QUERY->C7_USERLGA
		SC7->C7_VALSOL:=QUERY->C7_VALSOL
		SC7->C7_APROVA:=QUERY->C7_APROVA
		SC7->C7_FREPPCC:=QUERY->C7_FREPPCC
		SC7->C7_DT_IMP:=QUERY->C7_DT_IMP
		SC7->C7_GRADE:=QUERY->C7_GRADE
		SC7->C7_AGENTE:=QUERY->C7_AGENTE
		SC7->C7_ITEMGRD:=QUERY->C7_ITEMGRD
		SC7->C7_FORWARD:=QUERY->C7_FORWARD
		SC7->C7_TIPO_EM:=QUERY->C7_TIPO_EM
		SC7->C7_ORIGIMP:=QUERY->C7_ORIGIMP
		SC7->C7_DEST:=QUERY->C7_DEST
		SC7->C7_COMPRA:=QUERY->C7_COMPRA
		SC7->C7_PESO_B:=QUERY->C7_PESO_B
		SC7->C7_INCOTER:=QUERY->C7_INCOTER
		SC7->C7_IMPORT:=QUERY->C7_IMPORT
		SC7->C7_CONSIG:=QUERY->C7_CONSIG
		SC7->C7_CONF_PE:=QUERY->C7_CONF_PE
		SC7->C7_DESP:=QUERY->C7_DESP
		SC7->C7_EXPORTA:=QUERY->C7_EXPORTA
		SC7->C7_LOJAEXP:=QUERY->C7_LOJAEXP
		SC7->C7_CONTAIN:=QUERY->C7_CONTAIN
		SC7->C7_MT3:=QUERY->C7_MT3
		SC7->C7_CONTA20:=QUERY->C7_CONTA20
		SC7->C7_CONTA40:=QUERY->C7_CONTA40
		SC7->C7_CON40HC:=QUERY->C7_CON40HC
		SC7->C7_ARMAZEM:=QUERY->C7_ARMAZEM
		SC7->C7_FABRICA:=QUERY->C7_FABRICA
		SC7->C7_LOJFABR:=QUERY->C7_LOJFABR
		SC7->C7_DT_EMB:=QUERY->C7_DT_EMB
		SC7->C7_TEC:=QUERY->C7_TEC
		SC7->C7_EX_NCM:=QUERY->C7_EX_NCM
		SC7->C7_EX_NBM:=QUERY->C7_EX_NBM
		SC7->C7_DIACTB:=QUERY->C7_DIACTB
		SC7->C7_NODIA:=QUERY->C7_NODIA
		SC7->C7_CODED:=QUERY->C7_CODED
		SC7->C7_NUMPR:=QUERY->C7_NUMPR
		SC7->C7_FILCEN:=QUERY->C7_FILCEN
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo


DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SC9010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY C9_FILIAL, C9_PEDIDO, C9_ITEM, C9_SEQUEN, C9_PRODUTO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "C9_DATALIB"  , "D" )
TcSetField( "QUERY", "C9_DTVALID"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SC9 "+QUERY->(C9_FILIAL+C9_PEDIDO+C9_ITEM+C9_SEQUEN+C9_PRODUTO))
	
	dbSelectArea("SC9")
	dbSetOrder(1)
	If !dbSeek(QUERY->(C9_FILIAL+C9_PEDIDO+C9_ITEM+C9_SEQUEN+C9_PRODUTO),.F.)
		RecLock("SC9",.T.)
		SC9->C9_OK:=QUERY->C9_OK
		SC9->C9_FILIAL:=QUERY->C9_FILIAL
		SC9->C9_PEDIDO:=QUERY->C9_PEDIDO
		SC9->C9_ITEM:=QUERY->C9_ITEM
		SC9->C9_CLIENTE:=QUERY->C9_CLIENTE
		SC9->C9_LOJA:=QUERY->C9_LOJA
		SC9->C9_PRODUTO:=QUERY->C9_PRODUTO
		SC9->C9_QTDLIB:=QUERY->C9_QTDLIB
		SC9->C9_NFISCAL:=QUERY->C9_NFISCAL
		SC9->C9_SERIENF:=QUERY->C9_SERIENF
		SC9->C9_DATALIB:=QUERY->C9_DATALIB
		SC9->C9_SEQUEN:=QUERY->C9_SEQUEN
		SC9->C9_GRUPO:=QUERY->C9_GRUPO
		SC9->C9_PRCVEN:=QUERY->C9_PRCVEN
		SC9->C9_AGREG:=QUERY->C9_AGREG
		SC9->C9_IDENTB6:=QUERY->C9_IDENTB6
		SC9->C9_VENDA:=QUERY->C9_VENDA
		SC9->C9_BLEST:=QUERY->C9_BLEST
		SC9->C9_BLCRED:=QUERY->C9_BLCRED
		SC9->C9_BLOQUEI:=QUERY->C9_BLOQUEI
		SC9->C9_LOTECTL:=QUERY->C9_LOTECTL
		SC9->C9_NUMLOTE:=QUERY->C9_NUMLOTE
		SC9->C9_NUMSERI:=QUERY->C9_NUMSERI
		SC9->C9_PAPELET:=QUERY->C9_PAPELET
		SC9->C9_REMITO:=QUERY->C9_REMITO
		SC9->C9_RESERVA:=QUERY->C9_RESERVA
		SC9->C9_ITEMREM:=QUERY->C9_ITEMREM
		SC9->C9_QTDRESE:=QUERY->C9_QTDRESE
		SC9->C9_DTVALID:=QUERY->C9_DTVALID
		SC9->C9_LOCAL:=QUERY->C9_LOCAL
		SC9->C9_BLWMS:=QUERY->C9_BLWMS
		SC9->C9_CARGA:=QUERY->C9_CARGA
		SC9->C9_SEQCAR:=QUERY->C9_SEQCAR
		SC9->C9_SEQENT:=QUERY->C9_SEQENT
		SC9->C9_SERVIC:=QUERY->C9_SERVIC
		SC9->C9_STSERV:=QUERY->C9_STSERV
		SC9->C9_ENDPAD:=QUERY->C9_ENDPAD
		SC9->C9_TPCARGA:=QUERY->C9_TPCARGA
		SC9->C9_ORDSEP:=QUERY->C9_ORDSEP
		SC9->C9_PROJPMS:=QUERY->C9_PROJPMS
		SC9->C9_TASKPMS:=QUERY->C9_TASKPMS
		SC9->C9_QTDLIB2:=QUERY->C9_QTDLIB2
		SC9->C9_LICITA:=QUERY->C9_LICITA
		SC9->C9_TPESTR:=QUERY->C9_TPESTR
		SC9->C9_EDTPMS:=QUERY->C9_EDTPMS
		SC9->C9_POTENCI:=QUERY->C9_POTENCI
		SC9->C9_SERIREM:=QUERY->C9_SERIREM
		SC9->C9_BLINF:=QUERY->C9_BLINF
		SC9->C9_LOTNFC:=QUERY->C9_LOTNFC
		SC9->C9_BLTMS:=QUERY->C9_BLTMS
		SC9->C9_REGWMS:=QUERY->C9_REGWMS
		SC9->C9_NUMSEQ:=QUERY->C9_NUMSEQ
		SC9->C9_NUMCP:=QUERY->C9_NUMCP
		SC9->C9_CODISS:=QUERY->C9_CODISS
		SC9->C9_RETOPER:=QUERY->C9_RETOPER
		SC9->C9_TRT:=QUERY->C9_TRT
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")



_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SD1010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY D1_FILIAL, D1_DOC, D1_SERIE, D1_FORNECE, D1_LOJA, D1_COD, D1_ITEM"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "D1_EMISSAO"  , "D" )
TcSetField( "QUERY", "D1_DTDIGIT"  , "D" )
TcSetField( "QUERY", "D1_DATACUS"  , "D" )
TcSetField( "QUERY", "D1_DTVALID"  , "D" )
TcSetField( "QUERY", "D1_DATORI"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SD1 "+QUERY->(D1_FILIAL+D1_DOC+D1_SERIE+D1_FORNECE+D1_LOJA+D1_COD+D1_ITEM))
	
	dbSelectArea("SD1")
	dbSetOrder(1)
	If !dbSeek(QUERY->(D1_FILIAL+D1_DOC+D1_SERIE+D1_FORNECE+D1_LOJA+D1_COD+D1_ITEM),.F.)
		RecLock("SD1",.T.)
		SD1->D1_FILIAL:=QUERY->D1_FILIAL
		SD1->D1_TES:=QUERY->D1_TES
		SD1->D1_COD:=QUERY->D1_COD
		SD1->D1_UM:=QUERY->D1_UM
		SD1->D1_BARRAS:=QUERY->D1_BARRAS
		SD1->D1_SEGUM:=QUERY->D1_SEGUM
		SD1->D1_QUANT:=QUERY->D1_QUANT
		SD1->D1_VUNIT:=QUERY->D1_VUNIT
		SD1->D1_TOTAL:=QUERY->D1_TOTAL
		SD1->D1_VALICM:=QUERY->D1_VALICM
		SD1->D1_VALIPI:=QUERY->D1_VALIPI
		SD1->D1_CF:=QUERY->D1_CF
		SD1->D1_DESC:=QUERY->D1_DESC
		SD1->D1_IPI:=QUERY->D1_IPI
		SD1->D1_PICM:=QUERY->D1_PICM
		SD1->D1_PESO:=QUERY->D1_PESO
		SD1->D1_CONTA:=QUERY->D1_CONTA
		SD1->D1_CC:=QUERY->D1_CC
		SD1->D1_ITEMCTA:=QUERY->D1_ITEMCTA
		SD1->D1_OP:=QUERY->D1_OP
		SD1->D1_PEDIDO:=QUERY->D1_PEDIDO
		SD1->D1_ITEMPC:=QUERY->D1_ITEMPC
		SD1->D1_FORNECE:=QUERY->D1_FORNECE
		SD1->D1_LOJA:=QUERY->D1_LOJA
		SD1->D1_LOCAL:=QUERY->D1_LOCAL
		SD1->D1_DOC:=QUERY->D1_DOC
		SD1->D1_EMISSAO:=QUERY->D1_EMISSAO
		SD1->D1_DTDIGIT:=QUERY->D1_DTDIGIT
		SD1->D1_GRUPO:=QUERY->D1_GRUPO
		SD1->D1_TIPO:=QUERY->D1_TIPO
		SD1->D1_SERIE:=QUERY->D1_SERIE
		SD1->D1_CUSTO:=QUERY->D1_CUSTO
		SD1->D1_CUSTO2:=QUERY->D1_CUSTO2
		SD1->D1_CUSTO3:=QUERY->D1_CUSTO3
		SD1->D1_CUSTO4:=QUERY->D1_CUSTO4
		SD1->D1_CUSTO5:=QUERY->D1_CUSTO5
		SD1->D1_TP:=QUERY->D1_TP
		SD1->D1_QTSEGUM:=QUERY->D1_QTSEGUM
		SD1->D1_NUMSEQ:=QUERY->D1_NUMSEQ
		SD1->D1_DATACUS:=QUERY->D1_DATACUS
		SD1->D1_NFORI:=QUERY->D1_NFORI
		SD1->D1_SERIORI:=QUERY->D1_SERIORI
		SD1->D1_ITEMORI:=QUERY->D1_ITEMORI
		SD1->D1_QTDEDEV:=QUERY->D1_QTDEDEV
		SD1->D1_VALDEV:=QUERY->D1_VALDEV
		SD1->D1_ORIGLAN:=QUERY->D1_ORIGLAN
		SD1->D1_ICMSRET:=QUERY->D1_ICMSRET
		SD1->D1_BRICMS:=QUERY->D1_BRICMS
		SD1->D1_NUMCQ:=QUERY->D1_NUMCQ
		SD1->D1_ITEM:=QUERY->D1_ITEM
		SD1->D1_BASEICM:=QUERY->D1_BASEICM
		SD1->D1_VALDESC:=QUERY->D1_VALDESC
		SD1->D1_IDENTB6:=QUERY->D1_IDENTB6
		SD1->D1_LOTEFOR:=QUERY->D1_LOTEFOR
		SD1->D1_SKIPLOT:=QUERY->D1_SKIPLOT
		SD1->D1_BASEIPI:=QUERY->D1_BASEIPI
		SD1->D1_SEQCALC:=QUERY->D1_SEQCALC
		SD1->D1_LOTECTL:=QUERY->D1_LOTECTL
		SD1->D1_NUMLOTE:=QUERY->D1_NUMLOTE
		SD1->D1_DTVALID:=QUERY->D1_DTVALID
		SD1->D1_PLACA:=QUERY->D1_PLACA
		SD1->D1_CHASSI:=QUERY->D1_CHASSI
		SD1->D1_ANOFAB:=QUERY->D1_ANOFAB
		SD1->D1_MODFAB:=QUERY->D1_MODFAB
		SD1->D1_MODELO:=QUERY->D1_MODELO
		SD1->D1_COMBUST:=QUERY->D1_COMBUST
		SD1->D1_COR:=QUERY->D1_COR
		SD1->D1_EQUIPS:=QUERY->D1_EQUIPS
		SD1->D1_FORMUL:=QUERY->D1_FORMUL
		SD1->D1_II:=QUERY->D1_II
		SD1->D1_TEC:=QUERY->D1_TEC
		SD1->D1_CONHEC:=QUERY->D1_CONHEC
		SD1->D1_NUMPV:=QUERY->D1_NUMPV
		SD1->D1_ITEMPV:=QUERY->D1_ITEMPV
		SD1->D1_CUSFF1:=QUERY->D1_CUSFF1
		SD1->D1_CUSFF2:=QUERY->D1_CUSFF2
		SD1->D1_CUSFF3:=QUERY->D1_CUSFF3
		SD1->D1_CUSFF4:=QUERY->D1_CUSFF4
		SD1->D1_CUSFF5:=QUERY->D1_CUSFF5
		SD1->D1_CLASFIS:=QUERY->D1_CLASFIS
		SD1->D1_CODCIAP:=QUERY->D1_CODCIAP
		SD1->D1_REMITO:=QUERY->D1_REMITO
		SD1->D1_BASIMP1:=QUERY->D1_BASIMP1
		SD1->D1_BASIMP3:=QUERY->D1_BASIMP3
		SD1->D1_BASIMP4:=QUERY->D1_BASIMP4
		SD1->D1_BASIMP5:=QUERY->D1_BASIMP5
		SD1->D1_BASIMP6:=QUERY->D1_BASIMP6
		SD1->D1_VALIMP1:=QUERY->D1_VALIMP1
		SD1->D1_VALIMP2:=QUERY->D1_VALIMP2
		SD1->D1_VALIMP3:=QUERY->D1_VALIMP3
		SD1->D1_VALIMP4:=QUERY->D1_VALIMP4
		SD1->D1_VALIMP5:=QUERY->D1_VALIMP5
		SD1->D1_VALIMP6:=QUERY->D1_VALIMP6
		SD1->D1_CBASEAF:=QUERY->D1_CBASEAF
		SD1->D1_ICMSCOM:=QUERY->D1_ICMSCOM
		SD1->D1_CIF:=QUERY->D1_CIF
		SD1->D1_BASIMP2:=QUERY->D1_BASIMP2
		SD1->D1_TIPO_NF:=QUERY->D1_TIPO_NF
		SD1->D1_ALIQINS:=QUERY->D1_ALIQINS
		SD1->D1_ALIQIRR:=QUERY->D1_ALIQIRR
		SD1->D1_ALIQISS:=QUERY->D1_ALIQISS
		SD1->D1_ALQIMP1:=QUERY->D1_ALQIMP1
		SD1->D1_ALQIMP2:=QUERY->D1_ALQIMP2
		SD1->D1_ALQIMP3:=QUERY->D1_ALQIMP3
		SD1->D1_ALQIMP4:=QUERY->D1_ALQIMP4
		SD1->D1_ALQIMP5:=QUERY->D1_ALQIMP5
		SD1->D1_ALQIMP6:=QUERY->D1_ALQIMP6
		SD1->D1_BASEINS:=QUERY->D1_BASEINS
		SD1->D1_BASEIRR:=QUERY->D1_BASEIRR
		SD1->D1_BASEISS:=QUERY->D1_BASEISS
		SD1->D1_DESPESA:=QUERY->D1_DESPESA
		SD1->D1_QTDPEDI:=QUERY->D1_QTDPEDI
		SD1->D1_RATEIO:=QUERY->D1_RATEIO
		SD1->D1_SEGURO:=QUERY->D1_SEGURO
		SD1->D1_VALFRE:=QUERY->D1_VALFRE
		SD1->D1_VALINS:=QUERY->D1_VALINS
		SD1->D1_VALIRR:=QUERY->D1_VALIRR
		SD1->D1_VALISS:=QUERY->D1_VALISS
		SD1->D1_DATORI:=QUERY->D1_DATORI
		SD1->D1_CLVL:=QUERY->D1_CLVL
		SD1->D1_ORDEM:=QUERY->D1_ORDEM
		SD1->D1_SERVIC:=QUERY->D1_SERVIC
		SD1->D1_STSERV:=QUERY->D1_STSERV
		SD1->D1_ENDER:=QUERY->D1_ENDER
		SD1->D1_TPESTR:=QUERY->D1_TPESTR
		SD1->D1_LOCPAD:=QUERY->D1_LOCPAD
		SD1->D1_QTDCONF:=QUERY->D1_QTDCONF
		SD1->D1_SERIREM:=QUERY->D1_SERIREM
		SD1->D1_ITEMREM:=QUERY->D1_ITEMREM
		SD1->D1_CUSORI:=QUERY->D1_CUSORI
		SD1->D1_TIPODOC:=QUERY->D1_TIPODOC
		SD1->D1_POTENCI:=QUERY->D1_POTENCI
		SD1->D1_TRT:=QUERY->D1_TRT
		SD1->D1_REGWMS:=QUERY->D1_REGWMS
		SD1->D1_TESACLA:=QUERY->D1_TESACLA
		SD1->D1_NUMDESP:=QUERY->D1_NUMDESP
		SD1->D1_ORIGEM:=QUERY->D1_ORIGEM
		SD1->D1_ALIQCF3:=QUERY->D1_ALIQCF3
		SD1->D1_VALCF3:=QUERY->D1_VALCF3
		SD1->D1_VALPS3:=QUERY->D1_VALPS3
		SD1->D1_BASECF3:=QUERY->D1_BASECF3
		SD1->D1_BASEPS3:=QUERY->D1_BASEPS3
		SD1->D1_ALIQPS3:=QUERY->D1_ALIQPS3
		SD1->D1_CFPS:=QUERY->D1_CFPS
		SD1->D1_CODISS:=QUERY->D1_CODISS
		SD1->D1_BASESES:=QUERY->D1_BASESES
		SD1->D1_VALSES:=QUERY->D1_VALSES
		SD1->D1_ALIQSES:=QUERY->D1_ALIQSES
		SD1->D1_USERLGI:=QUERY->D1_USERLGI
		SD1->D1_USERLGA:=QUERY->D1_USERLGA
		SD1->D1_DESCICM:=QUERY->D1_DESCICM
		SD1->D1_CRDZFM:=QUERY->D1_CRDZFM
		SD1->D1_RGESPST:=QUERY->D1_RGESPST
		SD1->D1_ABATISS:=QUERY->D1_ABATISS
		SD1->D1_ABATMAT:=QUERY->D1_ABATMAT
		SD1->D1_VALFDS:=QUERY->D1_VALFDS
		SD1->D1_PRFDSUL:=QUERY->D1_PRFDSUL
		SD1->D1_UFERMS:=QUERY->D1_UFERMS
		SD1->D1_ESTCRED:=QUERY->D1_ESTCRED
		SD1->D1_VALANTI:=QUERY->D1_VALANTI
		SD1->D1_ALIQSOL:=QUERY->D1_ALIQSOL
		SD1->D1_CRPRSIM:=QUERY->D1_CRPRSIM
		SD1->D1_CRPRESC:=QUERY->D1_CRPRESC
		SD1->D1_PCCENTR:=QUERY->D1_PCCENTR
		SD1->D1_QTPCCEN:=QUERY->D1_QTPCCEN
		SD1->D1_ITPCCEN:=QUERY->D1_ITPCCEN
		SD1->D1_GRADE:=QUERY->D1_GRADE
		SD1->D1_ITEMGRD:=QUERY->D1_ITEMGRD
		SD1->D1_BASECSL:=QUERY->D1_BASECSL
		SD1->D1_VALACRS:=QUERY->D1_VALACRS
		SD1->D1_BASECOF:=QUERY->D1_BASECOF
		SD1->D1_VALCOF:=QUERY->D1_VALCOF
		SD1->D1_NFVINC:=QUERY->D1_NFVINC
		SD1->D1_SLDDEP:=QUERY->D1_SLDDEP
		SD1->D1_ITMVINC:=QUERY->D1_ITMVINC
		SD1->D1_CONBAR:=QUERY->D1_CONBAR
		SD1->D1_MARGEM:=QUERY->D1_MARGEM
		SD1->D1_PRUNDA:=QUERY->D1_PRUNDA
		SD1->D1_BASEPIS:=QUERY->D1_BASEPIS
		SD1->D1_ICMSDIF:=QUERY->D1_ICMSDIF
		SD1->D1_SERVINC:=QUERY->D1_SERVINC
		SD1->D1_GARANTI:=QUERY->D1_GARANTI
		SD1->D1_ALIQII:=QUERY->D1_ALIQII
		SD1->D1_ALQCSL:=QUERY->D1_ALQCSL
		SD1->D1_CUSRP1:=QUERY->D1_CUSRP1
		SD1->D1_VALCSL:=QUERY->D1_VALCSL
		SD1->D1_CUSRP4:=QUERY->D1_CUSRP4
		SD1->D1_ICMNDES:=QUERY->D1_ICMNDES
		SD1->D1_CUSRP3:=QUERY->D1_CUSRP3
		SD1->D1_ALQCOF:=QUERY->D1_ALQCOF
		SD1->D1_VALPIS:=QUERY->D1_VALPIS
		SD1->D1_CUSRP5:=QUERY->D1_CUSRP5
		SD1->D1_ALQPIS:=QUERY->D1_ALQPIS
		SD1->D1_CUSRP2:=QUERY->D1_CUSRP2
		SD1->D1_BASNDES:=QUERY->D1_BASNDES
		SD1->D1_TRANSIT:=QUERY->D1_TRANSIT
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SD2010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY D2_FILIAL, D2_COD, D2_LOCAL, D2_NUMSEQ"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "D2_EMISSAO"  , "D" )
TcSetField( "QUERY", "D2_DTDIGIT"  , "D" )
TcSetField( "QUERY", "D2_DTLCTCT"  , "D" )
TcSetField( "QUERY", "D2_DTVALID"  , "D" )
TcSetField( "QUERY", "D2_ENVCNAB"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SD2 "+QUERY->(D2_FILIAL+D2_COD+D2_LOCAL+D2_NUMSEQ))
	
	dbSelectArea("SD2")
	dbSetOrder(1)
	If !dbSeek(QUERY->(D2_FILIAL+D2_COD+D2_LOCAL+D2_NUMSEQ),.F.)
		RecLock("SD2",.T.)
		SD2->D2_FILIAL:=QUERY->D2_FILIAL
		SD2->D2_COD:=QUERY->D2_COD
		SD2->D2_UM:=QUERY->D2_UM
		SD2->D2_SEGUM:=QUERY->D2_SEGUM
		SD2->D2_QUANT:=QUERY->D2_QUANT
		SD2->D2_PRCVEN:=QUERY->D2_PRCVEN
		SD2->D2_TOTAL:=QUERY->D2_TOTAL
		SD2->D2_VALIPI:=QUERY->D2_VALIPI
		SD2->D2_VALICM:=QUERY->D2_VALICM
		SD2->D2_TES:=QUERY->D2_TES
		SD2->D2_CF:=QUERY->D2_CF
		SD2->D2_DESC:=QUERY->D2_DESC
		SD2->D2_IPI:=QUERY->D2_IPI
		SD2->D2_PICM:=QUERY->D2_PICM
		SD2->D2_PESO:=QUERY->D2_PESO
		SD2->D2_CONTA:=QUERY->D2_CONTA
		SD2->D2_OP:=QUERY->D2_OP
		SD2->D2_PEDIDO:=QUERY->D2_PEDIDO
		SD2->D2_ITEMPV:=QUERY->D2_ITEMPV
		SD2->D2_CLIENTE:=QUERY->D2_CLIENTE
		SD2->D2_LOJA:=QUERY->D2_LOJA
		SD2->D2_LOCAL:=QUERY->D2_LOCAL
		SD2->D2_DOC:=QUERY->D2_DOC
		SD2->D2_EMISSAO:=QUERY->D2_EMISSAO
		SD2->D2_GRUPO:=QUERY->D2_GRUPO
		SD2->D2_TP:=QUERY->D2_TP
		SD2->D2_SERIE:=QUERY->D2_SERIE
		SD2->D2_CUSTO1:=QUERY->D2_CUSTO1
		SD2->D2_CUSTO2:=QUERY->D2_CUSTO2
		SD2->D2_CUSTO3:=QUERY->D2_CUSTO3
		SD2->D2_CUSTO4:=QUERY->D2_CUSTO4
		SD2->D2_CUSTO5:=QUERY->D2_CUSTO5
		SD2->D2_PRUNIT:=QUERY->D2_PRUNIT
		SD2->D2_QTSEGUM:=QUERY->D2_QTSEGUM
		SD2->D2_NUMSEQ:=QUERY->D2_NUMSEQ
		SD2->D2_EST:=QUERY->D2_EST
		SD2->D2_DESCON:=QUERY->D2_DESCON
		SD2->D2_TIPO:=QUERY->D2_TIPO
		SD2->D2_NFORI:=QUERY->D2_NFORI
		SD2->D2_SERIORI:=QUERY->D2_SERIORI
		SD2->D2_QTDEDEV:=QUERY->D2_QTDEDEV
		SD2->D2_VALDEV:=QUERY->D2_VALDEV
		SD2->D2_ORIGLAN:=QUERY->D2_ORIGLAN
		SD2->D2_BRICMS:=QUERY->D2_BRICMS
		SD2->D2_BASEORI:=QUERY->D2_BASEORI
		SD2->D2_BASEICM:=QUERY->D2_BASEICM
		SD2->D2_VALACRS:=QUERY->D2_VALACRS
		SD2->D2_IDENTB6:=QUERY->D2_IDENTB6
		SD2->D2_ITEM:=QUERY->D2_ITEM
		SD2->D2_CODISS:=QUERY->D2_CODISS
		SD2->D2_GRADE:=QUERY->D2_GRADE
		SD2->D2_SEQCALC:=QUERY->D2_SEQCALC
		SD2->D2_ICMSRET:=QUERY->D2_ICMSRET
		SD2->D2_COMIS1:=QUERY->D2_COMIS1
		SD2->D2_COMIS2:=QUERY->D2_COMIS2
		SD2->D2_COMIS3:=QUERY->D2_COMIS3
		SD2->D2_COMIS4:=QUERY->D2_COMIS4
		SD2->D2_COMIS5:=QUERY->D2_COMIS5
		SD2->D2_LOTECTL:=QUERY->D2_LOTECTL
		SD2->D2_NUMLOTE:=QUERY->D2_NUMLOTE
		SD2->D2_DTVALID:=QUERY->D2_DTVALID
		SD2->D2_DESCZFR:=QUERY->D2_DESCZFR
		SD2->D2_PDV:=QUERY->D2_PDV
		SD2->D2_NUMSERI:=QUERY->D2_NUMSERI
		SD2->D2_DTLCTCT:=QUERY->D2_DTLCTCT
		SD2->D2_CUSFF1:=QUERY->D2_CUSFF1
		SD2->D2_CUSFF2:=QUERY->D2_CUSFF2
		SD2->D2_CUSFF3:=QUERY->D2_CUSFF3
		SD2->D2_CUSFF4:=QUERY->D2_CUSFF4
		SD2->D2_CUSFF5:=QUERY->D2_CUSFF5
		SD2->D2_CLASFIS:=QUERY->D2_CLASFIS
		SD2->D2_FLSERV:=QUERY->D2_FLSERV
		SD2->D2_BASIMP1:=QUERY->D2_BASIMP1
		SD2->D2_BASIMP2:=QUERY->D2_BASIMP2
		SD2->D2_BASIMP3:=QUERY->D2_BASIMP3
		SD2->D2_BASIMP4:=QUERY->D2_BASIMP4
		SD2->D2_BASIMP5:=QUERY->D2_BASIMP5
		SD2->D2_BASIMP6:=QUERY->D2_BASIMP6
		SD2->D2_VALIMP1:=QUERY->D2_VALIMP1
		SD2->D2_VALIMP2:=QUERY->D2_VALIMP2
		SD2->D2_VALIMP3:=QUERY->D2_VALIMP3
		SD2->D2_VALIMP4:=QUERY->D2_VALIMP4
		SD2->D2_VALIMP5:=QUERY->D2_VALIMP5
		SD2->D2_VALIMP6:=QUERY->D2_VALIMP6
		SD2->D2_ITEMORI:=QUERY->D2_ITEMORI
		SD2->D2_CODFAB:=QUERY->D2_CODFAB
		SD2->D2_LOJAFA:=QUERY->D2_LOJAFA
		SD2->D2_ALIQINS:=QUERY->D2_ALIQINS
		SD2->D2_ALIQISS:=QUERY->D2_ALIQISS
		SD2->D2_BASEINS:=QUERY->D2_BASEINS
		SD2->D2_BASEIPI:=QUERY->D2_BASEIPI
		SD2->D2_BASEISS:=QUERY->D2_BASEISS
		SD2->D2_CCUSTO:=QUERY->D2_CCUSTO
		SD2->D2_DESPESA:=QUERY->D2_DESPESA
		SD2->D2_ENVCNAB:=QUERY->D2_ENVCNAB
		SD2->D2_ITEMCC:=QUERY->D2_ITEMCC
		SD2->D2_LOCALIZ:=QUERY->D2_LOCALIZ
		SD2->D2_PREEMB:=QUERY->D2_PREEMB
		SD2->D2_SEGURO:=QUERY->D2_SEGURO
		SD2->D2_VALFRE:=QUERY->D2_VALFRE
		SD2->D2_VALINS:=QUERY->D2_VALINS
		SD2->D2_VALISS:=QUERY->D2_VALISS
		SD2->D2_CLVL:=QUERY->D2_CLVL
		SD2->D2_ICMFRET:=QUERY->D2_ICMFRET
		SD2->D2_SERVIC:=QUERY->D2_SERVIC
		SD2->D2_STSERV:=QUERY->D2_STSERV
		SD2->D2_PROJPMS:=QUERY->D2_PROJPMS
		SD2->D2_TASKPMS:=QUERY->D2_TASKPMS
		SD2->D2_LICITA:=QUERY->D2_LICITA
		SD2->D2_REMITO:=QUERY->D2_REMITO
		SD2->D2_SERIREM:=QUERY->D2_SERIREM
		SD2->D2_ITEMREM:=QUERY->D2_ITEMREM
		SD2->D2_ALQIMP1:=QUERY->D2_ALQIMP1
		SD2->D2_ALQIMP2:=QUERY->D2_ALQIMP2
		SD2->D2_ALQIMP3:=QUERY->D2_ALQIMP3
		SD2->D2_ALQIMP4:=QUERY->D2_ALQIMP4
		SD2->D2_ALQIMP5:=QUERY->D2_ALQIMP5
		SD2->D2_ALQIMP6:=QUERY->D2_ALQIMP6
		SD2->D2_TPDCENV:=QUERY->D2_TPDCENV
		SD2->D2_OK:=QUERY->D2_OK
		SD2->D2_ENDER:=QUERY->D2_ENDER
		SD2->D2_EDTPMS:=QUERY->D2_EDTPMS
		SD2->D2_VARPRUN:=QUERY->D2_VARPRUN
		SD2->D2_FORMUL:=QUERY->D2_FORMUL
		SD2->D2_TIPODOC:=QUERY->D2_TIPODOC
		SD2->D2_VAC:=QUERY->D2_VAC
		SD2->D2_TIPOREM:=QUERY->D2_TIPOREM
		SD2->D2_QTDEFAT:=QUERY->D2_QTDEFAT
		SD2->D2_QTDAFAT:=QUERY->D2_QTDAFAT
		SD2->D2_SEQUEN:=QUERY->D2_SEQUEN
		SD2->D2_POTENCI:=QUERY->D2_POTENCI
		SD2->D2_TPESTR:=QUERY->D2_TPESTR
		SD2->D2_VALBRUT:=QUERY->D2_VALBRUT
		SD2->D2_REGWMS:=QUERY->D2_REGWMS
		SD2->D2_DTDIGIT:=QUERY->D2_DTDIGIT
		SD2->D2_NUMCP:=QUERY->D2_NUMCP
		SD2->D2_ALIQPS3:=QUERY->D2_ALIQPS3
		SD2->D2_BASEPS3:=QUERY->D2_BASEPS3
		SD2->D2_VALPS3:=QUERY->D2_VALPS3
		SD2->D2_BASECF3:=QUERY->D2_BASECF3
		SD2->D2_ALIQCF3:=QUERY->D2_ALIQCF3
		SD2->D2_CFPS:=QUERY->D2_CFPS
		SD2->D2_DESCICM:=QUERY->D2_DESCICM
		SD2->D2_VALCF3:=QUERY->D2_VALCF3
		SD2->D2_USERLGI:=QUERY->D2_USERLGI
		SD2->D2_USERLGA:=QUERY->D2_USERLGA
		SD2->D2_ABSCINS:=QUERY->D2_ABSCINS
		SD2->D2_ABATISS:=QUERY->D2_ABATISS
		SD2->D2_ABATMAT:=QUERY->D2_ABATMAT
		SD2->D2_VALFDS:=QUERY->D2_VALFDS
		SD2->D2_PRFDSUL:=QUERY->D2_PRFDSUL
		SD2->D2_UFERMS:=QUERY->D2_UFERMS
		SD2->D2_ESTCRED:=QUERY->D2_ESTCRED
		SD2->D2_BASEIRR:=QUERY->D2_BASEIRR
		SD2->D2_BASETST:=QUERY->D2_BASETST
		SD2->D2_ALIQTST:=QUERY->D2_ALIQTST
		SD2->D2_VALTST:=QUERY->D2_VALTST
		SD2->D2_ALIQSOL:=QUERY->D2_ALIQSOL
		SD2->D2_VALCSL:=QUERY->D2_VALCSL
		SD2->D2_CUSRP1:=QUERY->D2_CUSRP1
		SD2->D2_CUSRP2:=QUERY->D2_CUSRP2
		SD2->D2_CUSRP3:=QUERY->D2_CUSRP3
		SD2->D2_CUSRP4:=QUERY->D2_CUSRP4
		SD2->D2_CUSRP5:=QUERY->D2_CUSRP5
		SD2->D2_DESCZFP:=QUERY->D2_DESCZFP
		SD2->D2_BASECSL:=QUERY->D2_BASECSL
		SD2->D2_TRT:=QUERY->D2_TRT
		SD2->D2_VALCOF:=QUERY->D2_VALCOF
		SD2->D2_DESCZFC:=QUERY->D2_DESCZFC
		SD2->D2_VALIRRF:=QUERY->D2_VALIRRF
		SD2->D2_BASECOF:=QUERY->D2_BASECOF
		SD2->D2_CODROM:=QUERY->D2_CODROM
		SD2->D2_ALQIRRF:=QUERY->D2_ALQIRRF
		SD2->D2_BASEPIS:=QUERY->D2_BASEPIS
		SD2->D2_PRUNDA:=QUERY->D2_PRUNDA
		SD2->D2_ALQCSL:=QUERY->D2_ALQCSL
		SD2->D2_MARGEM:=QUERY->D2_MARGEM
		SD2->D2_ALQCOF:=QUERY->D2_ALQCOF
		SD2->D2_ALQPIS:=QUERY->D2_ALQPIS
		SD2->D2_VALPIS:=QUERY->D2_VALPIS
		SD2->D2_CRPRESC:=QUERY->D2_CRPRESC
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")



_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SD3010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY D3_FILIAL, D3_OP, D3_COD, D3_LOCAL"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "D3_EMISSAO"  , "D" )
TcSetField( "QUERY", "D3_DTVALID"  , "D" )
TcSetField( "QUERY", "D3_DTLANC"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SD3 "+QUERY->(D3_FILIAL+D3_OP+D3_COD+D3_LOCAL))
	
	dbSelectArea("SD3")
	dbSetOrder(1)
	If !dbSeek(QUERY->(D3_FILIAL+D3_OP+D3_COD+D3_LOCAL),.F.)
		RecLock("SD3",.T.)
		SD3->D3_FILIAL:=QUERY->D3_FILIAL
		SD3->D3_TM:=QUERY->D3_TM
		SD3->D3_COD:=QUERY->D3_COD
		SD3->D3_UM:=QUERY->D3_UM
		SD3->D3_QUANT:=QUERY->D3_QUANT
		SD3->D3_CF:=QUERY->D3_CF
		SD3->D3_CONTA:=QUERY->D3_CONTA
		SD3->D3_OP:=QUERY->D3_OP
		SD3->D3_LOCAL:=QUERY->D3_LOCAL
		SD3->D3_DOC:=QUERY->D3_DOC
		SD3->D3_EMISSAO:=QUERY->D3_EMISSAO
		SD3->D3_BARRAS:=QUERY->D3_BARRAS
		SD3->D3_GRUPO:=QUERY->D3_GRUPO
		SD3->D3_REVISOR:=QUERY->D3_REVISOR
		SD3->D3_OBS1:=QUERY->D3_OBS1
		SD3->D3_OBS2:=QUERY->D3_OBS2
		SD3->D3_OBS3:=QUERY->D3_OBS3
		SD3->D3_CUSTO1:=QUERY->D3_CUSTO1
		SD3->D3_CUSTO2:=QUERY->D3_CUSTO2
		SD3->D3_CUSTO3:=QUERY->D3_CUSTO3
		SD3->D3_CUSTO4:=QUERY->D3_CUSTO4
		SD3->D3_CUSTO5:=QUERY->D3_CUSTO5
		SD3->D3_CC:=QUERY->D3_CC
		SD3->D3_PARCTOT:=QUERY->D3_PARCTOT
		SD3->D3_ESTORNO:=QUERY->D3_ESTORNO
		SD3->D3_NUMSEQ:=QUERY->D3_NUMSEQ
		SD3->D3_SEGUM:=QUERY->D3_SEGUM
		SD3->D3_QTSEGUM:=QUERY->D3_QTSEGUM
		SD3->D3_TIPO:=QUERY->D3_TIPO
		SD3->D3_NIVEL:=QUERY->D3_NIVEL
		SD3->D3_USUARIO:=QUERY->D3_USUARIO
		SD3->D3_PERDA:=QUERY->D3_PERDA
		SD3->D3_QTDPER:=QUERY->D3_QTDPER
		SD3->D3_QTDRET:=QUERY->D3_QTDRET
		SD3->D3_QTDENC:=QUERY->D3_QTDENC
		SD3->D3_QTDKG:=QUERY->D3_QTDKG
		SD3->D3_DTLANC:=QUERY->D3_DTLANC
		SD3->D3_TRT:=QUERY->D3_TRT
		SD3->D3_CHAVE:=QUERY->D3_CHAVE
		SD3->D3_IDENT:=QUERY->D3_IDENT
		SD3->D3_SEQCALC:=QUERY->D3_SEQCALC
		SD3->D3_RATEIO:=QUERY->D3_RATEIO
		SD3->D3_LOTECTL:=QUERY->D3_LOTECTL
		SD3->D3_NUMLOTE:=QUERY->D3_NUMLOTE
		SD3->D3_DTVALID:=QUERY->D3_DTVALID
		SD3->D3_LOCALIZ:=QUERY->D3_LOCALIZ
		SD3->D3_NUMSERI:=QUERY->D3_NUMSERI
		SD3->D3_CUSFF1:=QUERY->D3_CUSFF1
		SD3->D3_CUSFF2:=QUERY->D3_CUSFF2
		SD3->D3_CUSFF3:=QUERY->D3_CUSFF3
		SD3->D3_CUSFF4:=QUERY->D3_CUSFF4
		SD3->D3_CUSFF5:=QUERY->D3_CUSFF5
		SD3->D3_QTDKGPA:=QUERY->D3_QTDKGPA
		SD3->D3_X_PECAS:=QUERY->D3_X_PECAS
		SD3->D3_ITEM:=QUERY->D3_ITEM
		SD3->D3_OK:=QUERY->D3_OK
		SD3->D3_ITEMCTA:=QUERY->D3_ITEMCTA
		SD3->D3_CLVL:=QUERY->D3_CLVL
		SD3->D3_PROJPMS:=QUERY->D3_PROJPMS
		SD3->D3_TASKPMS:=QUERY->D3_TASKPMS
		SD3->D3_ORDEM:=QUERY->D3_ORDEM
		SD3->D3_SERVIC:=QUERY->D3_SERVIC
		SD3->D3_STSERV:=QUERY->D3_STSERV
		SD3->D3_OSTEC:=QUERY->D3_OSTEC
		SD3->D3_POTENCI:=QUERY->D3_POTENCI
		SD3->D3_TPESTR:=QUERY->D3_TPESTR
		SD3->D3_REGATEN:=QUERY->D3_REGATEN
		SD3->D3_REGWMS:=QUERY->D3_REGWMS
		SD3->D3_DOCSWN:=QUERY->D3_DOCSWN
		SD3->D3_ITEMSWN:=QUERY->D3_ITEMSWN
		SD3->D3_USERLGI:=QUERY->D3_USERLGI
		SD3->D3_USERLGA:=QUERY->D3_USERLGA
		SD3->D3_PMACNUT:=QUERY->D3_PMACNUT
		SD3->D3_PMICNUT:=QUERY->D3_PMICNUT
		SD3->D3_ITEMGRD:=QUERY->D3_ITEMGRD
		SD3->D3_STATUS:=QUERY->D3_STATUS
		SD3->D3_CUSRP1:=QUERY->D3_CUSRP1
		SD3->D3_CUSRP2:=QUERY->D3_CUSRP2
		SD3->D3_CUSRP3:=QUERY->D3_CUSRP3
		SD3->D3_CUSRP4:=QUERY->D3_CUSRP4
		SD3->D3_CUSRP5:=QUERY->D3_CUSRP5
		SD3->D3_CMRP:=QUERY->D3_CMRP
		SD3->D3_MOEDRP:=QUERY->D3_MOEDRP
		SD3->D3_GARANTI:=QUERY->D3_GARANTI
		SD3->D3_DIACTB:=QUERY->D3_DIACTB
		SD3->D3_CMFIXO:=QUERY->D3_CMFIXO
		SD3->D3_EMPOP:=QUERY->D3_EMPOP
		SD3->D3_MOEDA:=QUERY->D3_MOEDA
		SD3->D3_NODIA:=QUERY->D3_NODIA
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")



_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SD4010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY D4_FILIAL, D4_COD, D4_OP, D4_TRT, D4_LOTECTL, D4_NUMLOTE"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "D4_DATA"  , "D" )
TcSetField( "QUERY", "D4_DTVALID"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SD4 "+QUERY->(D4_FILIAL+D4_COD+D4_OP+D4_TRT+D4_LOTECTL+D4_NUMLOTE))
	
	dbSelectArea("SD4")
	dbSetOrder(1)
	If !dbSeek(QUERY->(D4_FILIAL+D4_COD+D4_OP+D4_TRT+D4_LOTECTL+D4_NUMLOTE),.F.)
		RecLock("SD4",.T.)
		SD4->D4_FILIAL:=QUERY->D4_FILIAL
		SD4->D4_COD:=QUERY->D4_COD
		SD4->D4_LOCAL:=QUERY->D4_LOCAL
		SD4->D4_OP:=QUERY->D4_OP
		SD4->D4_DATA:=QUERY->D4_DATA
		SD4->D4_QSUSP:=QUERY->D4_QSUSP
		SD4->D4_SITUACA:=QUERY->D4_SITUACA
		SD4->D4_QTDEORI:=QUERY->D4_QTDEORI
		SD4->D4_QUANT:=QUERY->D4_QUANT
		SD4->D4_TRT:=QUERY->D4_TRT
		SD4->D4_LOTECTL:=QUERY->D4_LOTECTL
		SD4->D4_NUMLOTE:=QUERY->D4_NUMLOTE
		SD4->D4_DTVALID:=QUERY->D4_DTVALID
		SD4->D4_OPORIG:=QUERY->D4_OPORIG
		SD4->D4_QTSEGUM:=QUERY->D4_QTSEGUM
		SD4->D4_OPORI:=QUERY->D4_OPORI
		SD4->D4_ORDEM:=QUERY->D4_ORDEM
		SD4->D4_POTENCI:=QUERY->D4_POTENCI
		SD4->D4_USERLGI:=QUERY->D4_USERLGI
		SD4->D4_USERLGA:=QUERY->D4_USERLGA
		SD4->D4_SEQ:=QUERY->D4_SEQ
		SD4->D4_NUMPVBN:=QUERY->D4_NUMPVBN
		SD4->D4_ITEPVBN:=QUERY->D4_ITEPVBN
		SD4->D4_SLDEMP:=QUERY->D4_SLDEMP
		SD4->D4_SLDEMP2:=QUERY->D4_SLDEMP2
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo


DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SD5010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY D5_FILIAL, D5_PRODUTO, D5_LOCAL, D5_LOTECTL, D5_NUMLOTE, D5_NUMSEQ"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "D5_DATA"  , "D" )
TcSetField( "QUERY", "D5_DTVALID"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SD5 "+QUERY->(D5_FILIAL+D5_PRODUTO+D5_LOCAL+D5_LOTECTL+D5_NUMLOTE+D5_NUMSEQ))
	
	dbSelectArea("SD5")
	dbSetOrder(2)
	If !dbSeek(QUERY->(D5_FILIAL+D5_PRODUTO+D5_LOCAL+D5_LOTECTL+D5_NUMLOTE+D5_NUMSEQ),.F.)
		RecLock("SD5",.T.)
		SD5->D5_FILIAL:=QUERY->D5_FILIAL
		SD5->D5_PRODUTO:=QUERY->D5_PRODUTO
		SD5->D5_QUANT:=QUERY->D5_QUANT
		SD5->D5_LOTEFOR:=QUERY->D5_LOTEFOR
		SD5->D5_DOC:=QUERY->D5_DOC
		SD5->D5_SERIE:=QUERY->D5_SERIE
		SD5->D5_OP:=QUERY->D5_OP
		SD5->D5_DATA:=QUERY->D5_DATA
		SD5->D5_ORIGLAN:=QUERY->D5_ORIGLAN
		SD5->D5_NUMSEQ:=QUERY->D5_NUMSEQ
		SD5->D5_CLIFOR:=QUERY->D5_CLIFOR
		SD5->D5_LOJA:=QUERY->D5_LOJA
		SD5->D5_LOCAL:=QUERY->D5_LOCAL
		SD5->D5_LOTECTL:=QUERY->D5_LOTECTL
		SD5->D5_NUMLOTE:=QUERY->D5_NUMLOTE
		SD5->D5_DTVALID:=QUERY->D5_DTVALID
		SD5->D5_QTSEGUM:=QUERY->D5_QTSEGUM
		SD5->D5_ESTORNO:=QUERY->D5_ESTORNO
		SD5->D5_POTENCI:=QUERY->D5_POTENCI
		SD5->D5_LOTEPRD:=QUERY->D5_LOTEPRD
		SD5->D5_SLOTEPR:=QUERY->D5_SLOTEPR
		SD5->D5_USERLGI:=QUERY->D5_USERLGI
		SD5->D5_USERLGA:=QUERY->D5_USERLGA
		SD5->D5_SLDINI:=QUERY->D5_SLDINI
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")

_cQuery :=	""
_cQuery +=	"SELECT DISTINCT * FROM Consulta.dbo.SE1010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY E1_FILIAL, E1_PREFIXO, E1_NUM, E1_PARCELA, E1_TIPO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "E1_LIDESCF"  , "D" )
TcSetField( "QUERY", "E1_CARTVAL"  , "D" )
TcSetField( "QUERY", "E1_EMISSAO"  , "D" )
TcSetField( "QUERY", "E1_VENCTO"  , "D" )
TcSetField( "QUERY", "E1_VENCREA"  , "D" )
TcSetField( "QUERY", "E1_VENCORI"  , "D" )
TcSetField( "QUERY", "E1_BAIXA"  , "D" )
TcSetField( "QUERY", "E1_DATABOR"  , "D" )
TcSetField( "QUERY", "E1_EMIS1"  , "D" )
TcSetField( "QUERY", "E1_DTVARIA"  , "D" )
TcSetField( "QUERY", "E1_DTFATUR"  , "D" )
TcSetField( "QUERY", "E1_DTPRORR"  , "D" )
TcSetField( "QUERY", "E1_DTACRED"  , "D" )
TcSetField( "QUERY", "E1_DTDESC1"  , "D" )
TcSetField( "QUERY", "E1_DTDESC2"  , "D" )
TcSetField( "QUERY", "E1_DTDESC3"  , "D" )
TcSetField( "QUERY", "E1_DATAEDI"  , "D" )
TcSetField( "QUERY", "E1_MOVIMEN"  , "D" )


dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SE1 "+QUERY->(E1_FILIAL+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO))
	
	dbSelectArea("SE1")
	dbSetOrder(1)
	If !dbSeek(QUERY->(E1_FILIAL+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO),.F.)
		RecLock("SE1",.T.)
		SE1->E1_FILIAL:=QUERY->E1_FILIAL
		SE1->E1_PREFIXO:=QUERY->E1_PREFIXO
		SE1->E1_NUM:=QUERY->E1_NUM
		SE1->E1_PARCELA:=QUERY->E1_PARCELA
		SE1->E1_TIPO:=QUERY->E1_TIPO
		SE1->E1_NATUREZ:=QUERY->E1_NATUREZ
		SE1->E1_NUMLIQ:=QUERY->E1_NUMLIQ
		SE1->E1_PORTADO:=QUERY->E1_PORTADO
		SE1->E1_SITUACA:=QUERY->E1_SITUACA
		SE1->E1_AGEDEP:=QUERY->E1_AGEDEP
		SE1->E1_CLIENTE:=QUERY->E1_CLIENTE
		SE1->E1_LOJA:=QUERY->E1_LOJA
		SE1->E1_NOMCLI:=QUERY->E1_NOMCLI
		SE1->E1_EMISSAO:=QUERY->E1_EMISSAO
		SE1->E1_VENCTO:=QUERY->E1_VENCTO
		SE1->E1_VENCREA:=QUERY->E1_VENCREA
		SE1->E1_VALOR:=QUERY->E1_VALOR
		SE1->E1_IRRF:=QUERY->E1_IRRF
		SE1->E1_ISS:=QUERY->E1_ISS
		SE1->E1_NUMBCO:=QUERY->E1_NUMBCO
		SE1->E1_INDICE:=QUERY->E1_INDICE
		SE1->E1_BAIXA:=QUERY->E1_BAIXA
		SE1->E1_NUMBOR:=QUERY->E1_NUMBOR
		SE1->E1_DATABOR:=QUERY->E1_DATABOR
		SE1->E1_EMIS1:=QUERY->E1_EMIS1
		SE1->E1_HIST:=QUERY->E1_HIST
		SE1->E1_LA:=QUERY->E1_LA
		SE1->E1_LOTE:=QUERY->E1_LOTE
		SE1->E1_MOTIVO:=QUERY->E1_MOTIVO
		SE1->E1_MOVIMEN:=QUERY->E1_MOVIMEN
		SE1->E1_OP:=QUERY->E1_OP
		SE1->E1_CONTRAT:=QUERY->E1_CONTRAT
		SE1->E1_SALDO:=QUERY->E1_SALDO
		SE1->E1_SUPERVI:=QUERY->E1_SUPERVI
		SE1->E1_VEND1:=QUERY->E1_VEND1
		SE1->E1_VEND2:=QUERY->E1_VEND2
		SE1->E1_VEND3:=QUERY->E1_VEND3
		SE1->E1_VEND4:=QUERY->E1_VEND4
		SE1->E1_VEND5:=QUERY->E1_VEND5
		SE1->E1_COMIS1:=QUERY->E1_COMIS1
		SE1->E1_COMIS2:=QUERY->E1_COMIS2
		SE1->E1_COMIS3:=QUERY->E1_COMIS3
		SE1->E1_COMIS4:=QUERY->E1_COMIS4
		SE1->E1_COMIS5:=QUERY->E1_COMIS5
		SE1->E1_DESCONT:=QUERY->E1_DESCONT
		SE1->E1_MULTA:=QUERY->E1_MULTA
		SE1->E1_JUROS:=QUERY->E1_JUROS
		SE1->E1_CORREC:=QUERY->E1_CORREC
		SE1->E1_VALLIQ:=QUERY->E1_VALLIQ
		SE1->E1_VENCORI:=QUERY->E1_VENCORI
		SE1->E1_CONTA:=QUERY->E1_CONTA
		SE1->E1_VALJUR:=QUERY->E1_VALJUR
		SE1->E1_PORCJUR:=QUERY->E1_PORCJUR
		SE1->E1_MOEDA:=QUERY->E1_MOEDA
		SE1->E1_BASCOM1:=QUERY->E1_BASCOM1
		SE1->E1_BASCOM2:=QUERY->E1_BASCOM2
		SE1->E1_BASCOM3:=QUERY->E1_BASCOM3
		SE1->E1_BASCOM4:=QUERY->E1_BASCOM4
		SE1->E1_BASCOM5:=QUERY->E1_BASCOM5
		SE1->E1_FATPREF:=QUERY->E1_FATPREF
		SE1->E1_FATURA:=QUERY->E1_FATURA
		SE1->E1_OK:=QUERY->E1_OK
		SE1->E1_PROJETO:=QUERY->E1_PROJETO
		SE1->E1_CLASCON:=QUERY->E1_CLASCON
		SE1->E1_VALCOM1:=QUERY->E1_VALCOM1
		SE1->E1_VALCOM2:=QUERY->E1_VALCOM2
		SE1->E1_VALCOM3:=QUERY->E1_VALCOM3
		SE1->E1_VALCOM4:=QUERY->E1_VALCOM4
		SE1->E1_VALCOM5:=QUERY->E1_VALCOM5
		SE1->E1_OCORREN:=QUERY->E1_OCORREN
		SE1->E1_INSTR1:=QUERY->E1_INSTR1
		SE1->E1_INSTR2:=QUERY->E1_INSTR2
		SE1->E1_PEDIDO:=QUERY->E1_PEDIDO
		SE1->E1_DTVARIA:=QUERY->E1_DTVARIA
		SE1->E1_VARURV:=QUERY->E1_VARURV
		SE1->E1_VLCRUZ:=QUERY->E1_VLCRUZ
		SE1->E1_DTFATUR:=QUERY->E1_DTFATUR
		SE1->E1_NUMNOTA:=QUERY->E1_NUMNOTA
		SE1->E1_SERIE:=QUERY->E1_SERIE
		SE1->E1_STATUS:=QUERY->E1_STATUS
		SE1->E1_ORIGEM:=QUERY->E1_ORIGEM
		SE1->E1_IDENTEE:=QUERY->E1_IDENTEE
		SE1->E1_NUMCART:=QUERY->E1_NUMCART
		SE1->E1_FLUXO:=QUERY->E1_FLUXO
		SE1->E1_DESCFIN:=QUERY->E1_DESCFIN
		SE1->E1_DIADESC:=QUERY->E1_DIADESC
		SE1->E1_CARTAO:=QUERY->E1_CARTAO
		SE1->E1_CARTVAL:=QUERY->E1_CARTVAL
		SE1->E1_CARTAUT:=QUERY->E1_CARTAUT
		SE1->E1_ADM:=QUERY->E1_ADM
		SE1->E1_VLRREAL:=QUERY->E1_VLRREAL
		SE1->E1_TRANSF:=QUERY->E1_TRANSF
		SE1->E1_BCOCHQ:=QUERY->E1_BCOCHQ
		SE1->E1_AGECHQ:=QUERY->E1_AGECHQ
		SE1->E1_CTACHQ:=QUERY->E1_CTACHQ
		SE1->E1_FLSERV:=QUERY->E1_FLSERV
		SE1->E1_ORDPAGO:=QUERY->E1_ORDPAGO
		SE1->E1_INSS:=QUERY->E1_INSS
		SE1->E1_DESPBCO:=QUERY->E1_DESPBCO
		SE1->E1_NOTADEB:=QUERY->E1_NOTADEB
		SE1->E1_OKD:=QUERY->E1_OKD
		SE1->E1_CHQPGO:=QUERY->E1_CHQPGO
		SE1->E1_DTPRORR:=QUERY->E1_DTPRORR
		SE1->E1_COFINS:=QUERY->E1_COFINS
		SE1->E1_CSLL:=QUERY->E1_CSLL
		SE1->E1_FILORIG:=QUERY->E1_FILORIG
		SE1->E1_FLAGFAT:=QUERY->E1_FLAGFAT
		SE1->E1_PIS:=QUERY->E1_PIS
		SE1->E1_TIPOFAT:=QUERY->E1_TIPOFAT
		SE1->E1_TIPOLIQ:=QUERY->E1_TIPOLIQ
		SE1->E1_MESBASE:=QUERY->E1_MESBASE
		SE1->E1_ANOBASE:=QUERY->E1_ANOBASE
		SE1->E1_PLNUCOB:=QUERY->E1_PLNUCOB
		SE1->E1_CODINT:=QUERY->E1_CODINT
		SE1->E1_CODEMP:=QUERY->E1_CODEMP
		SE1->E1_MATRIC:=QUERY->E1_MATRIC
		SE1->E1_ACRESC:=QUERY->E1_ACRESC
		SE1->E1_SDACRES:=QUERY->E1_SDACRES
		SE1->E1_DECRESC:=QUERY->E1_DECRESC
		SE1->E1_SDDECRE:=QUERY->E1_SDDECRE
		SE1->E1_MULTNAT:=QUERY->E1_MULTNAT
		SE1->E1_MSFIL:=QUERY->E1_MSFIL
		SE1->E1_MSEMP:=QUERY->E1_MSEMP
		SE1->E1_PROJPMS:=QUERY->E1_PROJPMS
		SE1->E1_TIPODES:=QUERY->E1_TIPODES
		SE1->E1_TXMOEDA:=QUERY->E1_TXMOEDA
		SE1->E1_DESDOBR:=QUERY->E1_DESDOBR
		SE1->E1_NRDOC:=QUERY->E1_NRDOC
		SE1->E1_MODSPB:=QUERY->E1_MODSPB
		SE1->E1_IDCNAB:=QUERY->E1_IDCNAB
		SE1->E1_PLCOEMP:=QUERY->E1_PLCOEMP
		SE1->E1_PLTPCOE:=QUERY->E1_PLTPCOE
		SE1->E1_CODCOR:=QUERY->E1_CODCOR
		SE1->E1_PARCCSS:=QUERY->E1_PARCCSS
		SE1->E1_CODORCA:=QUERY->E1_CODORCA
		SE1->E1_CODIMOV:=QUERY->E1_CODIMOV
		SE1->E1_RECIBO:=QUERY->E1_RECIBO
		SE1->E1_DTACRED:=QUERY->E1_DTACRED
		SE1->E1_EMITCHQ:=QUERY->E1_EMITCHQ
		SE1->E1_FILDEB:=QUERY->E1_FILDEB
		SE1->E1_NUMSOL:=QUERY->E1_NUMSOL
		SE1->E1_NUMRA:=QUERY->E1_NUMRA
		SE1->E1_SERREC:=QUERY->E1_SERREC
		SE1->E1_INSCRIC:=QUERY->E1_INSCRIC
		SE1->E1_DATAEDI:=QUERY->E1_DATAEDI
		SE1->E1_CODBAR:=QUERY->E1_CODBAR
		SE1->E1_CHQDEV:=QUERY->E1_CHQDEV
		SE1->E1_CODDIG:=QUERY->E1_CODDIG
		SE1->E1_LIDESCF:=QUERY->E1_LIDESCF
		SE1->E1_VLBOLSA:=QUERY->E1_VLBOLSA
		SE1->E1_NUMCRD:=QUERY->E1_NUMCRD
		SE1->E1_VLFIES:=QUERY->E1_VLFIES
		SE1->E1_DEBITO:=QUERY->E1_DEBITO
		SE1->E1_CCD:=QUERY->E1_CCD
		SE1->E1_ITEMD:=QUERY->E1_ITEMD
		SE1->E1_CLVLDB:=QUERY->E1_CLVLDB
		SE1->E1_CREDIT:=QUERY->E1_CREDIT
		SE1->E1_CCC:=QUERY->E1_CCC
		SE1->E1_ITEMC:=QUERY->E1_ITEMC
		SE1->E1_CLVLCR:=QUERY->E1_CLVLCR
		SE1->E1_DESCON1:=QUERY->E1_DESCON1
		SE1->E1_DESCON2:=QUERY->E1_DESCON2
		SE1->E1_DTDESC3:=QUERY->E1_DTDESC3
		SE1->E1_DTDESC1:=QUERY->E1_DTDESC1
		SE1->E1_DTDESC2:=QUERY->E1_DTDESC2
		SE1->E1_VLMULTA:=QUERY->E1_VLMULTA
		SE1->E1_DESCON3:=QUERY->E1_DESCON3
		SE1->E1_MOTNEG:=QUERY->E1_MOTNEG
		SE1->E1_SABTPIS:=QUERY->E1_SABTPIS
		SE1->E1_SABTCOF:=QUERY->E1_SABTCOF
		SE1->E1_SABTCSL:=QUERY->E1_SABTCSL
		SE1->E1_BASEPIS:=QUERY->E1_BASEPIS
		SE1->E1_BASECOF:=QUERY->E1_BASECOF
		SE1->E1_BASECSL:=QUERY->E1_BASECSL
		SE1->E1_FORNISS:=QUERY->E1_FORNISS
		SE1->E1_PARTOT:=QUERY->E1_PARTOT
		SE1->E1_SITFAT:=QUERY->E1_SITFAT
		SE1->E1_VRETISS:=QUERY->E1_VRETISS
		SE1->E1_PARCIRF:=QUERY->E1_PARCIRF
		SE1->E1_SCORGP:=QUERY->E1_SCORGP
		SE1->E1_FRETISS:=QUERY->E1_FRETISS
		SE1->E1_TXMDCOR:=QUERY->E1_TXMDCOR
		SE1->E1_SATBIRF:=QUERY->E1_SATBIRF
		SE1->E1_TIPREG:=QUERY->E1_TIPREG
		SE1->E1_CONEMP:=QUERY->E1_CONEMP
		SE1->E1_VERCON:=QUERY->E1_VERCON
		SE1->E1_SUBCON:=QUERY->E1_SUBCON
		SE1->E1_VERSUB:=QUERY->E1_VERSUB
		SE1->E1_PLLOTE:=QUERY->E1_PLLOTE
		SE1->E1_PLOPELT:=QUERY->E1_PLOPELT
		SE1->E1_CODRDA:=QUERY->E1_CODRDA
		SE1->E1_FORMREC:=QUERY->E1_FORMREC
		SE1->E1_BCOCLI:=QUERY->E1_BCOCLI
		SE1->E1_AGECLI:=QUERY->E1_AGECLI
		SE1->E1_CTACLI:=QUERY->E1_CTACLI
		SE1->E1_PARCFET:=QUERY->E1_PARCFET
		SE1->E1_FETHAB:=QUERY->E1_FETHAB
		SE1->E1_NUMCON:=QUERY->E1_NUMCON
		SE1->E1_USERLGI:=QUERY->E1_USERLGI
		SE1->E1_USERLGA:=QUERY->E1_USERLGA
		SE1->E1_APLVLMN:=QUERY->E1_APLVLMN
		SE1->E1_NFELETR:=QUERY->E1_NFELETR
		SE1->E1_VRETIRF:=QUERY->E1_VRETIRF
		SE1->E1_X_ND:=QUERY->E1_X_ND
		SE1->E1_BASEIRF:=QUERY->E1_BASEIRF
		SE1->E1_MDCRON:=QUERY->E1_MDCRON
		SE1->E1_MDCONTR:=QUERY->E1_MDCONTR
		SE1->E1_MEDNUME:=QUERY->E1_MEDNUME
		SE1->E1_MDPLANI:=QUERY->E1_MDPLANI
		SE1->E1_MDPARCE:=QUERY->E1_MDPARCE
		SE1->E1_MDREVIS:=QUERY->E1_MDREVIS
		SE1->E1_NUMMOV:=QUERY->E1_NUMMOV
		SE1->E1_PREFORI:=QUERY->E1_PREFORI
		SE1->E1_RELATO:=QUERY->E1_RELATO
		SE1->E1_TITPAI:=QUERY->E1_TITPAI
		SE1->E1_MDDESC:=QUERY->E1_MDDESC
		SE1->E1_MDMULT:=QUERY->E1_MDMULT
		SE1->E1_MULTDIA:=QUERY->E1_MULTDIA
		SE1->E1_RETCNTR:=QUERY->E1_RETCNTR
		SE1->E1_MDBONI:=QUERY->E1_MDBONI
		SE1->E1_NODIA:=QUERY->E1_NODIA
		SE1->E1_DOCTEF:=QUERY->E1_DOCTEF
		SE1->E1_BASEINS:=QUERY->E1_BASEINS
		SE1->E1_JURFAT:=QUERY->E1_JURFAT
		SE1->E1_DIACTB:=QUERY->E1_DIACTB
		SE1->E1_CODISS:=QUERY->E1_CODISS
		SE1->E1_IDLAN:=QUERY->E1_IDLAN
		SE1->E1_NSUTEF:=QUERY->E1_NSUTEF
		SE1->E1_SABTIRF:=QUERY->E1_SABTIRF
		SE1->E1_IDBOLET:=QUERY->E1_IDBOLET
		SE1->E1_IDAPLIC:=QUERY->E1_IDAPLIC
		SE1->E1_NOPER:=QUERY->E1_NOPER
		SE1->E1_BASEISS:=QUERY->E1_BASEISS
		SE1->E1_SEQBX:=QUERY->E1_SEQBX
		SE1->E1_LTCXA:=QUERY->E1_LTCXA
		SE1->E1_SERVICO:=QUERY->E1_SERVICO
		SE1->E1_PROCEL:=QUERY->E1_PROCEL
		SE1->E1_VLBOLP:=QUERY->E1_VLBOLP
		SE1->E1_NUMINSC:=QUERY->E1_NUMINSC
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SE2010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY E2_FILIAL, E2_PREFIXO, E2_NUM, E2_PARCELA, E2_TIPO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "E2_EMISSAO"  , "D" )
TcSetField( "QUERY", "E2_VENCTO"  , "D" )
TcSetField( "QUERY", "E2_VENCREA"  , "D" )
TcSetField( "QUERY", "E2_VENCORI"  , "D" )
TcSetField( "QUERY", "E2_BAIXA"  , "D" )
TcSetField( "QUERY", "E2_DTBORDE"  , "D" )
TcSetField( "QUERY", "E2_EMIS1"  , "D" )
TcSetField( "QUERY", "E2_DTVARIA"  , "D" )
TcSetField( "QUERY", "E2_DTFATUR"  , "D" )
TcSetField( "QUERY", "E2_DATALIB"  , "D" )
TcSetField( "QUERY", "E2_VENCISS"  , "D" )
TcSetField( "QUERY", "E2_DTDIRF"   , "D" )
TcSetField( "QUERY", "E2_DATAAGE"  , "D" )
TcSetField( "QUERY", "E2_MOVIMEN"  , "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SE2 "+QUERY->(E2_FILIAL+E2_PREFIXO+E2_NUM+E2_PARCELA+E2_TIPO))
	
	dbSelectArea("SE2")
	dbSetOrder(1)
	If !dbSeek(QUERY->(E2_FILIAL+E2_PREFIXO+E2_NUM+E2_PARCELA+E2_TIPO),.F.)
		RecLock("SE2",.T.)
		SE2->E2_FILIAL:=QUERY->E2_FILIAL
		SE2->E2_PREFIXO:=QUERY->E2_PREFIXO
		SE2->E2_NUM:=QUERY->E2_NUM
		SE2->E2_PARCELA:=QUERY->E2_PARCELA
		SE2->E2_TIPO:=QUERY->E2_TIPO
		SE2->E2_NATUREZ:=QUERY->E2_NATUREZ
		SE2->E2_PORTADO:=QUERY->E2_PORTADO
		SE2->E2_FORNECE:=QUERY->E2_FORNECE
		SE2->E2_LOJA:=QUERY->E2_LOJA
		SE2->E2_NOMFOR:=QUERY->E2_NOMFOR
		SE2->E2_EMISSAO:=QUERY->E2_EMISSAO
		SE2->E2_VENCTO:=QUERY->E2_VENCTO
		SE2->E2_VENCREA:=QUERY->E2_VENCREA
		SE2->E2_VALOR:=QUERY->E2_VALOR
		SE2->E2_ISS:=QUERY->E2_ISS
		SE2->E2_IRRF:=QUERY->E2_IRRF
		SE2->E2_NUMBCO:=QUERY->E2_NUMBCO
		SE2->E2_INDICE:=QUERY->E2_INDICE
		SE2->E2_BAIXA:=QUERY->E2_BAIXA
		SE2->E2_BCOPAG:=QUERY->E2_BCOPAG
		SE2->E2_EMIS1:=QUERY->E2_EMIS1
		SE2->E2_HIST:=QUERY->E2_HIST
		SE2->E2_LA:=QUERY->E2_LA
		SE2->E2_LOTE:=QUERY->E2_LOTE
		SE2->E2_MOTIVO:=QUERY->E2_MOTIVO
		SE2->E2_MOVIMEN:=QUERY->E2_MOVIMEN
		SE2->E2_OP:=QUERY->E2_OP
		SE2->E2_SALDO:=QUERY->E2_SALDO
		SE2->E2_OK:=QUERY->E2_OK
		SE2->E2_DESCONT:=QUERY->E2_DESCONT
		SE2->E2_MULTA:=QUERY->E2_MULTA
		SE2->E2_JUROS:=QUERY->E2_JUROS
		SE2->E2_CORREC:=QUERY->E2_CORREC
		SE2->E2_VALLIQ:=QUERY->E2_VALLIQ
		SE2->E2_VENCORI:=QUERY->E2_VENCORI
		SE2->E2_VALJUR:=QUERY->E2_VALJUR
		SE2->E2_PORCJUR:=QUERY->E2_PORCJUR
		SE2->E2_MOEDA:=QUERY->E2_MOEDA
		SE2->E2_NUMBOR:=QUERY->E2_NUMBOR
		SE2->E2_FATPREF:=QUERY->E2_FATPREF
		SE2->E2_FATURA:=QUERY->E2_FATURA
		SE2->E2_PROJETO:=QUERY->E2_PROJETO
		SE2->E2_CLASCON:=QUERY->E2_CLASCON
		SE2->E2_RATEIO:=QUERY->E2_RATEIO
		SE2->E2_DTVARIA:=QUERY->E2_DTVARIA
		SE2->E2_VARURV:=QUERY->E2_VARURV
		SE2->E2_VLCRUZ:=QUERY->E2_VLCRUZ
		SE2->E2_DTFATUR:=QUERY->E2_DTFATUR
		SE2->E2_ACRESC:=QUERY->E2_ACRESC
		SE2->E2_TITORIG:=QUERY->E2_TITORIG
		SE2->E2_IMPCHEQ:=QUERY->E2_IMPCHEQ
		SE2->E2_PARCIR:=QUERY->E2_PARCIR
		SE2->E2_ARQRAT:=QUERY->E2_ARQRAT
		SE2->E2_OCORREN:=QUERY->E2_OCORREN
		SE2->E2_ORIGEM:=QUERY->E2_ORIGEM
		SE2->E2_IDENTEE:=QUERY->E2_IDENTEE
		SE2->E2_FLUXO:=QUERY->E2_FLUXO
		SE2->E2_PARCISS:=QUERY->E2_PARCISS
		SE2->E2_DESDOBR:=QUERY->E2_DESDOBR
		SE2->E2_INSS:=QUERY->E2_INSS
		SE2->E2_PARCINS:=QUERY->E2_PARCINS
		SE2->E2_APROVA:=QUERY->E2_APROVA
		SE2->E2_DATALIB:=QUERY->E2_DATALIB
		SE2->E2_FLAGFAT:=QUERY->E2_FLAGFAT
		SE2->E2_TIPOFAT:=QUERY->E2_TIPOFAT
		SE2->E2_ORDPAGO:=QUERY->E2_ORDPAGO
		SE2->E2_ANOBASE:=QUERY->E2_ANOBASE
		SE2->E2_MESBASE:=QUERY->E2_MESBASE
		SE2->E2_SDACRES:=QUERY->E2_SDACRES
		SE2->E2_DECRESC:=QUERY->E2_DECRESC
		SE2->E2_SDDECRE:=QUERY->E2_SDDECRE
		SE2->E2_USUALIB:=QUERY->E2_USUALIB
		SE2->E2_MULTNAT:=QUERY->E2_MULTNAT
		SE2->E2_NUMTIT:=QUERY->E2_NUMTIT
		SE2->E2_PROJPMS:=QUERY->E2_PROJPMS
		SE2->E2_PLLOTE:=QUERY->E2_PLLOTE
		SE2->E2_CODRET:=QUERY->E2_CODRET
		SE2->E2_DIRF:=QUERY->E2_DIRF
		SE2->E2_TXMOEDA:=QUERY->E2_TXMOEDA
		SE2->E2_MODSPB:=QUERY->E2_MODSPB
		SE2->E2_IDCNAB:=QUERY->E2_IDCNAB
		SE2->E2_PARCCSS:=QUERY->E2_PARCCSS
		SE2->E2_RETENC:=QUERY->E2_RETENC
		SE2->E2_CONTAD:=QUERY->E2_CONTAD
		SE2->E2_CODORCA:=QUERY->E2_CODORCA
		SE2->E2_SEST:=QUERY->E2_SEST
		SE2->E2_PARCSES:=QUERY->E2_PARCSES
		SE2->E2_FILDEB:=QUERY->E2_FILDEB
		SE2->E2_FILORIG:=QUERY->E2_FILORIG
		SE2->E2_FORNISS:=QUERY->E2_FORNISS
		SE2->E2_LOJAISS:=QUERY->E2_LOJAISS
		SE2->E2_DEBITO:=QUERY->E2_DEBITO
		SE2->E2_CCD:=QUERY->E2_CCD
		SE2->E2_ITEMD:=QUERY->E2_ITEMD
		SE2->E2_CLVLDB:=QUERY->E2_CLVLDB
		SE2->E2_CREDIT:=QUERY->E2_CREDIT
		SE2->E2_CCC:=QUERY->E2_CCC
		SE2->E2_ITEMC:=QUERY->E2_ITEMC
		SE2->E2_CLVLCR:=QUERY->E2_CLVLCR
		SE2->E2_COFINS:=QUERY->E2_COFINS
		SE2->E2_PIS:=QUERY->E2_PIS
		SE2->E2_CSLL:=QUERY->E2_CSLL
		SE2->E2_PARCCOF:=QUERY->E2_PARCCOF
		SE2->E2_PARCPIS:=QUERY->E2_PARCPIS
		SE2->E2_PARCSLL:=QUERY->E2_PARCSLL
		SE2->E2_TITPIS:=QUERY->E2_TITPIS
		SE2->E2_TITCOF:=QUERY->E2_TITCOF
		SE2->E2_TITCSL:=QUERY->E2_TITCSL
		SE2->E2_TITINS:=QUERY->E2_TITINS
		SE2->E2_VRETPIS:=QUERY->E2_VRETPIS
		SE2->E2_VRETCOF:=QUERY->E2_VRETCOF
		SE2->E2_VRETCSL:=QUERY->E2_VRETCSL
		SE2->E2_PRETPIS:=QUERY->E2_PRETPIS
		SE2->E2_PRETCOF:=QUERY->E2_PRETCOF
		SE2->E2_PRETCSL:=QUERY->E2_PRETCSL
		SE2->E2_SEQBX:=QUERY->E2_SEQBX
		SE2->E2_BASEPIS:=QUERY->E2_BASEPIS
		SE2->E2_BASECOF:=QUERY->E2_BASECOF
		SE2->E2_BASECSL:=QUERY->E2_BASECSL
		SE2->E2_CODBAR:=QUERY->E2_CODBAR
		SE2->E2_VRETISS:=QUERY->E2_VRETISS
		SE2->E2_VENCISS:=QUERY->E2_VENCISS
		SE2->E2_VBASISS:=QUERY->E2_VBASISS
		SE2->E2_MDRTISS:=QUERY->E2_MDRTISS
		SE2->E2_VARIAC:=QUERY->E2_VARIAC
		SE2->E2_PERIOD:=QUERY->E2_PERIOD
		SE2->E2_MDCONTR:=QUERY->E2_MDCONTR
		SE2->E2_MDREVIS:=QUERY->E2_MDREVIS
		SE2->E2_MDPLANI:=QUERY->E2_MDPLANI
		SE2->E2_MDCRON:=QUERY->E2_MDCRON
		SE2->E2_MDPARCE:=QUERY->E2_MDPARCE
		SE2->E2_FRETISS:=QUERY->E2_FRETISS
		SE2->E2_TXMDCOR:=QUERY->E2_TXMDCOR
		SE2->E2_APLVLMN:=QUERY->E2_APLVLMN
		SE2->E2_CLEARIN:=QUERY->E2_CLEARIN
		SE2->E2_HORASPB:=QUERY->E2_HORASPB
		SE2->E2_PRETIRF:=QUERY->E2_PRETIRF
		SE2->E2_SEFIP:=QUERY->E2_SEFIP
		SE2->E2_TRETISS:=QUERY->E2_TRETISS
		SE2->E2_VRETIRF:=QUERY->E2_VRETIRF
		SE2->E2_PLOPELT:=QUERY->E2_PLOPELT
		SE2->E2_CODRDA:=QUERY->E2_CODRDA
		SE2->E2_PARCFET:=QUERY->E2_PARCFET
		SE2->E2_FETHAB:=QUERY->E2_FETHAB
		SE2->E2_FORORI:=QUERY->E2_FORORI
		SE2->E2_LOJORI:=QUERY->E2_LOJORI
		SE2->E2_USERLGI:=QUERY->E2_USERLGI
		SE2->E2_USERLGA:=QUERY->E2_USERLGA
		SE2->E2_CODAGL:=QUERY->E2_CODAGL
		SE2->E2_FATFOR:=QUERY->E2_FATFOR
		SE2->E2_FATLOJ:=QUERY->E2_FATLOJ
		SE2->E2_TITPAI:=QUERY->E2_TITPAI
		SE2->E2_TITADT:=QUERY->E2_TITADT
		SE2->E2_NUMLIQ:=QUERY->E2_NUMLIQ
		SE2->E2_BCOCHQ:=QUERY->E2_BCOCHQ
		SE2->E2_AGECHQ:=QUERY->E2_AGECHQ
		SE2->E2_CTACHQ:=QUERY->E2_CTACHQ
		SE2->E2_TIPOLIQ:=QUERY->E2_TIPOLIQ
		SE2->E2_PROCPCC:=QUERY->E2_PROCPCC
		SE2->E2_FORNPAI:=QUERY->E2_FORNPAI
		SE2->E2_STATUS:=QUERY->E2_STATUS
		SE2->E2_DTDIRF:=QUERY->E2_DTDIRF
		SE2->E2_INSSRET:=QUERY->E2_INSSRET
		SE2->E2_CODISS:=QUERY->E2_CODISS
		SE2->E2_BASEISS:=QUERY->E2_BASEISS
		SE2->E2_PRETINS:=QUERY->E2_PRETINS
		SE2->E2_MDMULT:=QUERY->E2_MDMULT
		SE2->E2_BASEIRF:=QUERY->E2_BASEIRF
		SE2->E2_DIACTB:=QUERY->E2_DIACTB
		SE2->E2_RETCNTR:=QUERY->E2_RETCNTR
		SE2->E2_VRETINS:=QUERY->E2_VRETINS
		SE2->E2_DATAAGE:=QUERY->E2_DATAAGE
		SE2->E2_CIDE:=QUERY->E2_CIDE
		SE2->E2_MDBONI:=QUERY->E2_MDBONI
		SE2->E2_MDDESC:=QUERY->E2_MDDESC
		SE2->E2_PARCAGL:=QUERY->E2_PARCAGL
		SE2->E2_NODIA:=QUERY->E2_NODIA
		SE2->E2_BASEINS:=QUERY->E2_BASEINS
		SE2->E2_PARIMP3:=QUERY->E2_PARIMP3
		SE2->E2_CODINS:=QUERY->E2_CODINS
		SE2->E2_IDDARF:=QUERY->E2_IDDARF
		SE2->E2_CODRCSL:=QUERY->E2_CODRCSL
		SE2->E2_DTBORDE:=QUERY->E2_DTBORDE
		SE2->E2_PARIMP5:=QUERY->E2_PARIMP5
		SE2->E2_PARIMP2:=QUERY->E2_PARIMP2
		SE2->E2_CODRPIS:=QUERY->E2_CODRPIS
		SE2->E2_CODRCOF:=QUERY->E2_CODRCOF
		SE2->E2_PARCCID:=QUERY->E2_PARCCID
		SE2->E2_PARIMP4:=QUERY->E2_PARIMP4
		SE2->E2_PARIMP1:=QUERY->E2_PARIMP1
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")

_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SE3010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY E3_FILIAL, E3_PREFIXO, E3_NUM, E3_PARCELA, E3_SEQ, E3_VEND"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "E3_EMISSAO"  	, "D" )
TcSetField( "QUERY", "E3_DATA"  	, "D" )
TcSetField( "QUERY", "E3_VENCTO"  	, "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SE3 "+QUERY->(E3_FILIAL+E3_PREFIXO+E3_NUM+E3_PARCELA+E3_SEQ+E3_VEND))
	
	dbSelectArea("SE3")
	dbSetOrder(1)
	If !dbSeek(QUERY->(E3_FILIAL+E3_PREFIXO+E3_NUM+E3_PARCELA+E3_SEQ+E3_VEND),.F.)
		RecLock("SE3",.T.)
		SE3->E3_FILIAL:=QUERY->E3_FILIAL
		SE3->E3_VEND:=QUERY->E3_VEND
		SE3->E3_NUM:=QUERY->E3_NUM
		SE3->E3_EMISSAO:=QUERY->E3_EMISSAO
		SE3->E3_SERIE:=QUERY->E3_SERIE
		SE3->E3_CODCLI:=QUERY->E3_CODCLI
		SE3->E3_LOJA:=QUERY->E3_LOJA
		SE3->E3_BASE:=QUERY->E3_BASE
		SE3->E3_PORC:=QUERY->E3_PORC
		SE3->E3_COMIS:=QUERY->E3_COMIS
		SE3->E3_DATA:=QUERY->E3_DATA
		SE3->E3_PREFIXO:=QUERY->E3_PREFIXO
		SE3->E3_PARCELA:=QUERY->E3_PARCELA
		SE3->E3_TIPO:=QUERY->E3_TIPO
		SE3->E3_BAIEMI:=QUERY->E3_BAIEMI
		SE3->E3_PEDIDO:=QUERY->E3_PEDIDO
		SE3->E3_AJUSTE:=QUERY->E3_AJUSTE
		SE3->E3_SEQ:=QUERY->E3_SEQ
		SE3->E3_ORIGEM:=QUERY->E3_ORIGEM
		SE3->E3_FLSERV:=QUERY->E3_FLSERV
		SE3->E3_VENCTO:=QUERY->E3_VENCTO
		SE3->E3_DEBITO:=QUERY->E3_DEBITO
		SE3->E3_CCD:=QUERY->E3_CCD
		SE3->E3_ITEMD:=QUERY->E3_ITEMD
		SE3->E3_CLVLDB:=QUERY->E3_CLVLDB
		SE3->E3_CREDIT:=QUERY->E3_CREDIT
		SE3->E3_CCC:=QUERY->E3_CCC
		SE3->E3_ITEMC:=QUERY->E3_ITEMC
		SE3->E3_CLVLCR:=QUERY->E3_CLVLCR
		SE3->E3_PROCCOM:=QUERY->E3_PROCCOM
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")

_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SE5010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY E5_FILIAL, E5_DATA, E5_BANCO, E5_AGENCIA, E5_CONTA, E5_NUMCHEQ"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "E5_DATA"  	, "D" )
TcSetField( "QUERY", "E5_VENCTO"  	, "D" )
TcSetField( "QUERY", "E5_DTDISPO"  	, "D" )
TcSetField( "QUERY", "E5_DTDIGIT"  	, "D" )


dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SE5 "+QUERY->(E5_FILIAL+DTOS(E5_DATA)+E5_BANCO+E5_AGENCIA+E5_CONTA+E5_NUMCHEQ))
	
	dbSelectArea("SE5")
	dbSetOrder(1)
	If !dbSeek(QUERY->(E5_FILIAL+DTOS(E5_DATA)+E5_BANCO+E5_AGENCIA+E5_CONTA+E5_NUMCHEQ),.F.)
		RecLock("SE5",.T.)
		SE5->E5_FILIAL:=QUERY->E5_FILIAL
		SE5->E5_DATA:=QUERY->E5_DATA
		SE5->E5_TIPO:=QUERY->E5_TIPO
		SE5->E5_MOEDA:=QUERY->E5_MOEDA
		SE5->E5_VALOR:=QUERY->E5_VALOR
		SE5->E5_NATUREZ:=QUERY->E5_NATUREZ
		SE5->E5_BANCO:=QUERY->E5_BANCO
		SE5->E5_AGENCIA:=QUERY->E5_AGENCIA
		SE5->E5_CONTA:=QUERY->E5_CONTA
		SE5->E5_NUMCHEQ:=QUERY->E5_NUMCHEQ
		SE5->E5_DOCUMEN:=QUERY->E5_DOCUMEN
		SE5->E5_VENCTO:=QUERY->E5_VENCTO
		SE5->E5_RECPAG:=QUERY->E5_RECPAG
		SE5->E5_BENEF:=QUERY->E5_BENEF
		SE5->E5_HISTOR:=QUERY->E5_HISTOR
		SE5->E5_TIPODOC:=QUERY->E5_TIPODOC
		SE5->E5_VLMOED2:=QUERY->E5_VLMOED2
		SE5->E5_LA:=QUERY->E5_LA
		SE5->E5_SITUACA:=QUERY->E5_SITUACA
		SE5->E5_LOTE:=QUERY->E5_LOTE
		SE5->E5_PREFIXO:=QUERY->E5_PREFIXO
		SE5->E5_NUMERO:=QUERY->E5_NUMERO
		SE5->E5_PARCELA:=QUERY->E5_PARCELA
		SE5->E5_CLIFOR:=QUERY->E5_CLIFOR
		SE5->E5_LOJA:=QUERY->E5_LOJA
		SE5->E5_DTDIGIT:=QUERY->E5_DTDIGIT
		SE5->E5_TIPOLAN:=QUERY->E5_TIPOLAN
		SE5->E5_DEBITO:=QUERY->E5_DEBITO
		SE5->E5_CREDITO:=QUERY->E5_CREDITO
		SE5->E5_MOTBX:=QUERY->E5_MOTBX
		SE5->E5_RATEIO:=QUERY->E5_RATEIO
		SE5->E5_RECONC:=QUERY->E5_RECONC
		SE5->E5_SEQ:=QUERY->E5_SEQ
		SE5->E5_DTDISPO:=QUERY->E5_DTDISPO
		SE5->E5_CCD:=QUERY->E5_CCD
		SE5->E5_CCC:=QUERY->E5_CCC
		SE5->E5_OK:=QUERY->E5_OK
		SE5->E5_ARQRAT:=QUERY->E5_ARQRAT
		SE5->E5_IDENTEE:=QUERY->E5_IDENTEE
		SE5->E5_FLSERV:=QUERY->E5_FLSERV
		SE5->E5_ORDREC:=QUERY->E5_ORDREC
		SE5->E5_ARQCNAB:=QUERY->E5_ARQCNAB
		SE5->E5_FILORIG:=QUERY->E5_FILORIG
		SE5->E5_VLCORRE:=QUERY->E5_VLCORRE
		SE5->E5_VLDESCO:=QUERY->E5_VLDESCO
		SE5->E5_VLJUROS:=QUERY->E5_VLJUROS
		SE5->E5_VLMULTA:=QUERY->E5_VLMULTA
		SE5->E5_CNABOC:=QUERY->E5_CNABOC
		SE5->E5_SITUA:=QUERY->E5_SITUA
		SE5->E5_ITEMD:=QUERY->E5_ITEMD
		SE5->E5_ITEMC:=QUERY->E5_ITEMC
		SE5->E5_CLVLDB:=QUERY->E5_CLVLDB
		SE5->E5_CLVLCR:=QUERY->E5_CLVLCR
		SE5->E5_PROJPMS:=QUERY->E5_PROJPMS
		SE5->E5_EDTPMS:=QUERY->E5_EDTPMS
		SE5->E5_TASKPMS:=QUERY->E5_TASKPMS
		SE5->E5_MODSPB:=QUERY->E5_MODSPB
		SE5->E5_TXMOEDA:=QUERY->E5_TXMOEDA
		SE5->E5_CODORCA:=QUERY->E5_CODORCA
		SE5->E5_FATURA:=QUERY->E5_FATURA
		SE5->E5_FATPREF:=QUERY->E5_FATPREF
		SE5->E5_SITCOB:=QUERY->E5_SITCOB
		SE5->E5_FORNADT:=QUERY->E5_FORNADT
		SE5->E5_LOJAADT:=QUERY->E5_LOJAADT
		SE5->E5_CLIENTE:=QUERY->E5_CLIENTE
		SE5->E5_FORNECE:=QUERY->E5_FORNECE
		SE5->E5_SERREC:=QUERY->E5_SERREC
		SE5->E5_OPERAD:=QUERY->E5_OPERAD
		SE5->E5_MOVCX:=QUERY->E5_MOVCX
		SE5->E5_KEY:=QUERY->E5_KEY
		SE5->E5_MULTNAT:=QUERY->E5_MULTNAT
		SE5->E5_AGLIMP:=QUERY->E5_AGLIMP
		SE5->E5_VRETPIS:=QUERY->E5_VRETPIS
		SE5->E5_VRETCOF:=QUERY->E5_VRETCOF
		SE5->E5_VRETCSL:=QUERY->E5_VRETCSL
		SE5->E5_PRETPIS:=QUERY->E5_PRETPIS
		SE5->E5_PRETCOF:=QUERY->E5_PRETCOF
		SE5->E5_PRETCSL:=QUERY->E5_PRETCSL
		SE5->E5_VLACRES:=QUERY->E5_VLACRES
		SE5->E5_VLDECRE:=QUERY->E5_VLDECRE
		SE5->E5_AUTBCO:=QUERY->E5_AUTBCO
		SE5->E5_PRETIRF:=QUERY->E5_PRETIRF
		SE5->E5_VRETIRF:=QUERY->E5_VRETIRF
		SE5->E5_VRETISS:=QUERY->E5_VRETISS
		SE5->E5_USERLGI:=QUERY->E5_USERLGI
		SE5->E5_USERLGA:=QUERY->E5_USERLGA
		SE5->E5_PROCTRA:=QUERY->E5_PROCTRA
		SE5->E5_NUMMOV:=QUERY->E5_NUMMOV
		SE5->E5_BASEIRF:=QUERY->E5_BASEIRF
		SE5->E5_NODIA:=QUERY->E5_NODIA
		SE5->E5_DIACTB:=QUERY->E5_DIACTB
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")



_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SEF010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY EF_FILIAL, EF_BANCO, EF_AGENCIA, EF_CONTA, EF_NUM"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "EF_DATA"  	, "D" )
TcSetField( "QUERY", "EF_VENCTO"  	, "D" )
TcSetField( "QUERY", "EF_DTALIN1"  	, "D" )
TcSetField( "QUERY", "EF_DTALIN2"  	, "D" )
TcSetField( "QUERY", "EF_DTREPRE"  	, "D" )
TcSetField( "QUERY", "EF_DTCOMP"  	, "D" )
TcSetField( "QUERY", "EF_TERCEIR"  	, "L" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SEF "+QUERY->(EF_FILIAL+EF_BANCO+EF_AGENCIA+EF_CONTA+EF_NUM))
	
	dbSelectArea("SEF")
	dbSetOrder(1)
	If !dbSeek(QUERY->(EF_FILIAL+EF_BANCO+EF_AGENCIA+EF_CONTA+EF_NUM),.F.)
		RecLock("SEF",.T.)
		SEF->EF_FILIAL:=QUERY->EF_FILIAL
		SEF->EF_PREFIXO:=QUERY->EF_PREFIXO
		SEF->EF_TITULO:=QUERY->EF_TITULO
		SEF->EF_PARCELA:=QUERY->EF_PARCELA
		SEF->EF_TIPO:=QUERY->EF_TIPO
		SEF->EF_NUM:=QUERY->EF_NUM
		SEF->EF_BANCO:=QUERY->EF_BANCO
		SEF->EF_AGENCIA:=QUERY->EF_AGENCIA
		SEF->EF_BENEF:=QUERY->EF_BENEF
		SEF->EF_VALOR:=QUERY->EF_VALOR
		SEF->EF_DATA:=QUERY->EF_DATA
		SEF->EF_CONTA:=QUERY->EF_CONTA
		SEF->EF_IMPRESS:=QUERY->EF_IMPRESS
		SEF->EF_HIST:=QUERY->EF_HIST
		SEF->EF_FORNECE:=QUERY->EF_FORNECE
		SEF->EF_OK:=QUERY->EF_OK
		SEF->EF_LOJA:=QUERY->EF_LOJA
		SEF->EF_CART:=QUERY->EF_CART
		SEF->EF_DEPOSIT:=QUERY->EF_DEPOSIT
		SEF->EF_NUMNOTA:=QUERY->EF_NUMNOTA
		SEF->EF_RG:=QUERY->EF_RG
		SEF->EF_SERIE:=QUERY->EF_SERIE
		SEF->EF_TEL:=QUERY->EF_TEL
		SEF->EF_VENCTO:=QUERY->EF_VENCTO
		SEF->EF_LIBER:=QUERY->EF_LIBER
		SEF->EF_SEQUENC:=QUERY->EF_SEQUENC
		SEF->EF_GARANT:=QUERY->EF_GARANT
		SEF->EF_LA:=QUERY->EF_LA
		SEF->EF_PORTADO:=QUERY->EF_PORTADO
		SEF->EF_ORIGEM:=QUERY->EF_ORIGEM
		SEF->EF_FLSERV:=QUERY->EF_FLSERV
		SEF->EF_HISTD:=QUERY->EF_HISTD
		SEF->EF_ALINEA1:=QUERY->EF_ALINEA1
		SEF->EF_ALINEA2:=QUERY->EF_ALINEA2
		SEF->EF_DTALIN1:=QUERY->EF_DTALIN1
		SEF->EF_DTALIN2:=QUERY->EF_DTALIN2
		SEF->EF_DTREPRE:=QUERY->EF_DTREPRE
		SEF->EF_CHDEVOL:=QUERY->EF_CHDEVOL
		SEF->EF_TERCEIR:=QUERY->EF_TERCEIR
		SEF->EF_COMP:=QUERY->EF_COMP
		SEF->EF_VALORBX:=QUERY->EF_VALORBX
		SEF->EF_CLIENTE:=QUERY->EF_CLIENTE
		SEF->EF_LOJACLI:=QUERY->EF_LOJACLI
		SEF->EF_CPFCNPJ:=QUERY->EF_CPFCNPJ
		SEF->EF_EMITENT:=QUERY->EF_EMITENT
		SEF->EF_KEY:=QUERY->EF_KEY
		SEF->EF_DTCOMP:=QUERY->EF_DTCOMP
		SEF->EF_DEBITO:=QUERY->EF_DEBITO
		SEF->EF_CCD:=QUERY->EF_CCD
		SEF->EF_ITEMD:=QUERY->EF_ITEMD
		SEF->EF_CLVLDB:=QUERY->EF_CLVLDB
		SEF->EF_CREDIT:=QUERY->EF_CREDIT
		SEF->EF_CCC:=QUERY->EF_CCC
		SEF->EF_ITEMC:=QUERY->EF_ITEMC
		SEF->EF_CLVLCR:=QUERY->EF_CLVLCR
		SEF->EF_USADOBX:=QUERY->EF_USADOBX
		SEF->EF_USERLGI:=QUERY->EF_USERLGI
		SEF->EF_USERLGA:=QUERY->EF_USERLGA
		SEF->EF_NATUR:=QUERY->EF_NATUR
		SEF->EF_FILORIG:=QUERY->EF_FILORIG
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SEA010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY EA_FILIAL, EA_NUMBOR, EA_PREFIXO, EA_NUM, EA_PARCELA, EA_TIPO, EA_FORNECE, EA_LOJA"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "EA_DATABOR"  	, "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SEA "+QUERY->(EA_FILIAL+EA_NUMBOR+EA_PREFIXO+EA_NUM+EA_PARCELA+EA_TIPO+EA_FORNECE+EA_LOJA))
	
	dbSelectArea("SEA")
	dbSetOrder(1)
	If !dbSeek(QUERY->(EA_FILIAL+EA_NUMBOR+EA_PREFIXO+EA_NUM+EA_PARCELA+EA_TIPO+EA_FORNECE+EA_LOJA),.F.)
		RecLock("SEA",.T.)
		SEA->EA_FILIAL:=QUERY->EA_FILIAL
		SEA->EA_PREFIXO:=QUERY->EA_PREFIXO
		SEA->EA_NUM:=QUERY->EA_NUM
		SEA->EA_PARCELA:=QUERY->EA_PARCELA
		SEA->EA_PORTADO:=QUERY->EA_PORTADO
		SEA->EA_AGEDEP:=QUERY->EA_AGEDEP
		SEA->EA_NUMBOR:=QUERY->EA_NUMBOR
		SEA->EA_DATABOR:=QUERY->EA_DATABOR
		SEA->EA_TIPO:=QUERY->EA_TIPO
		SEA->EA_CART:=QUERY->EA_CART
		SEA->EA_FORNECE:=QUERY->EA_FORNECE
		SEA->EA_LOJA:=QUERY->EA_LOJA
		SEA->EA_NUMCON:=QUERY->EA_NUMCON
		SEA->EA_MODELO:=QUERY->EA_MODELO
		SEA->EA_TIPOPAG:=QUERY->EA_TIPOPAG
		SEA->EA_TRANSF:=QUERY->EA_TRANSF
		SEA->EA_SITUACA:=QUERY->EA_SITUACA
		SEA->EA_SALDO:=QUERY->EA_SALDO
		SEA->EA_OCORR:=QUERY->EA_OCORR
		SEA->EA_DESAGIO:=QUERY->EA_DESAGIO
		SEA->EA_IOF:=QUERY->EA_IOF
		SEA->EA_TARIFA:=QUERY->EA_TARIFA
		SEA->EA_DOC:=QUERY->EA_DOC
		SEA->EA_CPMF:=QUERY->EA_CPMF
		SEA->EA_DIAS:=QUERY->EA_DIAS
		SEA->EA_SITUANT:=QUERY->EA_SITUANT
		SEA->EA_FILORIG:=QUERY->EA_FILORIG
		SEA->EA_PORTANT:=QUERY->EA_PORTANT
		SEA->EA_AGEANT:=QUERY->EA_AGEANT
		SEA->EA_CONTANT:=QUERY->EA_CONTANT
		SEA->EA_DEBITO:=QUERY->EA_DEBITO
		SEA->EA_CCD:=QUERY->EA_CCD
		SEA->EA_ITEMD:=QUERY->EA_ITEMD
		SEA->EA_CLVLDB:=QUERY->EA_CLVLDB
		SEA->EA_CREDIT:=QUERY->EA_CREDIT
		SEA->EA_CCC:=QUERY->EA_CCC
		SEA->EA_ITEMC:=QUERY->EA_ITEMC
		SEA->EA_CLVLCR:=QUERY->EA_CLVLCR
		SEA->EA_USERLGI:=QUERY->EA_USERLGI
		SEA->EA_USERLGA:=QUERY->EA_USERLGA
		SEA->EA_TAC:=QUERY->EA_TAC
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SF1010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY F1_FILIAL, F1_DOC, F1_SERIE, F1_FORNECE, F1_LOJA, F1_TIPO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "F1_EMISSAO"  	, "D" )
TcSetField( "QUERY", "F1_DTDIGIT"  	, "D" )
TcSetField( "QUERY", "F1_DTLANC"  	, "D" )
TcSetField( "QUERY", "F1_DT_CONT"  	, "D" )
TcSetField( "QUERY", "F1_DT_ESTO"  	, "D" )
TcSetField( "QUERY", "F1_RECBMTO"  	, "D" )
TcSetField( "QUERY", "F1_EMINFE"  	, "D" )


dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SF1 "+QUERY->(F1_FILIAL+F1_DOC+F1_SERIE+F1_FORNECE+F1_LOJA+F1_TIPO))
	
	dbSelectArea("SF1")
	dbSetOrder(1)
	If !dbSeek(QUERY->(F1_FILIAL+F1_DOC+F1_SERIE+F1_FORNECE+F1_LOJA+F1_TIPO),.F.)
		RecLock("SF1",.T.)
		SF1->F1_FILIAL:=QUERY->F1_FILIAL
		SF1->F1_DOC:=QUERY->F1_DOC
		SF1->F1_SERIE:=QUERY->F1_SERIE
		SF1->F1_FORNECE:=QUERY->F1_FORNECE
		SF1->F1_LOJA:=QUERY->F1_LOJA
		SF1->F1_COND:=QUERY->F1_COND
		SF1->F1_DUPL:=QUERY->F1_DUPL
		SF1->F1_EMISSAO:=QUERY->F1_EMISSAO
		SF1->F1_EST:=QUERY->F1_EST
		SF1->F1_FRETE:=QUERY->F1_FRETE
		SF1->F1_DESPESA:=QUERY->F1_DESPESA
		SF1->F1_BASEICM:=QUERY->F1_BASEICM
		SF1->F1_VALICM:=QUERY->F1_VALICM
		SF1->F1_BASEIPI:=QUERY->F1_BASEIPI
		SF1->F1_VALIPI:=QUERY->F1_VALIPI
		SF1->F1_VALMERC:=QUERY->F1_VALMERC
		SF1->F1_VALBRUT:=QUERY->F1_VALBRUT
		SF1->F1_TIPO:=QUERY->F1_TIPO
		SF1->F1_DESCONT:=QUERY->F1_DESCONT
		SF1->F1_NFORI:=QUERY->F1_NFORI
		SF1->F1_SERIORI:=QUERY->F1_SERIORI
		SF1->F1_DTDIGIT:=QUERY->F1_DTDIGIT
		SF1->F1_CPROVA:=QUERY->F1_CPROVA
		SF1->F1_BRICMS:=QUERY->F1_BRICMS
		SF1->F1_ICMSRET:=QUERY->F1_ICMSRET
		SF1->F1_BASEFD:=QUERY->F1_BASEFD
		SF1->F1_DTLANC:=QUERY->F1_DTLANC
		SF1->F1_OK:=QUERY->F1_OK
		SF1->F1_ORIGLAN:=QUERY->F1_ORIGLAN
		SF1->F1_TX:=QUERY->F1_TX
		SF1->F1_CONTSOC:=QUERY->F1_CONTSOC
		SF1->F1_IRRF:=QUERY->F1_IRRF
		SF1->F1_FORMUL:=QUERY->F1_FORMUL
		SF1->F1_NFORIG:=QUERY->F1_NFORIG
		SF1->F1_SERORIG:=QUERY->F1_SERORIG
		SF1->F1_ESPECIE:=QUERY->F1_ESPECIE
		SF1->F1_IMPORT:=QUERY->F1_IMPORT
		SF1->F1_II:=QUERY->F1_II
		SF1->F1_REMITO:=QUERY->F1_REMITO
		SF1->F1_BASIMP2:=QUERY->F1_BASIMP2
		SF1->F1_BASIMP3:=QUERY->F1_BASIMP3
		SF1->F1_BASIMP4:=QUERY->F1_BASIMP4
		SF1->F1_BASIMP5:=QUERY->F1_BASIMP5
		SF1->F1_BASIMP6:=QUERY->F1_BASIMP6
		SF1->F1_VALIMP1:=QUERY->F1_VALIMP1
		SF1->F1_VALIMP2:=QUERY->F1_VALIMP2
		SF1->F1_VALIMP3:=QUERY->F1_VALIMP3
		SF1->F1_VALIMP4:=QUERY->F1_VALIMP4
		SF1->F1_VALIMP5:=QUERY->F1_VALIMP5
		SF1->F1_VALIMP6:=QUERY->F1_VALIMP6
		SF1->F1_ORDPAGO:=QUERY->F1_ORDPAGO
		SF1->F1_HORA:=QUERY->F1_HORA
		SF1->F1_INSS:=QUERY->F1_INSS
		SF1->F1_ISS:=QUERY->F1_ISS
		SF1->F1_BASIMP1:=QUERY->F1_BASIMP1
		SF1->F1_HAWB:=QUERY->F1_HAWB
		SF1->F1_TIPO_NF:=QUERY->F1_TIPO_NF
		SF1->F1_IPI:=QUERY->F1_IPI
		SF1->F1_ICMS:=QUERY->F1_ICMS
		SF1->F1_PESOL:=QUERY->F1_PESOL
		SF1->F1_FOB_R:=QUERY->F1_FOB_R
		SF1->F1_SEGURO:=QUERY->F1_SEGURO
		SF1->F1_CIF:=QUERY->F1_CIF
		SF1->F1_DT_CONT:=QUERY->F1_DT_CONT
		SF1->F1_DT_ESTO:=QUERY->F1_DT_ESTO
		//SF1->F1_X_COPFL:=QUERY->F1_X_COPFL
		SF1->F1_X_PROC:=QUERY->F1_X_PROC
		SF1->F1_OBSDEV1:=QUERY->F1_OBSDEV1
		SF1->F1_OBSDEV2:=QUERY->F1_OBSDEV2
		SF1->F1_X_TRANS:=QUERY->F1_X_TRANS
		SF1->F1_X_VOLUM:=QUERY->F1_X_VOLUM
		SF1->F1_X_PESOB:=QUERY->F1_X_PESOB
		SF1->F1_BASEINS:=QUERY->F1_BASEINS
		SF1->F1_BASEIR:=QUERY->F1_BASEIR
		SF1->F1_CTR_NFC:=QUERY->F1_CTR_NFC
		SF1->F1_MOEDA:=QUERY->F1_MOEDA
		SF1->F1_PREFIXO:=QUERY->F1_PREFIXO
		SF1->F1_RECBMTO:=QUERY->F1_RECBMTO
		SF1->F1_STATUS:=QUERY->F1_STATUS
		SF1->F1_TXMOEDA:=QUERY->F1_TXMOEDA
		SF1->F1_VALEMB:=QUERY->F1_VALEMB
		SF1->F1_STATCON:=QUERY->F1_STATCON
		SF1->F1_QTDCONF:=QUERY->F1_QTDCONF
		SF1->F1_PEDVEND:=QUERY->F1_PEDVEND
		SF1->F1_TIPODOC:=QUERY->F1_TIPODOC
		SF1->F1_TIPOREM:=QUERY->F1_TIPOREM
		SF1->F1_GNR:=QUERY->F1_GNR
		SF1->F1_APROV:=QUERY->F1_APROV
		SF1->F1_VALPIS:=QUERY->F1_VALPIS
		SF1->F1_VALCOFI:=QUERY->F1_VALCOFI
		SF1->F1_VALCSLL:=QUERY->F1_VALCSLL
		SF1->F1_BASEPS3:=QUERY->F1_BASEPS3
		SF1->F1_VALPS3:=QUERY->F1_VALPS3
		SF1->F1_BASECF3:=QUERY->F1_BASECF3
		SF1->F1_VALCF3:=QUERY->F1_VALCF3
		SF1->F1_NFELETR:=QUERY->F1_NFELETR
		SF1->F1_EMINFE:=QUERY->F1_EMINFE
		SF1->F1_HORNFE:=QUERY->F1_HORNFE
		SF1->F1_CODNFE:=QUERY->F1_CODNFE
		SF1->F1_CREDNFE:=QUERY->F1_CREDNFE
		SF1->F1_VNAGREG:=QUERY->F1_VNAGREG
		SF1->F1_USERLGI:=QUERY->F1_USERLGI
		SF1->F1_USERLGA:=QUERY->F1_USERLGA
		SF1->F1_NUMRA:=QUERY->F1_NUMRA
		SF1->F1_DOCFOL:=QUERY->F1_DOCFOL
		SF1->F1_VERBAFO:=QUERY->F1_VERBAFO
		SF1->F1_VALFDS:=QUERY->F1_VALFDS
		SF1->F1_NUMRPS:=QUERY->F1_NUMRPS
		SF1->F1_RECISS:=QUERY->F1_RECISS
		SF1->F1_ESTCRED:=QUERY->F1_ESTCRED
		SF1->F1_FILORIG:=QUERY->F1_FILORIG
		SF1->F1_TPNFEXP:=QUERY->F1_TPNFEXP
		SF1->F1_PLACA:=QUERY->F1_PLACA
		SF1->F1_VALIRF:=QUERY->F1_VALIRF
		SF1->F1_NUMMOV:=QUERY->F1_NUMMOV
		SF1->F1_CHVNFE:=QUERY->F1_CHVNFE
		SF1->F1_NODIA:=QUERY->F1_NODIA
		SF1->F1_DIACTB:=QUERY->F1_DIACTB
		SF1->F1_TRANSP:=QUERY->F1_TRANSP
		SF1->F1_PLIQUI:=QUERY->F1_PLIQUI
		SF1->F1_PBRUTO:=QUERY->F1_PBRUTO
		SF1->F1_ESPECI1:=QUERY->F1_ESPECI1
		SF1->F1_VOLUME1:=QUERY->F1_VOLUME1
		SF1->F1_ESPECI2:=QUERY->F1_ESPECI2
		SF1->F1_VOLUME2:=QUERY->F1_VOLUME2
		SF1->F1_ESPECI3:=QUERY->F1_ESPECI3
		SF1->F1_VOLUME3:=QUERY->F1_VOLUME3
		SF1->F1_ESPECI4:=QUERY->F1_ESPECI4
		SF1->F1_VOLUME4:=QUERY->F1_VOLUME4
		SF1->F1_MENNOTA:=QUERY->F1_MENNOTA
		SF1->F1_FIMP:=QUERY->F1_FIMP
		SF1->F1_BASCSLL:=QUERY->F1_BASCSLL
		SF1->F1_BASCOFI:=QUERY->F1_BASCOFI
		SF1->F1_BASPIS:=QUERY->F1_BASPIS
		SF1->F1_TPFRETE:=QUERY->F1_TPFRETE
		SF1->F1_MENPAD:=QUERY->F1_MENPAD
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")



_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SF2010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY F2_FILIAL, F2_DOC, F2_SERIE, F2_CLIENTE, F2_LOJA, F2_FORMUL, F2_TIPO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "F2_EMISSAO"  	, "D" )
TcSetField( "QUERY", "F2_DTLANC"   	, "D" )
TcSetField( "QUERY", "F2_DTREAJ"   	, "D" )
TcSetField( "QUERY", "F2_EMINFE"   	, "D" )
TcSetField( "QUERY", "F2_DTBASE0"  	, "D" )
TcSetField( "QUERY", "F2_DTBASE1"  	, "D" )
TcSetField( "QUERY", "F2_DTENTR"   	, "D" )
TcSetField( "QUERY", "F2_DTDIGIT"  	, "D" )

dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SF2 "+QUERY->(F2_FILIAL+F2_DOC+F2_SERIE+F2_CLIENTE+F2_LOJA+F2_FORMUL+F2_TIPO))
	
	dbSelectArea("SF2")
	dbSetOrder(1)
	If !dbSeek(QUERY->(F2_FILIAL+F2_DOC+F2_SERIE+F2_CLIENTE+F2_LOJA+F2_FORMUL+F2_TIPO),.F.)
		RecLock("SF2",.T.)
		SF2->F2_FILIAL:=QUERY->F2_FILIAL
		SF2->F2_DOC:=QUERY->F2_DOC
		SF2->F2_SERIE:=QUERY->F2_SERIE
		SF2->F2_CLIENTE:=QUERY->F2_CLIENTE
		SF2->F2_LOJA:=QUERY->F2_LOJA
		SF2->F2_COND:=QUERY->F2_COND
		SF2->F2_DUPL:=QUERY->F2_DUPL
		SF2->F2_EMISSAO:=QUERY->F2_EMISSAO
		SF2->F2_EST:=QUERY->F2_EST
		SF2->F2_FRETE:=QUERY->F2_FRETE
		SF2->F2_SEGURO:=QUERY->F2_SEGURO
		SF2->F2_ICMFRET:=QUERY->F2_ICMFRET
		SF2->F2_TIPOCLI:=QUERY->F2_TIPOCLI
		SF2->F2_VALBRUT:=QUERY->F2_VALBRUT
		SF2->F2_VALICM:=QUERY->F2_VALICM
		SF2->F2_BASEICM:=QUERY->F2_BASEICM
		SF2->F2_VALIPI:=QUERY->F2_VALIPI
		SF2->F2_BASEIPI:=QUERY->F2_BASEIPI
		SF2->F2_VALMERC:=QUERY->F2_VALMERC
		SF2->F2_NFORI:=QUERY->F2_NFORI
		SF2->F2_DESCONT:=QUERY->F2_DESCONT
		SF2->F2_SERIORI:=QUERY->F2_SERIORI
		SF2->F2_TIPO:=QUERY->F2_TIPO
		SF2->F2_ESPECI1:=QUERY->F2_ESPECI1
		SF2->F2_ESPECI2:=QUERY->F2_ESPECI2
		SF2->F2_ESPECI3:=QUERY->F2_ESPECI3
		SF2->F2_ESPECI4:=QUERY->F2_ESPECI4
		SF2->F2_VOLUME1:=QUERY->F2_VOLUME1
		SF2->F2_VOLUME2:=QUERY->F2_VOLUME2
		SF2->F2_VOLUME3:=QUERY->F2_VOLUME3
		SF2->F2_VOLUME4:=QUERY->F2_VOLUME4
		SF2->F2_ICMSRET:=QUERY->F2_ICMSRET
		SF2->F2_PLIQUI:=QUERY->F2_PLIQUI
		SF2->F2_PBRUTO:=QUERY->F2_PBRUTO
		SF2->F2_TRANSP:=QUERY->F2_TRANSP
		SF2->F2_REDESP:=QUERY->F2_REDESP
		SF2->F2_VEND1:=QUERY->F2_VEND1
		SF2->F2_VEND2:=QUERY->F2_VEND2
		SF2->F2_VEND3:=QUERY->F2_VEND3
		SF2->F2_VEND4:=QUERY->F2_VEND4
		SF2->F2_VEND5:=QUERY->F2_VEND5
		SF2->F2_OK:=QUERY->F2_OK
		SF2->F2_FIMP:=QUERY->F2_FIMP
		SF2->F2_DTLANC:=QUERY->F2_DTLANC
		SF2->F2_DTREAJ:=QUERY->F2_DTREAJ
		SF2->F2_REAJUST:=QUERY->F2_REAJUST
		SF2->F2_DTBASE0:=QUERY->F2_DTBASE0
		SF2->F2_FATORB0:=QUERY->F2_FATORB0
		SF2->F2_DTBASE1:=QUERY->F2_DTBASE1
		SF2->F2_FATORB1:=QUERY->F2_FATORB1
		SF2->F2_VARIAC:=QUERY->F2_VARIAC
		SF2->F2_BASEISS:=QUERY->F2_BASEISS
		SF2->F2_VALISS:=QUERY->F2_VALISS
		SF2->F2_VALFAT:=QUERY->F2_VALFAT
		SF2->F2_CONTSOC:=QUERY->F2_CONTSOC
		SF2->F2_BRICMS:=QUERY->F2_BRICMS
		SF2->F2_FRETAUT:=QUERY->F2_FRETAUT
		SF2->F2_ICMAUTO:=QUERY->F2_ICMAUTO
		SF2->F2_DESPESA:=QUERY->F2_DESPESA
		SF2->F2_NEXTDOC:=QUERY->F2_NEXTDOC
		SF2->F2_ESPECIE:=QUERY->F2_ESPECIE
		SF2->F2_PDV:=QUERY->F2_PDV
		SF2->F2_MAPA:=QUERY->F2_MAPA
		SF2->F2_ECF:=QUERY->F2_ECF
		SF2->F2_FLSERV:=QUERY->F2_FLSERV
		SF2->F2_PREFIXO:=QUERY->F2_PREFIXO
		SF2->F2_BASIMP1:=QUERY->F2_BASIMP1
		SF2->F2_BASIMP2:=QUERY->F2_BASIMP2
		SF2->F2_BASIMP3:=QUERY->F2_BASIMP3
		SF2->F2_BASIMP4:=QUERY->F2_BASIMP4
		SF2->F2_BASIMP5:=QUERY->F2_BASIMP5
		SF2->F2_BASIMP6:=QUERY->F2_BASIMP6
		SF2->F2_VALIMP1:=QUERY->F2_VALIMP1
		SF2->F2_VALIMP2:=QUERY->F2_VALIMP2
		SF2->F2_VALIMP3:=QUERY->F2_VALIMP3
		SF2->F2_VALIMP4:=QUERY->F2_VALIMP4
		SF2->F2_VALIMP5:=QUERY->F2_VALIMP5
		SF2->F2_VALIMP6:=QUERY->F2_VALIMP6
		SF2->F2_ORDPAGO:=QUERY->F2_ORDPAGO
		SF2->F2_NFCUPOM:=QUERY->F2_NFCUPOM
		SF2->F2_VALINSS:=QUERY->F2_VALINSS
		SF2->F2_HORA:=QUERY->F2_HORA
		//SF2->F2_X_COPFL:=QUERY->F2_X_COPFL
		SF2->F2_X_PROC:=QUERY->F2_X_PROC
		SF2->F2_BASEINS:=QUERY->F2_BASEINS
		SF2->F2_LOTE:=QUERY->F2_LOTE
		SF2->F2_MOEDA:=QUERY->F2_MOEDA
		SF2->F2_REGIAO:=QUERY->F2_REGIAO
		SF2->F2_TXMOEDA:=QUERY->F2_TXMOEDA
		SF2->F2_VALCOFI:=QUERY->F2_VALCOFI
		SF2->F2_VALCSLL:=QUERY->F2_VALCSLL
		SF2->F2_VALPIS:=QUERY->F2_VALPIS
		SF2->F2_VALIRRF:=QUERY->F2_VALIRRF
		SF2->F2_CARGA:=QUERY->F2_CARGA
		SF2->F2_SEQCAR:=QUERY->F2_SEQCAR
		SF2->F2_NEXTSER:=QUERY->F2_NEXTSER
		SF2->F2_PEDPEND:=QUERY->F2_PEDPEND
		SF2->F2_DESCCAB:=QUERY->F2_DESCCAB
		SF2->F2_DTENTR:=QUERY->F2_DTENTR
		SF2->F2_FORMUL:=QUERY->F2_FORMUL
		SF2->F2_TIPODOC:=QUERY->F2_TIPODOC
		SF2->F2_NFEACRS:=QUERY->F2_NFEACRS
		SF2->F2_TIPOREM:=QUERY->F2_TIPOREM
		SF2->F2_SEQENT:=QUERY->F2_SEQENT
		SF2->F2_VALACRS:=QUERY->F2_VALACRS
		SF2->F2_ICMSDIF:=QUERY->F2_ICMSDIF
		SF2->F2_RECISS:=QUERY->F2_RECISS
		SF2->F2_BASEPS3:=QUERY->F2_BASEPS3
		SF2->F2_VALPS3:=QUERY->F2_VALPS3
		SF2->F2_BASECF3:=QUERY->F2_BASECF3
		SF2->F2_VALCF3:=QUERY->F2_VALCF3
		SF2->F2_TIPORET:=QUERY->F2_TIPORET
		SF2->F2_NFELETR:=QUERY->F2_NFELETR
		SF2->F2_EMINFE:=QUERY->F2_EMINFE
		SF2->F2_HORNFE:=QUERY->F2_HORNFE
		SF2->F2_VEICUL1:=QUERY->F2_VEICUL1
		SF2->F2_VEICUL2:=QUERY->F2_VEICUL2
		SF2->F2_CREDNFE:=QUERY->F2_CREDNFE
		SF2->F2_CODNFE:=QUERY->F2_CODNFE
		//SF2->F2_HAWB:=QUERY->F2_HAWB
		SF2->F2_VLR_FRT:=QUERY->F2_VLR_FRT
		SF2->F2_VEICUL3:=QUERY->F2_VEICUL3
		SF2->F2_DTDIGIT:=QUERY->F2_DTDIGIT
		SF2->F2_USERLGI:=QUERY->F2_USERLGI
		SF2->F2_USERLGA:=QUERY->F2_USERLGA
		SF2->F2_RECFAUT:=QUERY->F2_RECFAUT
		SF2->F2_VALFDS:=QUERY->F2_VALFDS
		SF2->F2_CLIENT:=QUERY->F2_CLIENT
		SF2->F2_LOJENT:=QUERY->F2_LOJENT
		SF2->F2_ESTCRED:=QUERY->F2_ESTCRED
		SF2->F2_BASEIRR:=QUERY->F2_BASEIRR
		SF2->F2_BASETST:=QUERY->F2_BASETST
		SF2->F2_VALTST:=QUERY->F2_VALTST
		SF2->F2_FLAGDEV:=QUERY->F2_FLAGDEV
		SF2->F2_FILDEST:=QUERY->F2_FILDEST
		SF2->F2_TPNFEXP:=QUERY->F2_TPNFEXP
		SF2->F2_CHVNFE:=QUERY->F2_CHVNFE
		SF2->F2_NODIA:=QUERY->F2_NODIA
		SF2->F2_TPFRETE:=QUERY->F2_TPFRETE
		SF2->F2_DIACTB:=QUERY->F2_DIACTB
		SF2->F2_BASPIS:=QUERY->F2_BASPIS
		SF2->F2_CGCCLI:=QUERY->F2_CGCCLI
		SF2->F2_REFTAXA:=QUERY->F2_REFTAXA
		SF2->F2_NFICMST:=QUERY->F2_NFICMST
		SF2->F2_BASCOFI:=QUERY->F2_BASCOFI
		SF2->F2_PREFORI:=QUERY->F2_PREFORI
		SF2->F2_BASCSLL:=QUERY->F2_BASCSLL
		SF2->F2_REFMOED:=QUERY->F2_REFMOED
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")

_cQuery :=	""
_cQuery +=	"SELECT DISTINCT * FROM Consulta.dbo.SE1010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY E1_FILIAL, E1_PREFIXO, E1_NUM, E1_PARCELA, E1_TIPO"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "E1_LIDESCF"  , "D" )
TcSetField( "QUERY", "E1_CARTVAL"  , "D" )
TcSetField( "QUERY", "E1_EMISSAO"  , "D" )
TcSetField( "QUERY", "E1_VENCTO"  , "D" )
TcSetField( "QUERY", "E1_VENCREA"  , "D" )
TcSetField( "QUERY", "E1_VENCORI"  , "D" )
TcSetField( "QUERY", "E1_BAIXA"  , "D" )
TcSetField( "QUERY", "E1_DATABOR"  , "D" )
TcSetField( "QUERY", "E1_EMIS1"  , "D" )
TcSetField( "QUERY", "E1_DTVARIA"  , "D" )
TcSetField( "QUERY", "E1_DTFATUR"  , "D" )
TcSetField( "QUERY", "E1_DTPRORR"  , "D" )
TcSetField( "QUERY", "E1_DTACRED"  , "D" )
TcSetField( "QUERY", "E1_DTDESC1"  , "D" )
TcSetField( "QUERY", "E1_DTDESC2"  , "D" )
TcSetField( "QUERY", "E1_DTDESC3"  , "D" )
TcSetField( "QUERY", "E1_DATAEDI"  , "D" )
TcSetField( "QUERY", "E1_MOVIMEN"  , "D" )


dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SE1 "+QUERY->(E1_FILIAL+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO))
	
	dbSelectArea("SE1")
	dbSetOrder(1)
	If !dbSeek(QUERY->(E1_FILIAL+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO),.F.)
		RecLock("SE1",.T.)
		SE1->E1_FILIAL:=QUERY->E1_FILIAL
		SE1->E1_PREFIXO:=QUERY->E1_PREFIXO
		SE1->E1_NUM:=QUERY->E1_NUM
		SE1->E1_PARCELA:=QUERY->E1_PARCELA
		SE1->E1_TIPO:=QUERY->E1_TIPO
		SE1->E1_NATUREZ:=QUERY->E1_NATUREZ
		SE1->E1_NUMLIQ:=QUERY->E1_NUMLIQ
		SE1->E1_PORTADO:=QUERY->E1_PORTADO
		SE1->E1_SITUACA:=QUERY->E1_SITUACA
		SE1->E1_AGEDEP:=QUERY->E1_AGEDEP
		SE1->E1_CLIENTE:=QUERY->E1_CLIENTE
		SE1->E1_LOJA:=QUERY->E1_LOJA
		SE1->E1_NOMCLI:=QUERY->E1_NOMCLI
		SE1->E1_EMISSAO:=QUERY->E1_EMISSAO
		SE1->E1_VENCTO:=QUERY->E1_VENCTO
		SE1->E1_VENCREA:=QUERY->E1_VENCREA
		SE1->E1_VALOR:=QUERY->E1_VALOR
		SE1->E1_IRRF:=QUERY->E1_IRRF
		SE1->E1_ISS:=QUERY->E1_ISS
		SE1->E1_NUMBCO:=QUERY->E1_NUMBCO
		SE1->E1_INDICE:=QUERY->E1_INDICE
		SE1->E1_BAIXA:=QUERY->E1_BAIXA
		SE1->E1_NUMBOR:=QUERY->E1_NUMBOR
		SE1->E1_DATABOR:=QUERY->E1_DATABOR
		SE1->E1_EMIS1:=QUERY->E1_EMIS1
		SE1->E1_HIST:=QUERY->E1_HIST
		SE1->E1_LA:=QUERY->E1_LA
		SE1->E1_LOTE:=QUERY->E1_LOTE
		SE1->E1_MOTIVO:=QUERY->E1_MOTIVO
		SE1->E1_MOVIMEN:=QUERY->E1_MOVIMEN
		SE1->E1_OP:=QUERY->E1_OP
		SE1->E1_CONTRAT:=QUERY->E1_CONTRAT
		SE1->E1_SALDO:=QUERY->E1_SALDO
		SE1->E1_SUPERVI:=QUERY->E1_SUPERVI
		SE1->E1_VEND1:=QUERY->E1_VEND1
		SE1->E1_VEND2:=QUERY->E1_VEND2
		SE1->E1_VEND3:=QUERY->E1_VEND3
		SE1->E1_VEND4:=QUERY->E1_VEND4
		SE1->E1_VEND5:=QUERY->E1_VEND5
		SE1->E1_COMIS1:=QUERY->E1_COMIS1
		SE1->E1_COMIS2:=QUERY->E1_COMIS2
		SE1->E1_COMIS3:=QUERY->E1_COMIS3
		SE1->E1_COMIS4:=QUERY->E1_COMIS4
		SE1->E1_COMIS5:=QUERY->E1_COMIS5
		SE1->E1_DESCONT:=QUERY->E1_DESCONT
		SE1->E1_MULTA:=QUERY->E1_MULTA
		SE1->E1_JUROS:=QUERY->E1_JUROS
		SE1->E1_CORREC:=QUERY->E1_CORREC
		SE1->E1_VALLIQ:=QUERY->E1_VALLIQ
		SE1->E1_VENCORI:=QUERY->E1_VENCORI
		SE1->E1_CONTA:=QUERY->E1_CONTA
		SE1->E1_VALJUR:=QUERY->E1_VALJUR
		SE1->E1_PORCJUR:=QUERY->E1_PORCJUR
		SE1->E1_MOEDA:=QUERY->E1_MOEDA
		SE1->E1_BASCOM1:=QUERY->E1_BASCOM1
		SE1->E1_BASCOM2:=QUERY->E1_BASCOM2
		SE1->E1_BASCOM3:=QUERY->E1_BASCOM3
		SE1->E1_BASCOM4:=QUERY->E1_BASCOM4
		SE1->E1_BASCOM5:=QUERY->E1_BASCOM5
		SE1->E1_FATPREF:=QUERY->E1_FATPREF
		SE1->E1_FATURA:=QUERY->E1_FATURA
		SE1->E1_OK:=QUERY->E1_OK
		SE1->E1_PROJETO:=QUERY->E1_PROJETO
		SE1->E1_CLASCON:=QUERY->E1_CLASCON
		SE1->E1_VALCOM1:=QUERY->E1_VALCOM1
		SE1->E1_VALCOM2:=QUERY->E1_VALCOM2
		SE1->E1_VALCOM3:=QUERY->E1_VALCOM3
		SE1->E1_VALCOM4:=QUERY->E1_VALCOM4
		SE1->E1_VALCOM5:=QUERY->E1_VALCOM5
		SE1->E1_OCORREN:=QUERY->E1_OCORREN
		SE1->E1_INSTR1:=QUERY->E1_INSTR1
		SE1->E1_INSTR2:=QUERY->E1_INSTR2
		SE1->E1_PEDIDO:=QUERY->E1_PEDIDO
		SE1->E1_DTVARIA:=QUERY->E1_DTVARIA
		SE1->E1_VARURV:=QUERY->E1_VARURV
		SE1->E1_VLCRUZ:=QUERY->E1_VLCRUZ
		SE1->E1_DTFATUR:=QUERY->E1_DTFATUR
		SE1->E1_NUMNOTA:=QUERY->E1_NUMNOTA
		SE1->E1_SERIE:=QUERY->E1_SERIE
		SE1->E1_STATUS:=QUERY->E1_STATUS
		SE1->E1_ORIGEM:=QUERY->E1_ORIGEM
		SE1->E1_IDENTEE:=QUERY->E1_IDENTEE
		SE1->E1_NUMCART:=QUERY->E1_NUMCART
		SE1->E1_FLUXO:=QUERY->E1_FLUXO
		SE1->E1_DESCFIN:=QUERY->E1_DESCFIN
		SE1->E1_DIADESC:=QUERY->E1_DIADESC
		SE1->E1_CARTAO:=QUERY->E1_CARTAO
		SE1->E1_CARTVAL:=QUERY->E1_CARTVAL
		SE1->E1_CARTAUT:=QUERY->E1_CARTAUT
		SE1->E1_ADM:=QUERY->E1_ADM
		SE1->E1_VLRREAL:=QUERY->E1_VLRREAL
		SE1->E1_TRANSF:=QUERY->E1_TRANSF
		SE1->E1_BCOCHQ:=QUERY->E1_BCOCHQ
		SE1->E1_AGECHQ:=QUERY->E1_AGECHQ
		SE1->E1_CTACHQ:=QUERY->E1_CTACHQ
		SE1->E1_FLSERV:=QUERY->E1_FLSERV
		SE1->E1_ORDPAGO:=QUERY->E1_ORDPAGO
		SE1->E1_INSS:=QUERY->E1_INSS
		SE1->E1_DESPBCO:=QUERY->E1_DESPBCO
		SE1->E1_NOTADEB:=QUERY->E1_NOTADEB
		SE1->E1_OKD:=QUERY->E1_OKD
		SE1->E1_CHQPGO:=QUERY->E1_CHQPGO
		SE1->E1_DTPRORR:=QUERY->E1_DTPRORR
		SE1->E1_COFINS:=QUERY->E1_COFINS
		SE1->E1_CSLL:=QUERY->E1_CSLL
		SE1->E1_FILORIG:=QUERY->E1_FILORIG
		SE1->E1_FLAGFAT:=QUERY->E1_FLAGFAT
		SE1->E1_PIS:=QUERY->E1_PIS
		SE1->E1_TIPOFAT:=QUERY->E1_TIPOFAT
		SE1->E1_TIPOLIQ:=QUERY->E1_TIPOLIQ
		SE1->E1_MESBASE:=QUERY->E1_MESBASE
		SE1->E1_ANOBASE:=QUERY->E1_ANOBASE
		SE1->E1_PLNUCOB:=QUERY->E1_PLNUCOB
		SE1->E1_CODINT:=QUERY->E1_CODINT
		SE1->E1_CODEMP:=QUERY->E1_CODEMP
		SE1->E1_MATRIC:=QUERY->E1_MATRIC
		SE1->E1_ACRESC:=QUERY->E1_ACRESC
		SE1->E1_SDACRES:=QUERY->E1_SDACRES
		SE1->E1_DECRESC:=QUERY->E1_DECRESC
		SE1->E1_SDDECRE:=QUERY->E1_SDDECRE
		SE1->E1_MULTNAT:=QUERY->E1_MULTNAT
		SE1->E1_MSFIL:=QUERY->E1_MSFIL
		SE1->E1_MSEMP:=QUERY->E1_MSEMP
		SE1->E1_PROJPMS:=QUERY->E1_PROJPMS
		SE1->E1_TIPODES:=QUERY->E1_TIPODES
		SE1->E1_TXMOEDA:=QUERY->E1_TXMOEDA
		SE1->E1_DESDOBR:=QUERY->E1_DESDOBR
		SE1->E1_NRDOC:=QUERY->E1_NRDOC
		SE1->E1_MODSPB:=QUERY->E1_MODSPB
		SE1->E1_IDCNAB:=QUERY->E1_IDCNAB
		SE1->E1_PLCOEMP:=QUERY->E1_PLCOEMP
		SE1->E1_PLTPCOE:=QUERY->E1_PLTPCOE
		SE1->E1_CODCOR:=QUERY->E1_CODCOR
		SE1->E1_PARCCSS:=QUERY->E1_PARCCSS
		SE1->E1_CODORCA:=QUERY->E1_CODORCA
		SE1->E1_CODIMOV:=QUERY->E1_CODIMOV
		SE1->E1_RECIBO:=QUERY->E1_RECIBO
		SE1->E1_DTACRED:=QUERY->E1_DTACRED
		SE1->E1_EMITCHQ:=QUERY->E1_EMITCHQ
		SE1->E1_FILDEB:=QUERY->E1_FILDEB
		SE1->E1_NUMSOL:=QUERY->E1_NUMSOL
		SE1->E1_NUMRA:=QUERY->E1_NUMRA
		SE1->E1_SERREC:=QUERY->E1_SERREC
		SE1->E1_INSCRIC:=QUERY->E1_INSCRIC
		SE1->E1_DATAEDI:=QUERY->E1_DATAEDI
		SE1->E1_CODBAR:=QUERY->E1_CODBAR
		SE1->E1_CHQDEV:=QUERY->E1_CHQDEV
		SE1->E1_CODDIG:=QUERY->E1_CODDIG
		SE1->E1_LIDESCF:=QUERY->E1_LIDESCF
		SE1->E1_VLBOLSA:=QUERY->E1_VLBOLSA
		SE1->E1_NUMCRD:=QUERY->E1_NUMCRD
		SE1->E1_VLFIES:=QUERY->E1_VLFIES
		SE1->E1_DEBITO:=QUERY->E1_DEBITO
		SE1->E1_CCD:=QUERY->E1_CCD
		SE1->E1_ITEMD:=QUERY->E1_ITEMD
		SE1->E1_CLVLDB:=QUERY->E1_CLVLDB
		SE1->E1_CREDIT:=QUERY->E1_CREDIT
		SE1->E1_CCC:=QUERY->E1_CCC
		SE1->E1_ITEMC:=QUERY->E1_ITEMC
		SE1->E1_CLVLCR:=QUERY->E1_CLVLCR
		SE1->E1_DESCON1:=QUERY->E1_DESCON1
		SE1->E1_DESCON2:=QUERY->E1_DESCON2
		SE1->E1_DTDESC3:=QUERY->E1_DTDESC3
		SE1->E1_DTDESC1:=QUERY->E1_DTDESC1
		SE1->E1_DTDESC2:=QUERY->E1_DTDESC2
		SE1->E1_VLMULTA:=QUERY->E1_VLMULTA
		SE1->E1_DESCON3:=QUERY->E1_DESCON3
		SE1->E1_MOTNEG:=QUERY->E1_MOTNEG
		SE1->E1_SABTPIS:=QUERY->E1_SABTPIS
		SE1->E1_SABTCOF:=QUERY->E1_SABTCOF
		SE1->E1_SABTCSL:=QUERY->E1_SABTCSL
		SE1->E1_BASEPIS:=QUERY->E1_BASEPIS
		SE1->E1_BASECOF:=QUERY->E1_BASECOF
		SE1->E1_BASECSL:=QUERY->E1_BASECSL
		SE1->E1_FORNISS:=QUERY->E1_FORNISS
		SE1->E1_PARTOT:=QUERY->E1_PARTOT
		SE1->E1_SITFAT:=QUERY->E1_SITFAT
		SE1->E1_VRETISS:=QUERY->E1_VRETISS
		SE1->E1_PARCIRF:=QUERY->E1_PARCIRF
		SE1->E1_SCORGP:=QUERY->E1_SCORGP
		SE1->E1_FRETISS:=QUERY->E1_FRETISS
		SE1->E1_TXMDCOR:=QUERY->E1_TXMDCOR
		SE1->E1_SATBIRF:=QUERY->E1_SATBIRF
		SE1->E1_TIPREG:=QUERY->E1_TIPREG
		SE1->E1_CONEMP:=QUERY->E1_CONEMP
		SE1->E1_VERCON:=QUERY->E1_VERCON
		SE1->E1_SUBCON:=QUERY->E1_SUBCON
		SE1->E1_VERSUB:=QUERY->E1_VERSUB
		SE1->E1_PLLOTE:=QUERY->E1_PLLOTE
		SE1->E1_PLOPELT:=QUERY->E1_PLOPELT
		SE1->E1_CODRDA:=QUERY->E1_CODRDA
		SE1->E1_FORMREC:=QUERY->E1_FORMREC
		SE1->E1_BCOCLI:=QUERY->E1_BCOCLI
		SE1->E1_AGECLI:=QUERY->E1_AGECLI
		SE1->E1_CTACLI:=QUERY->E1_CTACLI
		SE1->E1_PARCFET:=QUERY->E1_PARCFET
		SE1->E1_FETHAB:=QUERY->E1_FETHAB
		SE1->E1_NUMCON:=QUERY->E1_NUMCON
		SE1->E1_USERLGI:=QUERY->E1_USERLGI
		SE1->E1_USERLGA:=QUERY->E1_USERLGA
		SE1->E1_APLVLMN:=QUERY->E1_APLVLMN
		SE1->E1_NFELETR:=QUERY->E1_NFELETR
		SE1->E1_VRETIRF:=QUERY->E1_VRETIRF
		SE1->E1_X_ND:=QUERY->E1_X_ND
		SE1->E1_BASEIRF:=QUERY->E1_BASEIRF
		SE1->E1_MDCRON:=QUERY->E1_MDCRON
		SE1->E1_MDCONTR:=QUERY->E1_MDCONTR
		SE1->E1_MEDNUME:=QUERY->E1_MEDNUME
		SE1->E1_MDPLANI:=QUERY->E1_MDPLANI
		SE1->E1_MDPARCE:=QUERY->E1_MDPARCE
		SE1->E1_MDREVIS:=QUERY->E1_MDREVIS
		SE1->E1_NUMMOV:=QUERY->E1_NUMMOV
		SE1->E1_PREFORI:=QUERY->E1_PREFORI
		SE1->E1_RELATO:=QUERY->E1_RELATO
		SE1->E1_TITPAI:=QUERY->E1_TITPAI
		SE1->E1_MDDESC:=QUERY->E1_MDDESC
		SE1->E1_MDMULT:=QUERY->E1_MDMULT
		SE1->E1_MULTDIA:=QUERY->E1_MULTDIA
		SE1->E1_RETCNTR:=QUERY->E1_RETCNTR
		SE1->E1_MDBONI:=QUERY->E1_MDBONI
		SE1->E1_NODIA:=QUERY->E1_NODIA
		SE1->E1_DOCTEF:=QUERY->E1_DOCTEF
		SE1->E1_BASEINS:=QUERY->E1_BASEINS
		SE1->E1_JURFAT:=QUERY->E1_JURFAT
		SE1->E1_DIACTB:=QUERY->E1_DIACTB
		SE1->E1_CODISS:=QUERY->E1_CODISS
		SE1->E1_IDLAN:=QUERY->E1_IDLAN
		SE1->E1_NSUTEF:=QUERY->E1_NSUTEF
		SE1->E1_SABTIRF:=QUERY->E1_SABTIRF
		SE1->E1_IDBOLET:=QUERY->E1_IDBOLET
		SE1->E1_IDAPLIC:=QUERY->E1_IDAPLIC
		SE1->E1_NOPER:=QUERY->E1_NOPER
		SE1->E1_BASEISS:=QUERY->E1_BASEISS
		SE1->E1_SEQBX:=QUERY->E1_SEQBX
		SE1->E1_LTCXA:=QUERY->E1_LTCXA
		SE1->E1_SERVICO:=QUERY->E1_SERVICO
		SE1->E1_PROCEL:=QUERY->E1_PROCEL
		SE1->E1_VLBOLP:=QUERY->E1_VLBOLP
		SE1->E1_NUMINSC:=QUERY->E1_NUMINSC
		MsUnLock()
	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")

*/

_cQuery :=	""
_cQuery +=	"SELECT * FROM Consulta.dbo.SE5010 WHERE D_E_L_E_T_ = '' "
_cQuery +=	"ORDER BY E5_FILIAL, E5_DATA, E5_BANCO, E5_AGENCIA, E5_CONTA, E5_NUMCHEQ"

dbUseArea(.T.,"TOPCONN",TcGenQry(,,_cQuery),"QUERY",.T.,.F.)

TcSetField( "QUERY", "E5_DATA"  	, "D" )
TcSetField( "QUERY", "E5_VENCTO"  	, "D" )
TcSetField( "QUERY", "E5_DTDISPO"  	, "D" )
TcSetField( "QUERY", "E5_DTDIGIT"  	, "D" )


dbSelectArea("QUERY")
ProcRegua(LastRec())

While Eof() == .f.
	
	IncProc("Processando SE5 "+QUERY->(E5_FILIAL+DTOS(E5_DATA)+E5_BANCO+E5_AGENCIA+E5_CONTA+E5_NUMCHEQ))
	
	//If Dtos(QUERY->E5_DATA) <= '20100831'
	//	dbSelectArea("QUERY")
    //    dbSkip()
    //    Loop
	//EndIf

//	dbSelectArea("SE5")
//	dbSetOrder(1)
//	If !dbSeek(QUERY->(E5_FILIAL+DTOS(E5_DATA)+E5_BANCO+E5_AGENCIA+E5_CONTA+E5_NUMCHEQ),.F.)
		RecLock("SE5",.T.)
		SE5->E5_FILIAL:=QUERY->E5_FILIAL
		SE5->E5_DATA:=QUERY->E5_DATA
		SE5->E5_TIPO:=QUERY->E5_TIPO
		SE5->E5_MOEDA:=QUERY->E5_MOEDA
		SE5->E5_VALOR:=QUERY->E5_VALOR
		SE5->E5_NATUREZ:=QUERY->E5_NATUREZ
		SE5->E5_BANCO:=QUERY->E5_BANCO
		SE5->E5_AGENCIA:=QUERY->E5_AGENCIA
		SE5->E5_CONTA:=QUERY->E5_CONTA
		SE5->E5_NUMCHEQ:=QUERY->E5_NUMCHEQ
		SE5->E5_DOCUMEN:=QUERY->E5_DOCUMEN
		SE5->E5_VENCTO:=QUERY->E5_VENCTO
		SE5->E5_RECPAG:=QUERY->E5_RECPAG
		SE5->E5_BENEF:=QUERY->E5_BENEF
		SE5->E5_HISTOR:=QUERY->E5_HISTOR
		SE5->E5_TIPODOC:=QUERY->E5_TIPODOC
		SE5->E5_VLMOED2:=QUERY->E5_VLMOED2
		SE5->E5_LA:=QUERY->E5_LA
		SE5->E5_SITUACA:=QUERY->E5_SITUACA
		SE5->E5_LOTE:=QUERY->E5_LOTE
		SE5->E5_PREFIXO:=QUERY->E5_PREFIXO
		SE5->E5_NUMERO:=QUERY->E5_NUMERO
		SE5->E5_PARCELA:=QUERY->E5_PARCELA
		SE5->E5_CLIFOR:=QUERY->E5_CLIFOR
		SE5->E5_LOJA:=QUERY->E5_LOJA
		SE5->E5_DTDIGIT:=QUERY->E5_DTDIGIT
		SE5->E5_TIPOLAN:=QUERY->E5_TIPOLAN
		SE5->E5_DEBITO:=QUERY->E5_DEBITO
		SE5->E5_CREDITO:=QUERY->E5_CREDITO
		SE5->E5_MOTBX:=QUERY->E5_MOTBX
		SE5->E5_RATEIO:=QUERY->E5_RATEIO
		SE5->E5_RECONC:=QUERY->E5_RECONC
		SE5->E5_SEQ:=QUERY->E5_SEQ
		SE5->E5_DTDISPO:=QUERY->E5_DTDISPO
		SE5->E5_CCD:=QUERY->E5_CCD
		SE5->E5_CCC:=QUERY->E5_CCC
		SE5->E5_OK:=QUERY->E5_OK
		SE5->E5_ARQRAT:=QUERY->E5_ARQRAT
		SE5->E5_IDENTEE:=QUERY->E5_IDENTEE
		SE5->E5_FLSERV:=QUERY->E5_FLSERV
		SE5->E5_ORDREC:=QUERY->E5_ORDREC
		SE5->E5_ARQCNAB:=QUERY->E5_ARQCNAB
		SE5->E5_FILORIG:=QUERY->E5_FILORIG
		SE5->E5_VLCORRE:=QUERY->E5_VLCORRE
		SE5->E5_VLDESCO:=QUERY->E5_VLDESCO
		SE5->E5_VLJUROS:=QUERY->E5_VLJUROS
		SE5->E5_VLMULTA:=QUERY->E5_VLMULTA
		SE5->E5_CNABOC:=QUERY->E5_CNABOC
		SE5->E5_SITUA:=QUERY->E5_SITUA
		SE5->E5_ITEMD:=QUERY->E5_ITEMD
		SE5->E5_ITEMC:=QUERY->E5_ITEMC
		SE5->E5_CLVLDB:=QUERY->E5_CLVLDB
		SE5->E5_CLVLCR:=QUERY->E5_CLVLCR
		SE5->E5_PROJPMS:=QUERY->E5_PROJPMS
		SE5->E5_EDTPMS:=QUERY->E5_EDTPMS
		SE5->E5_TASKPMS:=QUERY->E5_TASKPMS
		SE5->E5_MODSPB:=QUERY->E5_MODSPB
		SE5->E5_TXMOEDA:=QUERY->E5_TXMOEDA
		SE5->E5_CODORCA:=QUERY->E5_CODORCA
		SE5->E5_FATURA:=QUERY->E5_FATURA
		SE5->E5_FATPREF:=QUERY->E5_FATPREF
		SE5->E5_SITCOB:=QUERY->E5_SITCOB
		SE5->E5_FORNADT:=QUERY->E5_FORNADT
		SE5->E5_LOJAADT:=QUERY->E5_LOJAADT
		SE5->E5_CLIENTE:=QUERY->E5_CLIENTE
		SE5->E5_FORNECE:=QUERY->E5_FORNECE
		SE5->E5_SERREC:=QUERY->E5_SERREC
		SE5->E5_OPERAD:=QUERY->E5_OPERAD
		SE5->E5_MOVCX:=QUERY->E5_MOVCX
		SE5->E5_KEY:=QUERY->E5_KEY
		SE5->E5_MULTNAT:=QUERY->E5_MULTNAT
		SE5->E5_AGLIMP:=QUERY->E5_AGLIMP
		SE5->E5_VRETPIS:=QUERY->E5_VRETPIS
		SE5->E5_VRETCOF:=QUERY->E5_VRETCOF
		SE5->E5_VRETCSL:=QUERY->E5_VRETCSL
		SE5->E5_PRETPIS:=QUERY->E5_PRETPIS
		SE5->E5_PRETCOF:=QUERY->E5_PRETCOF
		SE5->E5_PRETCSL:=QUERY->E5_PRETCSL
		SE5->E5_VLACRES:=QUERY->E5_VLACRES
		SE5->E5_VLDECRE:=QUERY->E5_VLDECRE
		SE5->E5_AUTBCO:=QUERY->E5_AUTBCO
		SE5->E5_PRETIRF:=QUERY->E5_PRETIRF
		SE5->E5_VRETIRF:=QUERY->E5_VRETIRF
		SE5->E5_VRETISS:=QUERY->E5_VRETISS
		SE5->E5_USERLGI:=QUERY->E5_USERLGI
		SE5->E5_USERLGA:=QUERY->E5_USERLGA
		SE5->E5_PROCTRA:=QUERY->E5_PROCTRA
		SE5->E5_NUMMOV:=QUERY->E5_NUMMOV
		SE5->E5_BASEIRF:=QUERY->E5_BASEIRF
		SE5->E5_NODIA:=QUERY->E5_NODIA
		SE5->E5_DIACTB:=QUERY->E5_DIACTB
		MsUnLock()
//	EndIf
	
	DbSelectArea("QUERY")
	dbSkip()
	
EndDo

DbSelectArea("QUERY")
DbCloseArea("QUERY")


Return

