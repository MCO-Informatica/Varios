
SELECT * FROM SFT010 WHERE FT_ENTRADA BETWEEN '20210801' AND '20210831' AND FT_CFOP >= '5000'

UPDATE SFT010 SET FT_BASECOF = FT_BASECOF - FT_VALICM WHERE FT_ENTRADA BETWEEN '20210801' AND '20210831' AND FT_CFOP >= '5000'
UPDATE SFT010 SET FT_BASEPIS = FT_BASEPIS - FT_VALICM WHERE FT_ENTRADA BETWEEN '20210801' AND '20210831' AND FT_CFOP >= '5000'
UPDATE SFT010 SET FT_VALCOF = ROUND((FT_BASECOF*(FT_ALIQCOF/100)),2) WHERE FT_ENTRADA BETWEEN '20210801' AND '20210831' AND FT_CFOP >= '5000'
UPDATE SFT010 SET FT_VALPIS = ROUND((FT_BASEPIS*(FT_ALIQPIS/100)),2) WHERE FT_ENTRADA BETWEEN '20210801' AND '20210831' AND FT_CFOP >= '5000'

SELECT * FROM SD2010 WHERE D2_EMISSAO BETWEEN '20210801' AND '20210831' AND D2_TIPO NOT IN ('B','D')

UPDATE SD2010 SET D2_BASIMP5 = D2_BASIMP5 - D2_VALICM WHERE D2_EMISSAO BETWEEN '20210801' AND '20210831' AND D2_TIPO NOT IN ('B','D') 
UPDATE SD2010 SET D2_BASIMP6 = D2_BASIMP6 - D2_VALICM WHERE D2_EMISSAO BETWEEN '20210801' AND '20210831' AND D2_TIPO NOT IN ('B','D')
UPDATE SD2010 SET D2_VALIMP5 = ROUND((D2_BASIMP5*(D2_ALQIMP5/100)),2) WHERE D2_EMISSAO BETWEEN '20210801' AND '20210831' AND D2_TIPO NOT IN ('B','D') 
UPDATE SD2010 SET D2_VALIMP6 = ROUND((D2_BASIMP6*(D2_ALQIMP6/100)),2) WHERE D2_EMISSAO BETWEEN '20210801' AND '20210831' AND D2_TIPO NOT IN ('B','D') 

