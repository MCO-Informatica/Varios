#INCLUDE "PROTHEUS.CH"
#INCLUDE "Rwmake.CH"
/*


Ŀ
Funo     RFATA017  Autor  	Robson Bueno          Data  18.04.07 
Ĵ
Descrio  Alimentacao de FOLLOW-UP de entrega                         
                                                                       
Ĵ
Uso        ...                                                         
Ĵ
 ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL.                      
Ĵ
 PROGRAMADOR   DATA    BOPS   MOTIVO DA ALTERACAO                    
Ĵ
XXXXXXXXXXXXXXXX/XX/XXXXXXXX                                         
ٱ


*/
User Function RFATA017()
//Ŀ
// Define Variaveis                                     
//
Local aCores    := {},aCampos:={}

aCores    := {{	'C6_QTDENT<>C6_QTDVEN', 'BR_VERDE'},;	        // Pedido a Faturar
			   {'C6_QTDENT==C6_QTDVEN', 'BR_VERMELHO'}}        // Pedido Faturado

PRIVATE aRotina := { { "Pesquisar","AxPesqui"  ,0,1},;       // Pesquisa  PI
					 { "Visualizar","AxVisual",0,2},;        //  Vizualiza PI
                     { "Env.Sep.","U_RFTL17C",0,3},;        //  Vizualiza PI
                     { "Ret.Sep.","U_RFTL17D",0,4},;        //  Vizualiza PI
                     { "Disposicao","U_RFTL17A",0,5},;       // Aprova SA Bloqueada                       
					 { "Legenda","U_RFTL17B",0,6} }  
						
//Ŀ
// Define o cabecalho da tela de atualizacoes           
//
PRIVATE cCadastro := OemToAnsi("Follow-up do PV")

//Ŀ
// Endereca a funcao de BROWSE                          
// 
aCampos := {{"Pedido","C6_NUM"},{"Item","C6_ITEM"},{"Codigo","C6_PRODUTO"},{"Descricao","C6_DESCRI"},{"Qtd","C6_QTDVEN"},{"Entregue","C6_QTDENT"},{"Prazo","C6_ENTREG"},{"Disposicao","C6_STATUS"}}
mBrowse(6,1,22,75,"SC6",aCampos,,,,3,aCores)

Return(.T.) 

//Ŀ
// Legenda									             
//
                 
User Function RFTL17B()

BrwLegenda(cCadastro,"Situacoes",{{"BR_VERMELHO","Pedido Ja Faturado"}, {"BR_VERDE","Pedido a Faturar"}})

Return (.T.) 

//Ŀ
// Dialogo para insersao de followup                    
//

User Function RFTL17A()

Local oDlgl

PRIVATE cStatus:=SC6->C6_STATUS

		
@ 000,000 To 400,400 Dialog Odlg1 Title OemToAnsi("Follow up de vendas")
@ 003,004 To 25,200 Title OemToAnsi("Processo") 
@ 010,015 Say OemToAnsi("Pedido") OF Odlgl PIXEL
//@ 035,015 GET cTpAverb SIZE 30,10 F3 "12" 
@ 010,055 Say SC6->C6_NUM SIZE 45,10 PICTURE PesqPict("SC6","C6_NUM")OF Odlgl PIXEL
@ 010,115 Say OemToAnsi("Item")OF Odlgl PIXEL
//@ 035,015 GET cTpAverb SIZE 30,10 F3 "12" 
@ 010,155 say SC6->C6_ITEM SIZE 30,10 PICTURE PesqPict("SC6","C6_ITEM")OF Odlgl PIXEL


@ 027,004 To 120,200 Title OemToAnsi("Dados do Produto") 
@ 035,015 Say OemToAnsi("Produto")OF Odlgl PIXEL
@ 035,055 Say SC6->C6_PRODUTO SIZE 100,10 PICTURE PesqPict("SC6","C6_COD") OF Odlgl PIXEL  
@ 047,015 Say OemToAnsi("Descricao")OF Odlgl PIXEL
@ 047,055 SAY SC6->C6_DESCRI SIZE 200,10 PICTURE PesqPict("SC6","C6_DESCRI")OF Odlgl PIXEL
@ 059,015 Say OemToAnsi("Qtd Venda")OF Odlgl PIXEL
@ 059,055 SAY SC6->C6_QTDVEN SIZE 30,10 PICTURE PesqPict("SC6","C6_QTDVEN")OF Odlgl PIXEL
@ 071,015 Say OemToAnsi("Qtd Entr.")OF Odlgl PIXEL
@ 071,055 SAY SC6->C6_QTDENT SIZE 30,10 PICTURE PesqPict("SC6","C6_QTDENT")OF Odlgl PIXEL
@ 083,015 Say OemToAnsi("Prazo")OF Odlgl PIXEL
@ 083,055 SAY SC6->C6_ENTREG SIZE 40,10 PICTURE PesqPict("SC6","C6_ENTREG") OF Odlgl PIXEL 

@ 123,004 To 170,200 Title OemToAnsi("Follow_up") 
@ 130,015 msGET cStatus SIZE 170,10 PICTURE PesqPict("SC6","C6_STATUS")OF Odlgl PIXEL
 
@ 180,100 BMPBUTTON TYPE 1 ACTION OkProc(odlg1)
@ 180,150 BMPBUTTON TYPE 2 ACTION FINALIZA(odlg1)

Activate Dialog Odlg1 CENTER

Return(.T.)

Static Function Finaliza(Odlg1)

Close(Odlg1)

RETURN
/*


ͻ
Programa  OkProc    Autor  Robson Bueno         Data  10/08/2006  
͹
Desc.     Confirmacao do Processo de digitacao dados                  
                                                                      
͹
Uso       HCI                                                         
ͼ


*/
Static Function OkProc(odlg1)
*
Local cAliasSC6 := GetArea()
RecLock("SC6",.F.)
SC6->C6_STATUS := cStatus 
MsUnLock()
*
Close(Odlg1)
RestArea(cAliaSSC6)
*
Return
                 
