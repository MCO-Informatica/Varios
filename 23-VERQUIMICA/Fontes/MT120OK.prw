#Include "Protheus.Ch"

/*
==============================================================================
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||+---------------------+-------------------------------+------------------+||
||| Programa: MT120OK   | Autor: Celso Ferrone Martins  | Data: 01/07/2015 |||
||+-----------+---------+-------------------------------+------------------+||
||| Descricao |                                                            |||
||+-----------+------------------------------------------------------------+||
||| Alteracao |                                                            |||
||+-----------+------------------------------------------------------------+||
||| Uso       |                                                            |||
||+-----------+------------------------------------------------------------+||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
==============================================================================
*/
User Function MT120OK()

Local lRet := .T.
Local nPosCc := aScan(aHeader,{|x| Alltrim(x[2])=="C7_CC"}) // Centro de Custo

IF nModulo <> 17 // 17 - SIGAEIC

	If Empty(cA120Cc)
		If !Empty(aCols[1][nPosCc])
			cA120Cc := aCols[1][nPosCc]
		EndIf
	EndIf

	If Empty(cA120Cc)
		lRet := .F.
		MsgAlert("Campo Centro de Custo nao pode ficar em branco.","Campo obrigatorio!!!")
	EndIf

	If ValType(lRet) <> "L"
		lRet := .T.
	EndIf

ENDIF

Return(lRet)
