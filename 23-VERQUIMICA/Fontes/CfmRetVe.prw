#Include "Protheus.Ch"

/*
==============================================================================
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
||+--------------------+--------------------------------+------------------+||
||| Programa: CfmRetVe | Autor: Celso Ferrone Martins   | Data: 05/11/2014 |||
||+-----------+--------+--------------------------------+------------------+||
||| Descricao |                                                            |||
||+-----------+------------------------------------------------------------+||
||| Descricao |                                                            |||
||+-----------+------------------------------------------------------------+||
||| Descricao |                                                            |||
||+-----------+------------------------------------------------------------+||
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
==============================================================================
*/
User Function CfmRetVe()

Local cCodVen := ""

Local aAreaSu7  := SU7->(GetArea())
Local aAreaSA3  := SA3->(GetArea())

DbSelectArea("SU7") ; DbSetOrder(4)
DbSelectArea("SA3") ; DbSetOrder(1)

If SU7->(DbSeek(xFilial("SU7") + __cUserId))
	If SA3->(DbSeek(xFilial("SA3")+SU7->U7_CODVEN))
		cCodVen := SA3->A3_COD
	EndIf
EndIf

SA3->(RestArea(aAreaSa3))
SU7->(RestArea(aAreaSu7))

Return(cCodVen)