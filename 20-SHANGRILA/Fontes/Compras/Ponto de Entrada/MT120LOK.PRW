#include "rwmake.ch"
/*


Ŀ
Programa   MT120LOK  Autor  Ricardo Correa de Souza  Data  17/05/2011 
Ĵ
Descricao Valida a Digitacao do Centro de Custo                           
Ĵ
Observacao                                                                
Ĵ
Uso        Shangri-la Industria e Comercio de Espanadores Ltda            
Ĵ
             ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL              
Ĵ
Programador     Data                Motivo da Alteracao                  
Ĵ
ٱ


*/

User Function MT120LOK()

Local _lRet		:=	.t.
Local _aArea    :=	GetArea()
Local _cTES		:=	aCols[n,aScan(aHeader,{|x| Alltrim(x[2])== "C7_TES"})]
Local _cProduto	:=	aCols[n,aScan(aHeader,{|x| Alltrim(x[2])== "C7_PRODUTO"})]
Local _cLocal	:=	aCols[n,aScan(aHeader,{|x| Alltrim(x[2])== "C7_LOCAL"})]

If Subs(_cProduto,1,1)$"Z"
 	If _cTES < '200' .Or. _cTES > '299'
   		MsgStop("TES informada fora do range 200  299 no  permitido.","TES Errada")
   		_lRet := .f.
   	EndIf
   	
   	If Posicione("SF4",1,xFilial("SF4")+_cTES,"F4_ESTOQUE")$"S" .and. !Subs(_cLocal,1,1)$"P"
   		MsgStop("Armazm informado fora do range P0  P9 no  permitido.","Armazm Errado")
   		_lRet := .f.
   	EndIf
ElseIf !Subs(_cProduto,1,1)$"Z" .And. Posicione("SF4",1,xFilial("SF4")+_cTES,"F4_ESTOQUE")$"S"
 	If _cTES >= '200' .And. _cTES <= '299'
   		MsgStop("TES informada dentro do range 200  299 no permitido.","TES Errada")
   		_lRet := .f.
   	EndIf
   	
   	If Posicione("SF4",1,xFilial("SF4")+_cTES,"F4_ESTOQUE")$"S" .and. Subs(_cLocal,1,1)$"P"
   		MsgStop("Armazm informado dentro do range P0  P9 no  permitido.","Armazm Errado")
   		_lRet := .f.
   	EndIf
EndIf

RestArea(_aArea)

Return(_lRet)
