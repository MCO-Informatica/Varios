#include "rwmake.ch" 

User Function Tribut()
                                      
SetPrvt("_LinTribut,")

If SEA->EA_MODELO=="17" //GPS
   _LinTribut:="01"+SE2->E2_ZZCGPS+SE2->E2_ZZCOGPS+SUBST(SM0->M0_CGC,1,14)+STRZERO(SE2->E2_VALOR*100,14)+STRZERO(SE2->E2_ACRESC*100,14)+"00000000000000"+STRZERO((SE2->E2_VALOR+SE2->E2_ACRESC)*100,14)+GRAVADATA(SE2->E2_VENCREA,.F.,5)+"        "+PADR((SE2->E2_PREFIXO+SE2->E2_NUM+SE2->E2_PARCELA),50,' ')+SUBSTR(SM0->M0_NOMECOM,1,30)
ElseIf SEA->EA_MODELO=="16" //DARF NORMAL
   _LinTribut:="02"+SE2->E2_ZZCODRE+"2"+SUBST(SM0->M0_CGC,1,14)+GRAVADATA(SE2->E2_EMISSAO,.F.,5)+SE2->E2_ZZNREF+STRZERO(SE2->E2_VALOR*100,14)+STRZERO(SE2->E2_ACRESC*100,14)+"00000000000000"+STRZERO((SE2->E2_VALOR+SE2->E2_ACRESC)*100,14)+GRAVADATA(SE2->E2_VENCTO,.F.,5)+GRAVADATA(SE2->E2_VENCREA,.F.,5)+SPACE(30)+SUBSTR(SM0->M0_NOMECOM,1,30)
ElseIf SE2->E2_TRIBUT=="15" //GARE ICMS
   _LinTribut:="05"+SE2->E2_ZZCODRE+"2"+SUBST(SM0->M0_CGC,1,14)+SUBST(SM0->M0_INSC,1,12)+SE2->E2_ZZDATV+SE2->E2_ZZCOGPS+SE2->E2_ZZPNOT+STRZERO(SE2->E2_VALOR*100,14)+STRZERO(SE2->E2_ACRESC*100,14)+"00000000000000"+STRZERO((SE2->E2_VALOR+SE2->E2_ACRESC)*100,14)+GRAVADATA(SE2->E2_VENCTO,.F.,5)+GRAVADATA(SE2->E2_VENCREA,.F.,5)+SPACE(11)+SUBSTR(SM0->M0_NOMECOM,1,30)
EndIf

Return(_LinTribut)