#include "rwmake.ch"

// Programa: fa070ca3
// Autor...: Alexandre Dalpiaz
// Data....: 05/03/2012

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// PE para validar o cancelamento/exclusão de baixa: se a data da baixa for diferente da database, não permite
///////////////////////////////////////////////////////////////////////////////////////////
User Function fa070ca4
///////////////////////
Local _lRet := .T.

If alltrim(SE5->E5_LA) == 'S'
	MsgAlert("Lançamento já sofreu contabilização, não pode ser alterado." + _cEnter + "Entre em contato com Depto de Contabilidade.")
	_lRet := .f.
EndIf
Return(_lRet)	


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// PE para validar a alteraçao de título a receber que ja tenha sido contabilizado
/////////////////////////////////////////////////////////////////////////////////
User Function FA040ALT()
////////////////////////
Local _lRet := .T.

If alltrim(SE1->E1_LA) == 'S' .and. left(SE1->E1_ORIGEM,3) == 'FIN' 
	MsgAlert("Este título já sofreu contabilização, não pode ser alterado." + _cEnter + "Entre em contato com Depto de Contabilidade.")
	_lRet := .f.
EndIf
Return(_lRet)	


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// PE para validar a exclusão de título a receber que ja tenha sido contabilizado
/////////////////////////////////////////////////////////////////////////////////
User Function FA040B01()
////////////////////////
Local _lRet := .T.

If alltrim(SE1->E1_LA) == 'S' .and. alltrim(SE1->E1_TIPO) <> 'RA'
	MsgAlert("Este título já sofreu contabilização, não poderá ser excluido." + _cEnter + "Entre em contato com Depto de Contabilidade.")
	_lRet := .f.
EndIf
Return(_lRet)	


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// PE para validar o cancelamento de uma fatura a receber que ja tenha sido contabilizado
/////////////////////////////////////////////////////////////////////////////////////////
User Function F280PCAN()
////////////////////////
Local _lRet := .F.

If alltrim(Posicione('SE1',1,xFilial('SE1') + FI7->FI7_PRFDES + FI7->FI7_NUMDES + FI7->FI7_PARDES + FI7->FI7_TIPDES,'E1_LA')) == 'S' 
	MsgAlert("Este fatura já sofreu contabilização, não poderá ser excluida." + _cEnter + "Entre em contato com Depto de Contabilidade.")
	_lRet := .T.
EndIf
Return(_lRet)	


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// PE para validar o cancelamento de uma fatura a receber que ja tenha sido contabilizado
/////////////////////////////////////////////////////////////////////////////////////////
User Function F330FLTC()
////////////////////////
Local _lRet := .F.

If SE1->E1_PREFIXO + SE1->E1_NUM + SE1->E1_PARCELA + SE1->E1_TIPO == SE5->E5_PREFIXO + SE5->E5_NUMERO + SE5->E5_PARCELA + SE5->E5_TIPO .and. alltrim(SE5->E5_LA) == 'S' 
	MsgAlert("Este movimentação já sofreu contabilização, não poderá ser excluída." + _cEnter + "Entre em contato com Depto de Contabilidade.")
	_lRet := .T.
EndIf
Return(_lRet)	
