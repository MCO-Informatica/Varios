#INCLUDE "rwmake.ch"
#INCLUDE "PROTHEUS.CH"


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
User Function ls_sx5()
//////////////////////

//UnLockByName( 'CTBANFSLOCKPROC01',.t.,.t.,.t.,.t. )

cVldAlt := ".T." // Validacao para permitir a alteracao. Pode-se utilizar ExecBlock.
cVldExc := ".T." // Validacao para permitir a exclusao. Pode-se utilizar ExecBlock.

cString := "SX5"
_cFiltro := ''
dbSelectArea("SX5")
dbSetOrder(1)

If !LS_SX5FIL()
	Return()
EndIf
SetKey(123,{|| LS_SX5FIL()}) // Seta a tecla F12 para acionamento dos parametros
                        
AxCadastro(cString,"Cadastro de Tabelas",cVldExc,cVldAlt)

Set Key 123 To // Desativa a tecla F12 do acionamento dos parametros

Return


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Static Function LS_SX5FIL()
///////////////////////////
Local _lRet 
cPerg := 'LS_SX5FIL'

dbSelectArea("SX5")
_cFilter := "SX5->X5_TABELA == '00'"
Set Filter to &_cFilter
_lRet := Pergunte(cPerg,.T.)

dbSelectArea("SX5")
_cFiltro := "SX5->X5_TABELA == '" + upper(mv_par01) + "'"
Set Filter to &_cFiltro
Return(_lRet)

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
User FUnction sigaesp()
///////////////////////
Return('Laselva')

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
User Function LS_UPDATE(_cQuery,_lRegua)
/////////////////////////////////////////

MsAguarde( {|| DbUseArea(.T., "TOPCONN", TCGenQry(,,_cQuery), 'UPD', .F., .T.)},'Selecionando registros')
                                       
If _lRegua
	count to _nLastRec
	DbGoTop()
	ProcRegua(_nLastRec)
EndIF
Do While !eof()
	If _lRegua 
		IncProc()
	EndIf
	TcSqlExec(UPD->CAMPO)
	DbSkip()
EndDo

DbCloseArea()

