#Include "RWMAKE.ch"
#Include "PROTHEUS.ch"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Programa   	LS_GATIPI
// Autor 		Alexandre Dalpiaz
// Data 		20/03/2013
// Descricao  	gatilho no campo D1_IPI - grava % do produto, caso esse esteja zerado
// Uso         	LaSelva
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
User Function LS_GatIPI(_nIPI,_cTes)
//////////////////////////////

If !empty(_cTes) .and. _nIPI > 0 .and. Posicione('SF4',1, xFIlial('SF4') + _cTes,'F4_IPI') == 'S'
	_cQuery := "UPDATE " + RetSqlName('SB1') + " SET B1_IPI = " + str(_nIPI) + " WHERE B1_COD = '" + GdFieldGet('D1_COD') + "'"
	TcSqlExec(_cQuery)     
EndIf

Return(_nIPI)


