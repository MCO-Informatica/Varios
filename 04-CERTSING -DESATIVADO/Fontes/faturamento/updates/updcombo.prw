#INCLUDE "protheus.ch"

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄ-ÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡ao    ³GH999999  ³ Autor ³ MICROSIGA             ³ Data ³ 12/02/2019 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ-ÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡ao ³ Funcao Principal                                           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄ-ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Uso       ³ Gestao Hospitalar                                          ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ-ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
User Function UPDCOMBO()

cArqEmp 					:= "SigaMat.Emp"
__cInterNet 	:= Nil

PRIVATE cMessage
PRIVATE aArqUpd	 := {}
PRIVATE aREOPEN	 := {}
PRIVATE oMainWnd
Private nModulo 	:= 51 // modulo SIGAHSP

Set Dele On

lEmpenho				:= .F.
lAtuMnu					:= .F.

Processa({|| ProcATU()},"Processando [UPDCOMBO]","Aguarde , processando preparação dos arquivos")

Return()


/*ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³ProcATU   ³ Autor ³                       ³ Data ³  /  /    ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Funcao de processamento da gravacao dos arquivos           ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Baseado na funcao criada por Eduardo Riera em 01/02/2002   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function ProcATU()
Local cTexto    	:= ""
Local cFile     	:= ""
Local cMask     	:= "Arquivos Texto (*.TXT) |*.txt|"
Local nRecno    	:= 0
Local nI        	:= 0
Local nX        	:= 0
Local aRecnoSM0 	:= {}
Local lOpen     	:= .F.

ProcRegua(1)
IncProc("Verificando integridade dos dicionários....")
If (lOpen := IIF(Alias() <> "SM0", MyOpenSm0Ex(), .T. ))

	dbSelectArea("SM0")
	dbGotop()
	While !Eof()
  		If Ascan(aRecnoSM0,{ |x| x[2] == M0_CODIGO}) == 0 .and. M0_CODIGO = "01"
			Aadd(aRecnoSM0,{Recno(),M0_CODIGO})
		EndIf			
		dbSkip()
	EndDo	

	If lOpen
		For nI := 1 To Len(aRecnoSM0)
			SM0->(dbGoto(aRecnoSM0[nI,1]))
			RpcSetType(2)
			RpcSetEnv(SM0->M0_CODIGO, SM0->M0_CODFIL)
 		nModulo := 51 // modulo SIGAHSP
			lMsFinalAuto := .F.
			cTexto += Replicate("-",128)+CHR(13)+CHR(10)
			cTexto += "Empresa : "+SM0->M0_CODIGO+SM0->M0_NOME+CHR(13)+CHR(10)

			ProcRegua(8)

			Begin Transaction

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Atualiza o dicionario de dados.³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IncProc("Analisando Dicionario de Dados...")
			cTexto += GeraSX3()
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³Atualiza os indices.³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IncProc("Analisando arquivos de índices. "+"Empresa : "+SM0->M0_CODIGO+" Filial : "+SM0->M0_CODFIL+"-"+SM0->M0_NOME)
			cTexto += GeraSIX()

			End Transaction
	
			__SetX31Mode(.F.)
			For nX := 1 To Len(aArqUpd)
				IncProc("Atualizando estruturas. Aguarde... ["+aArqUpd[nx]+"]")
				If Select(aArqUpd[nx])>0
					dbSelecTArea(aArqUpd[nx])
					dbCloseArea()
				EndIf
				X31UpdTable(aArqUpd[nx])
				If __GetX31Error()
					Alert(__GetX31Trace())
					Aviso("Atencao!","Ocorreu um erro desconhecido durante a atualizacao da tabela : "+ aArqUpd[nx] + ". Verifique a integridade do dicionario e da tabela.",{"Continuar"},2)
					cTexto += "Ocorreu um erro desconhecido durante a atualizacao da estrutura da tabela : "+aArqUpd[nx] +CHR(13)+CHR(10)
				EndIf
				dbSelectArea(aArqUpd[nx])
			Next nX		

			RpcClearEnv()
			If !( lOpen := MyOpenSm0Ex() )
				Exit
		 EndIf
		Next nI
		
		If lOpen
			
			cTexto 				:= "Log da atualizacao " + CHR(13) + CHR(10) + cTexto
			__cFileLog := MemoWrite(Criatrab(,.f.) + ".LOG", cTexto)
			
			DEFINE FONT oFont NAME "Mono AS" SIZE 5,12
			DEFINE MSDIALOG oDlg TITLE "Atualizador [GH999999] - Atualizacao concluida." From 3,0 to 340,417 PIXEL
				@ 5,5 GET oMemo  VAR cTexto MEMO SIZE 200,145 OF oDlg PIXEL
				oMemo:bRClicked := {||AllwaysTrue()}
				oMemo:oFont:=oFont
				DEFINE SBUTTON  FROM 153,175 TYPE 1 ACTION oDlg:End() ENABLE OF oDlg PIXEL //Apaga
				DEFINE SBUTTON  FROM 153,145 TYPE 13 ACTION (cFile:=cGetFile(cMask,""),If(cFile="",.t.,MemoWrite(cFile,cTexto))) ENABLE OF oDlg PIXEL //Salva e Apaga //"Salvar Como..."
			ACTIVATE MSDIALOG oDlg CENTER
	
		EndIf
		
	EndIf
		
EndIf 	

Return(Nil)


/*ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡…o    ³MyOpenSM0Ex³ Autor ³Sergio Silveira       ³ Data ³07/01/2003³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡…o ³ Efetua a abertura do SM0 exclusivo                         ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Atualizacao FIS                                            ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß*/
Static Function MyOpenSM0Ex()

Local lOpen := .F.
Local nLoop := 0

For nLoop := 1 To 20
	dbUseArea( .T.,, "SIGAMAT.EMP", "SM0", .F., .F. )
	If !Empty( Select( "SM0" ) )
		lOpen := .T.
		dbSetIndex("SIGAMAT.IND")
		Exit	
	EndIf
	Sleep( 500 )
Next nLoop

If !lOpen
	Aviso( "Atencao !", "Nao foi possivel a abertura da tabela de empresas de forma exclusiva !", { "Ok" }, 2 )
EndIf

Return( lOpen )




/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡ao    ³ GeraSX3  ³ Autor ³ MICROSIGA             ³ Data ³   /  /   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡ao ³ Funcao generica para copia de dicionarios                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Uso       ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function GeraSX3()
Local aArea 			:= GetArea()
Local i      		:= 0
Local j      		:= 0
Local aRegs  		:= {}
Local cTexto 		:= ''
Local lInclui		:= .F.

aRegs  := {}
AADD(aRegs,{"SZI","01","ZI_FILIAL ","C",02,00,"Filial      ","Sucursal    ","Branch      ","Filial do Sistema        ","Sucursal                 ","Branch of the System     ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",01,"þÀ"," "," ","U","N"," "," "," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","033"," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," "," "," ","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","02","ZI_COMBO  ","C",15,00,"Combo       ","Combo       ","Combo       ","Combo                    ","Combo                    ","Combo                    ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","GetSxENum('SZI','ZI_COMBO')                                                                                                     ","      ",00,"þÀ"," "," ","U","S","V","R","€","ExistChav('SZI',M->ZI_COMBO)                                                                                                    ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","03","ZI_TABPRE ","C",03,00,"Tab de Preco","Tab de Preco","Tab de Preco","Tabela de Preco          ","Tabela de Preco          ","Tabela de Preco          ","999999                                       ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","DA0   ",00,"þÀ"," ","S","U","S","A","R","€","ExistCpo('DA0',M->ZI_TABPRE)                                                                                                    ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","nOpc == 3                                                   ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","04","ZI_DESCPRE","C",30,00,"Desc Tab Pre","Desc Tab Pre","Desc Tab Pre","Descricao tabela de Preco","Descricao tabela de Preco","Descricao tabela de Preco","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","05","ZI_OBSERV ","C",30,00,"Observacao  ","Observacao  ","Observacao  ","Observacao               ","Observacao               ","Observacao               ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R","€","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","nOpc == 3                                                   ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","06","ZI_PROKIT ","C",15,00,"Produto KIT ","Produto KIT ","Produto KIT ","Produto KIT              ","Produto KIT              ","Produto KIT              ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","SB1   ",00,"þÀ"," ","S","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","nOpc == 3 .AND. Empty(M->ZI_PROGAR)                         ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","07","ZI_DESCKIT","C",30,00,"Desc Pro Kit","Desc Pro Kit","Desc Pro Kit","Descricao Produto Kit    ","Descricao Produto Kit    ","Descricao Produto Kit    ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","08","ZI_PROGAR ","C",32,00,"Produto GAR ","Produto GAR ","Produto GAR ","Produto GAR              ","Produto GAR              ","Produto GAR              ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","PA8   ",00,"þÀ"," ","S","U","S","A","R","€","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","nOpc == 3                                                   ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","09","ZI_DESCGAR","C",92,00,"Desc Pro GAR","Desc Pro GAR","Desc Pro GAR","Descricao Produto GAR    ","Descricao Produto GAR    ","Descricao Produto GAR    ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","10","ZI_BLOQUE ","C",01,00,"Bloqueado   ","Bloqueado   ","Bloqueado   ","Bloqueado                ","Bloqueado                ","Bloqueado                ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€€","'S'                                                                                                                             ","      ",00,"þÀ"," "," ","U","S","A","R","€","                                                                                                                                ","S=SIM;N=NAO                                                                                                                     ","S=SIM;N=NAO                                                                                                                     ","S=SIM;N=NAO                                                                                                                     ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","11","ZI_ATIVO  ","C",01,00,"Ativo       ","Ativo       ","Ativo       ","Ativo                    ","Ativo                    ","Ativo                    ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","'2'                                                                                                                             ","      ",00,"þÀ"," "," ","U","S","V","R"," ","Pertence('12')                                                                                                                  ","1=Sim;2=Nao                                                                                                                     ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","12","ZI_PREVEN ","N",09,02,"Preco Venda ","Preco Venda ","Preco Venda ","Preco de Venda           ","Preco de Venda           ","Preco de Venda           ","@E 999,999.99                                ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","13","ZI_USERLGI","C",17,00,"Log de Inclu","Log de Inclu","Log de Inclu","Log de Inclusao          ","Log de Inclusao          ","Log de Inclusao          ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",09,"þÀ"," "," ","L","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","14","ZI_USERLGA","C",17,00,"Log de Alter","Log de Alter","Log de Alter","Log de Alteracao         ","Log de Alteracao         ","Log de Alteracao         ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",09,"þÀ"," "," ","L","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","15","ZI_NUMPAR ","N",02,00,"Num.Parcelas","Num.Parcelas","Num.Parcelas","Numero de Parcelas       ","Numero de Parcelas       ","Numero de Parcelas       ","@E 99                                        ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","nOpc == 3                                                   ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","16","ZI_XTIPINT","C",01,00,"Tp Integ. ? ","Tp Integ. ? ","Tp Integ. ? ","Tp Integ. ?              ","Tp Integ. ?              ","Tp Integ. ?              ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","I=Inclusao;A=Alteração;E=Exclusão                                                                                               ","I=Inclusao;A=Alteração;E=Exclusão                                                                                               ","I=Inclusao;A=Alteração;E=Exclusão                                                                                               ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","17","ZI_XDTINT ","C",24,00,"TS Integ.   ","TS Integ.   ","TS Integ.   ","TS Integ.                ","TS Integ.                ","TS Integ.                ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZI","18","ZI_KITCOMB","C",01,00,"Kit Combo?  ","Kit Combo?  ","Kit Combo?  ","Kit Combo?               ","Kit Combo?               ","Kit Combo?               ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","'N'                                                                                                                             ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","S=SIM;N=NAO                                                                                                                     ","S=SIM;N=NAO                                                                                                                     ","S=SIM;N=NAO                                                                                                                     ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})


dbSelectArea("SX3")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(2)
 lInclui := !DbSeek(aRegs[i, 3])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i

aRegs  := {}
AADD(aRegs,{"SZJ","01","ZJ_FILIAL ","C",02,00,"Filial      ","Sucursal    ","Branch      ","Filial do Sistema        ","Sucursal                 ","Branch of the System     ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",01,"þÀ"," "," ","U","N"," "," "," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","033"," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," "," "," ","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","02","ZJ_COMBO  ","C",15,00,"Combo       ","Combo       ","Combo       ","Combo                    ","Combo                    ","Combo                    ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","03","ZJ_ITEM   ","C",03,00,"Item        ","Item        ","Item        ","Item                     ","Item                     ","Item                     ","999                                          ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","04","ZJ_CODPROD","C",15,00,"Cod Produto ","Cod Produto ","Cod Produto ","Cod Produto              ","Cod Produto              ","Cod Produto              ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","05","ZJ_PRODUTO","C",30,00,"Produto     ","Produto     ","Produto     ","Produto                  ","Produto                  ","Produto                  ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","06","ZJ_ITEMORI","C",03,00,"Item Origem ","Item Origem ","Item Origem ","Item Origem              ","Item Origem              ","Item Origem              ","999                                          ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","07","ZJ_QTDBAS ","N",12,02,"Qtd Base    ","Qtd Base    ","Qtd Base    ","Quantidade Base          ","Quantidade Base          ","Quantidade Base          ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","08","ZJ_PREBASE","N",09,02,"Preco Base  ","Preco Base  ","Preco Base  ","Preco Base               ","Preco Base               ","Preco Base               ","@E 999,999,999.99                            ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R","€","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","09","ZJ_FATOR  ","N",09,02,"Fator       ","Fator       ","Fator       ","Fator                    ","Fator                    ","Fator                    ","@E 999,999,999.99                            ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R","€","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","10","ZJ_PRETAB ","N",09,02,"Preco Tabela","Preco Tabela","Preco Tabela","Preco Tabela             ","Preco Tabela             ","Preco Tabela             ","@E 999,999,999.99                            ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R","€","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","11","ZJ_USERLGI","C",17,00,"Log de Inclu","Log de Inclu","Log de Inclu","Log de Inclusao          ","Log de Inclusao          ","Log de Inclusao          ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",09,"þÀ"," "," ","L","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","12","ZJ_USERLGA","C",17,00,"Log de Alter","Log de Alter","Log de Alter","Log de Alteracao         ","Log de Alteracao         ","Log de Alteracao         ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",09,"þÀ"," "," ","L","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","13","ZJ_PRERENO","N",09,02,"Preco Renov.","Preco Renov.","Preco Renov.","Preco Renovacao          ","Preco Renovacao          ","Preco Renovacao          ","@E 999,999.99                                ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," "," "," ","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","14","ZJ_TXMANU ","N",07,02,"Taxa Manut. ","Taxa Manut. ","Taxa Manut. ","Taxa Manutencao          ","Taxa Manutencao          ","Taxa Manutencao          ","@E 9,999.99                                  ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","15","ZJ_TXPARC ","N",02,00,"Parcela Taxa","Parcela Taxa","Parcela Taxa","Parcela Taxa Manutencao  ","Parcela Taxa Manutencao  ","Parcela Taxa Manutencao  ","@E 99                                        ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SZJ","16","ZJ_PROGAR ","C",32,00,"Produto GAR ","Produto GAR ","Produto GAR ","Produto GAR              ","Produto GAR              ","Produto GAR              ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","PA8   ",00,"þÀ"," ","S","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})

dbSelectArea("SX3")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(1)
 lInclui := !DbSeek(aRegs[i, 1]+aRegs[i, 2])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i

aRegs  := {}
AADD(aRegs,{"SG1","28","G1_PROGAR ","C",32,00,"Produto GAR ","Produto GAR ","Produto GAR ","Produto GAR              ","Produto GAR              ","Produto GAR              ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","PA8   ",00,"þÀ"," ","S","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})

dbSelectArea("SX3")
dbSetOrder(1)


For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(2)
 lInclui := !DbSeek(aRegs[i, 3])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i

aRegs  := {}
AADD(aRegs,{"PA8","17","PA8_PLATAF","C",01,00,"Plataforma  ","Plataforma  ","Plataforma  ","Plataforma               ","Plataforma               ","Plataforma               ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R"," ","                                                                                                                                ","1=GAR;2=Hard.Avulso;3=PortalAssinaturas;4=Cursos;5=PortalSSL                                                                    ","1=GAR;2=Hard.Avulso;3=PortalAssinaturas;4=Cursos;5=PortalSSL                                                                    ","1=GAR;2=Hard.Avulso;3=PortalAssinaturas;4=Cursos;5=PortalSSL                                                                    ","                    ","                                                            ","                                                                                ","   "," ","S","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})

dbSelectArea("SX3")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(2)
 lInclui := !DbSeek(aRegs[i, 3])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i

aRegs  := {}
AADD(aRegs,{"SC6","I5","C6_XPEDORI","C",09,00,"Pedido Orige","Pedido Orige","Pedido Orige","Pedido Origem            ","Pedido Origem            ","Pedido Origem            ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SC6","I6","C6_XORIGPV","C",01,00,"Origem P.V. ","Origem P.V. ","Origem P.V. ","Origem Pedido de Venda   ","Origem Pedido de Venda   ","Origem Pedido de Venda   ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","'1'                                                                                                                             ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","#U_CSC5XBOX('Z4')                                                                                                               ","1=Manual;2=Varejo;3=Hard.Avulso;4=TLV;5=Atend.Ext.;6=Contratos;7=Port.Ass.;8=Cursos;9=Port.SSL;0=Pto.Movel;A=Varejo;B=SAC;C=PDA ","1=Manual;2=Varejo;3=Hard.Avulso;4=TLV;5=Atend.Ext.;6=Contratos;7=Port.Ass.;8=Cursos;9=Port.SSL;0=Pto.Movel;A=Varejo;B=SAC;C=PDA ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","N  "," "," ","N","N","N"})
AADD(aRegs,{"SC6","I7","C6_XNFHRD ","C",150,00,"Link NF HRD ","Link NF HRD ","Link NF HRD ","Link Nota Fiscal Hardware","Link Nota Fiscal Hardware","Link Nota Fiscal Hardware","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","N  "," "," ","N","N","N"})
AADD(aRegs,{"SC6","I8","C6_XNFSFW ","C",150,00,"Link NF SFW ","Link NF SFW ","Link NF SFW ","Link Nota Fiscal Software","Link Nota Fiscal Software","Link Nota Fiscal Software","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","N  "," "," ","N","N","N"})
AADD(aRegs,{"SC6","I9","C6_XNFHRE ","C",150,00,"Link NF HRE ","Link NF HRE ","Link NF HRE ","Link NF HRD Entrega      ","Link NF HRD Entrega      ","Link NF HRD Entrega      ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","N  "," "," ","N","N","N"})
AADD(aRegs,{"SC6","J0","C6_XFLAGEN","C",01,00,"Flag Env Sit","Flag Env Sit","Flag Env Sit","Flag Envio Site          ","Flag Envio Site          ","Flag Envio Site          ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","N  "," "," ","N","N","N"})
AADD(aRegs,{"SC6","J1","C6_LINKNFS","C",200,00,"Link NFSe  ","Link NFSe   ","Link NFSe   ","Link de Consulta da NFSe ","Link de Consulta da NFSe ","Link de Consulta da NFSe ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SC6","J2","C6_XRECPG ","C",150,00,"Recibo Pagto","Recibo Pagto","Recibo Pagto","Recibo Pagto             ","Recibo Pagto             ","Recibo Pagto             ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SC6","J3","C6_XLIBFAT","C",01,00,"Lib p Pag   ","Lib p Pag   ","Lib p Pag   ","Liberado Para Pagamento  ","Liberado Para Pagamento  ","Liberado Para Pagamento  ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","'N'                                                                                                                             ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","S=SIM;N=NAO;P=PENDENTE                                                                                                          ","S=SIM;N=NAO;P=PENDENTE                                                                                                          ","S=SIM;N=NAO;P=PENDENTE                                                                                                          ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SC6","J4","C6_XIDPED ","C",10,00,"Id Prod Ped ","Id Prod Ped ","Id Prod Ped ","Id Produto Pedido        ","Id Produto Pedido        ","Id Produto Pedido        ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"SC6","J5","C6_XIDPEDO","C",10,00,"Id Prod Ori ","Id Prod Ori ","Id Prod Ori ","Id Produto Pedido Origem ","Id Produto Pedido Origem ","Id Produto Pedido Origem ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   ","1"," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   "," "," ","N","N","N"})

dbSelectArea("SX3")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(2)
 lInclui := !DbSeek(aRegs[i, 3])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i

aRegs  := {}
AADD(aRegs,{"Z11","01","Z11_FILIAL","C",02,00,"Filial      ","Sucursal    ","Branch      ","Filial do Sistema        ","Sucursal                 ","Branch of the System     ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",01,"þA"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","033"," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","02","Z11_CODDUA","C",10,00,"Cod DUA     ","Cod DUA     ","Cod DUA     ","Cod DUA                  ","Cod DUA                  ","Cod DUA                  ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","1","N","N","N","N"})
AADD(aRegs,{"Z11","03","Z11_TPPES ","C",01,00,"Fisica/Jurid","Fisica/Jurid","Fisica/Jurid","Pessoa Fisica/Juridica   ","Pessoa Fisica/Juridica   ","Pessoa Fisica/Juridica   ","@!                                           ","Pertence(' FJ')                                                                                                                 ","€€€€€€€€€€€€€€ ","IF(Left(Z11->Z11_CGC,2) == '  ',' ',If(Len(Trim(Z11->Z11_CGC))<14,'F','J'))                                                     ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","F=Fisica;J=Juridica                                                                                                             ","F=Fisica;J=Juridica                                                                                                             ","F=Fisica;J=Juridica                                                                                                             ","                    ","                                                            ","X3COMBO('Z11_PESSOA',RETPESSOA(Z11->Z11_CGC))                                   ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","04","Z11_CGC   ","C",14,00,"CNPJ/CPF    ","CNPJ/CPF    ","CNPJ/CPF    ","CNPJ/CPF do cliente      ","CNPJ/CPF do cliente      ","CNPJ/CPF do cliente      ","@R 99.999.999/9999-99                        ","Vazio() .Or. CGC(M->Z11_CGC)                                                                                                    ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","PicPes(M->Z11_TPPES)","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","05","Z11_MUN   ","C",06,00,"Municipio   ","Municipio   ","Municipio   ","Municipio                ","Municipio                ","Municipio                ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","06","Z11_INFCOM","M",10,00,"Inf. Complem","Inf. Complem","Inf. Complem","Inf. Complem             ","Inf. Complem             ","Inf. Complem             ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","07","Z11_EST   ","C",02,00,"Estado      ","Estado      ","Estado      ","Estado                   ","Estado                   ","Estado                   ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","08","Z11_TOTAL ","N",14,04,"Total Venda ","Total Venda ","Total Venda ","Total Venda              ","Total Venda              ","Total Venda              ","@E 99,999,999.9999                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","09","Z11_PEDGAR","C",10,00,"Pedido GAR  ","Pedido GAR  ","Pedido GAR  ","Pedido GAR               ","Pedido GAR               ","Pedido GAR               ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","10","Z11_PEDSIT","C",10,00,"Pedido Site ","Pedido Site ","Pedido Site ","Pedido Site              ","Pedido Site              ","Pedido Site              ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","11","Z11_DATA  ","D",08,00,"Emissao     ","Emissao     ","Emissao     ","Emissao                  ","Emissao                  ","Emissao                  ","@D                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z11","12","Z11_ORIGEM","C",02,00,"OrigCheckout","OrigCheckout","OrigCheckout","Origem CheckOut          ","Origem CheckOut          ","Origem CheckOut          ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","8=Prodest;11=Sage;                                                                                                              ","8=Prodest;11=Sage;                                                                                                              ","8=Prodest;11=Sage;                                                                                                              ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," "," "," ","               ","                                                  ","   "," "," ","N","N","N"})
AADD(aRegs,{"Z11","13","Z11_SAGE  ","C",20,00,"Voucher Sage","Voucher Sage","Voucher Sage","Voucher Sage             ","Voucher Sage             ","Voucher Sage             ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," "," "," ","               ","                                                  ","   "," "," ","N","N","N"})

dbSelectArea("SX3")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(2)
 lInclui := !DbSeek(aRegs[i, 3])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i

aRegs  := {}
AADD(aRegs,{"Z12","01","Z12_FILIAL","C",02,00,"Filial      ","Sucursal    ","Branch      ","Filial do Sistema        ","Sucursal                 ","Branch of the System     ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",01,"þA"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","033"," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","02","Z12_CODDUA","C",10,00,"Cod DUA     ","Cod DUA     ","Cod DUA     ","Cod DUA                  ","Cod DUA                  ","Cod DUA                  ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€€","                                                                                                                                ","      ",00,"þA"," "," ","U","N","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","1","N","N","N","N"})
AADD(aRegs,{"Z12","03","Z12_ITEM  ","C",02,00,"Item        ","Item        ","Item        ","Numero do Item no Pedido ","Numero del Item del Pedid","Item Number in Order     ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",01,"þA"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","04","Z12_PRODUT","C",15,00,"Produto     ","Producto    ","Product     ","Codigo do Produto        ","Codigo del Producto      ","Code of Product          ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","SB1   ",01,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","030"," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","05","Z12_QTDVEN","N",09,02,"Quantidade  ","Cantidad    ","Quantity    ","Quantidade Vendida       ","Cantidad Vendida         ","Quantity Sold            ","@E 999999.99                                 ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",01,"þA"," "," ","U","S","A","R"," ","positivo()                                                                                                                      ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","06","Z12_PRCVEN","N",14,04,"Prc Unitario","Prc Unitario","Unit Price  ","Preco Unitario Liquido   ","Precio Unitario Neto     ","Net Unit Price           ","@E 99,999,999.9999                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",01,"þA"," "," ","U","S","A","R"," ","positivo()                                                                                                                      ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","07","Z12_OPER  ","C",02,00,"Tp. Operacao","Tp.Operacion","Oper. Type  ","Tipo de Operacao         ","Tipo de Operacion        ","Operation type           ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","DJ    ",01,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","08","Z12_PRUNIT","N",11,04,"Prc Lista   ","Precio Lista","Price List  ","Preco Unitario de Tabela ","Precio Unitario de Tabla ","Unit List Price          ","@E 99,999,999.9999                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",01,"þA"," "," ","U","S","A","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","09","Z12_PEDGAR","C",10,00,"Pedido GAR  ","Pedido GAR  ","Pedido GAR  ","Numero Pedido GAR        ","Numero Pedido GAR        ","Numero Pedido GAR        ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","10","Z12_PROGAR","C",32,00,"Produto GAR ","Produto GAR ","Produto GAR ","Codigo do Produto GAR    ","Codigo do Produto GAR    ","Codigo do Produto GAR    ","@!                                           ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","11","Z12_XCDPRC","C",15,00,"Cod Combo   ","Cod Combo   ","Cod Combo   ","Codigo do Combo          ","Codigo do Combo          ","Codigo do Combo          ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þÀ"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})
AADD(aRegs,{"Z12","12","Z12_PEDSIT","C",10,00,"Pedido Site ","Pedido Site ","Pedido Site ","Pedido Site              ","Pedido Site              ","Pedido Site              ","                                             ","                                                                                                                                ","€€€€€€€€€€€€€€ ","                                                                                                                                ","      ",00,"þA"," "," ","U","S","V","R"," ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                                                                                                                                ","                    ","                                                            ","                                                                                ","   "," "," ","                                                                                                                                                                                                                                                          ","                                                                                                                                                                                                                                                          "," ","N","N","               ","                                                  ","   ","N","N","N","N","N"})

dbSelectArea("SX3")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(2)
 lInclui := !DbSeek(aRegs[i, 3])

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SX3", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i


RestArea(aArea)
Return('SX3 : ' + cTexto  + CHR(13) + CHR(10))
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Fun‡ao    ³ GeraSIX  ³ Autor ³ MICROSIGA             ³ Data ³   /  /   ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descri‡ao ³ Funcao generica para copia de dicionarios                  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Uso       ³ Generico                                                   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function GeraSIX()
Local aArea 			:= GetArea()
Local i      		:= 0
Local j      		:= 0
Local aRegs  		:= {}
Local cTexto 		:= ''
Local lInclui		:= .F.

aRegs  := {}
AADD(aRegs,{"SC6","G","C6_FILIAL+C6_PEDGAR                                                                                                                                             ","Pedido GAR                                                            ","Pedido GAR                                                            ","Pedido GAR                                                            ","U","                                                                                                                                                                ","NUMPEDGAR ","S"," "," "})

dbSelectArea("SIX")
dbSetOrder(1)

For i := 1 To Len(aRegs)

 If(Ascan(aArqUpd, aRegs[i,1]) == 0)
 	aAdd(aArqUpd, aRegs[i,1])
 EndIf

 dbSetOrder(1)
 lInclui := !DbSeek(aRegs[i, 1] + aRegs[i, 2])
 If !lInclui
  TcInternal(60,RetSqlName(aRegs[i, 1]) + "|" + RetSqlName(aRegs[i, 1]) + aRegs[i, 2])
 Endif

 cTexto += IIf( aRegs[i,1] $ cTexto, "", aRegs[i,1] + "\")

 RecLock("SIX", lInclui)
  For j := 1 to FCount()
   If j <= Len(aRegs[i])
   	If allTrim(Field(j)) == "X2_ARQUIVO"
   		aRegs[i,j] := SubStr(aRegs[i,j], 1, 3) + SM0->M0_CODIGO + "0"
   	EndIf
    If !lInclui .AND. AllTrim(Field(j)) == "X3_ORDEM"
     Loop
    Else
     FieldPut(j,aRegs[i,j])
    EndIf
   Endif
  Next
 MsUnlock()
Next i


RestArea(aArea)
Return('SIX : ' + cTexto  + CHR(13) + CHR(10))
