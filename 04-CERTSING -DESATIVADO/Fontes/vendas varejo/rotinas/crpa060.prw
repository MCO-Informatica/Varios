#include 'protheus.ch'
#include 'parmtype.ch'

user function CRPA060()

	Local aAreaSC5	:= SC5->(GetArea())
	Local aAreaSC6	:= SC6->(GetArea())
	Local aAreaSZ5	:= SZ5->(GetArea())
	Local aAreaSZ3	:= SZ3->(GetArea())
	Local aParam	:= {}
	Local aRet		:= {}
	Local cPedido	:= ""
	Local nCounter	:= 0
	Local Ni
	
	aAdd(aParam, {1,"Pedido de Venda", Space(6), "@!", "", "", "", 50, .F.})
	aAdd(aParam, {1,"Pedido Site", Space(TamSX3("C5_XNPSITE")[1]), "@!", "", "", "", 50, .F.})
	aAdd(aParam, {11, "Pedidos Site", "", '.T.', '.T.', .T.})
	
	dbSelectArea("SC5")
	SC5->(dbSetOrder(1))
	
	dbSelectArea("SC6")
	SC6->(dbSetOrder(1))
		
	If Parambox(aParam, "", @aRet,,,,,,,,.F.,.F.)

		If !Empty(aRet[3])
			aPedidos := StrToArray(aRet[3], CHR(13) + CHR(10))
			SC5->(dbOrderNickname("PEDSITE"))
		Else
			aPedidos := {aRet[1]}
			If !Empty(aRet[2]) .Or. Empty(aRet[1])
				aPedidos := {aRet[2]}
				SC5->(dbOrderNickname("PEDSITE"))
			EndIf
		EndIf

		For Ni := 1 To Len(aPedidos)

			cPedido := aPedidos[Ni]
			
			If Empty(cPedido)
				MsgStop("Não foi informado o pedido de venda/site")
				Return
			EndIf
		
			If SC5->(dbSeek(xFilial("SC5") + cPedido))
				If SC6->(dbSeek(xFilial("SC6") + SC5->C5_NUM))
		
					While SC6->(!EoF()) .And. SC6->C6_NUM == SC5->C5_NUM
		
						If (SC6->C6_XOPER == "53" .OR. SC6->C6_XOPER == "62" .Or. SC6->C6_XOPER == "01") .AND. !Empty(SC5->C5_XPOSTO) .AND. !Empty(SC5->C5_XNPSITE)//Venda Avulsa
							
							nCounter++
							
							Alert(SC6->C6_NUM + "/" + SC6->C6_ITEM)
							
							//Campos adicionados para a gravação de informações perinentes a midia avulsa
							SZ5->(DbselectArea("SZ5"))
							
							Reclock('SZ5',.T.)
							SZ5->Z5_EMISSAO := GetAdvFVal("SF2", "F2_EMISSAO", xFilial("SF2") + SC6->C6_NOTA + SC6->C6_SERIE, 1)
							SZ5->Z5_VALOR   := SC6->C6_VALOR
							SZ5->Z5_PRODUTO := SC6->C6_PRODUTO
							SZ5->Z5_DESPRO  := SC6->C6_DESCRI
							SZ5->Z5_CODVOU  := SC6->C6_XNUMVOU
							SZ5->Z5_PRODGAR := SC6->C6_PROGAR
							SZ5->Z5_TIPO    := "ENTHAR"                           //REMUNERA O POSTO/AR PELA ENTREGA DA MÍDIA
							SZ5->Z5_TIPODES := "ENTREGA HARDWARE AVULSO"
							SZ5->Z5_VALORHW := SC6->C6_VALOR
							SZ5->Z5_PEDIDO  := SC6->C6_NUM
							SZ5->Z5_ITEMPV  := SC6->C6_ITEM
							SZ5->Z5_ROTINA  := "M460FIM"
							SZ5->Z5_CODPOS  := SC5->C5_XPOSTO
							SZ5->Z5_TIPMOV  := SC5->C5_TIPMOV
							SZ5->Z5_TABELA  := SC5->C5_TABELA
							SZ5->Z5_PEDSITE := SC5->C5_XNPSITE
							
							SZ3->(DbSetOrder(6))
							If SZ3->(DbSeek(xFilial("SZ3") + "4" + SZ5->Z5_CODPOS))
								SZ5->Z5_DESPOS	:= SZ3->Z3_DESENT
								SZ5->Z5_REDE    := SZ3->Z3_REDE
								SZ5->Z5_DESCAR	:= SZ3->Z3_DESAR
							EndIf
							
							SZ5->(MsUnlock())
						EndIf
					
						SC6->(dbSkip())
					EndDo
				EndIf
			EndIf
		Next
	
		Alert("Foram incluídas " + cValToChar(nCounter) + " na tabela SZ5.")
	
	EndIf
	RestArea(aAreaSZ3)
	RestArea(aAreaSZ5)
	RestArea(aAreaSC6)
	RestArea(aAreaSC5)
	
return


User Function CRPA060B()

	Local aPostos := {}
	Local Ni := 0
	Local aLog := {}
	
aAdd(aPostos,{"152","9GXWFH"})
aAdd(aPostos,{"772","9HAQLT"})
aAdd(aPostos,{"772","9HAQQX"})
aAdd(aPostos,{"772","9HAQQX"})
aAdd(aPostos,{"4743","9GXUUE"})
aAdd(aPostos,{"4743","9HADGU"})
aAdd(aPostos,{"4743","9HACU0"})
aAdd(aPostos,{"4743","9GYKAL"})
aAdd(aPostos,{"1814","9GYIF2"})
aAdd(aPostos,{"1814","9GYIMY"})
aAdd(aPostos,{"1814","9GYIQG"})
aAdd(aPostos,{"1814","9GYITP"})
aAdd(aPostos,{"1814","9GYIW1"})
aAdd(aPostos,{"1814","9GYIYR"})
aAdd(aPostos,{"1814","9GYJHD"})
aAdd(aPostos,{"1814","9GYJFF"})
aAdd(aPostos,{"1814","9GYUSD"})
aAdd(aPostos,{"1814","9HAJ47"})
aAdd(aPostos,{"1814","9H7875"})
aAdd(aPostos,{"10981","9GXB43"})
aAdd(aPostos,{"10981","9GYIJ3"})
aAdd(aPostos,{"10981","9GYJDN"})
aAdd(aPostos,{"5533","9GYQS3"})
aAdd(aPostos,{"5533","9HBL63"})
aAdd(aPostos,{"5389","9HBOXS"})
aAdd(aPostos,{"5389","9HBOXS"})
aAdd(aPostos,{"8041","9GYLWX"})
aAdd(aPostos,{"8041","9GYLWX"})
aAdd(aPostos,{"8041","9H0268"})
aAdd(aPostos,{"8041","9HCWHQ"})
aAdd(aPostos,{"8041","9GXGOZ"})
aAdd(aPostos,{"8041","9GZLI5"})
aAdd(aPostos,{"8041","9H0148"})
aAdd(aPostos,{"8041","9HCWHQ"})
aAdd(aPostos,{"5297","9GYICN"})
aAdd(aPostos,{"5297","9HAUAW"})
aAdd(aPostos,{"5297","9GXSBZ"})
aAdd(aPostos,{"20314","9GZEMC"})
aAdd(aPostos,{"20314","9HAPMF"})
aAdd(aPostos,{"20314","9HBGAT"})
aAdd(aPostos,{"20314","9GYWXA"})
aAdd(aPostos,{"20314","9HB570"})
aAdd(aPostos,{"19679","9GXYST"})
aAdd(aPostos,{"19679","9GYTSC"})
aAdd(aPostos,{"19679","9GZIZC"})
aAdd(aPostos,{"19679","9HAEHL"})
aAdd(aPostos,{"19679","9HAHYP"})
aAdd(aPostos,{"64","9GXMZC"})
aAdd(aPostos,{"64","9HD670"})
aAdd(aPostos,{"64","9GYZY2"})
aAdd(aPostos,{"64","9GZYIW"})
aAdd(aPostos,{"43094","9HCFJW"})
aAdd(aPostos,{"7874","9GXJXN"})
aAdd(aPostos,{"7874","9GYNOO"})
aAdd(aPostos,{"17759","9GZXO8"})
aAdd(aPostos,{"17759","9HBIX6"})
aAdd(aPostos,{"17759","9HBIX6"})
aAdd(aPostos,{"17759","9HBYEZ"})
aAdd(aPostos,{"20040","9HBA21"})
aAdd(aPostos,{"20040","9GZZWJ"})
aAdd(aPostos,{"48835","9GZDYC"})
aAdd(aPostos,{"48835","9HAFSX"})
aAdd(aPostos,{"1536","9GXXSN"})
aAdd(aPostos,{"1536","9HAQBJ"})
aAdd(aPostos,{"697","9HCMEI"})
aAdd(aPostos,{"697","9GZ609"})
aAdd(aPostos,{"697","9GZLNL"})
aAdd(aPostos,{"697","9GZRVG"})
aAdd(aPostos,{"697","9HBSHM"})
aAdd(aPostos,{"2058","9GYHR1"})
aAdd(aPostos,{"2058","9HBYQZ"})
aAdd(aPostos,{"7462","9GZIF4"})
aAdd(aPostos,{"7462","9HAAG6"})
aAdd(aPostos,{"7462","9GX930"})
aAdd(aPostos,{"7462","9H6657"})
aAdd(aPostos,{"5545","9HCOC8"})
aAdd(aPostos,{"5545","9HCL31"})
aAdd(aPostos,{"2059","9GYFTO"})
aAdd(aPostos,{"2059","9H2320"})
aAdd(aPostos,{"5295","9HBGL8"})
aAdd(aPostos,{"5295","9GXMUP"})
aAdd(aPostos,{"4823","9GZXAO"})
aAdd(aPostos,{"4823","9GZXAO"})
aAdd(aPostos,{"4873","9HC685"})
aAdd(aPostos,{"12859","9GYLLK"})
aAdd(aPostos,{"12859","9H2450"})
aAdd(aPostos,{"22213","9GXTZP"})
aAdd(aPostos,{"43001","9HCQXZ"})
aAdd(aPostos,{"47090","9HBZXX"})
aAdd(aPostos,{"55194","9GZTO8"})
aAdd(aPostos,{"55192","9HCBVX"})
aAdd(aPostos,{"553","9H2957"})
aAdd(aPostos,{"538","9GZLKZ"})
aAdd(aPostos,{"5036","9HAHH5"})
aAdd(aPostos,{"5036","9HB226"})
aAdd(aPostos,{"16086","9GYPRR"})
aAdd(aPostos,{"1535","9HASJQ"})
aAdd(aPostos,{"2414","9HBYDM"})
aAdd(aPostos,{"1954","9GYVV5"})
aAdd(aPostos,{"7297","9GYHBG"})
aAdd(aPostos,{"7297","9HBQLU"})
aAdd(aPostos,{"7297","9HAO75"})
aAdd(aPostos,{"4061","9GYUVZ"})
aAdd(aPostos,{"4061","9GYUVZ"})
aAdd(aPostos,{"19621","9HAMMC"})
aAdd(aPostos,{"52884","9HBJLX"})
aAdd(aPostos,{"22265","9HADFF"})
aAdd(aPostos,{"22265","9HCLAS"})
aAdd(aPostos,{"22265","9GZEIB"})
aAdd(aPostos,{"22265","9GZYDA"})
aAdd(aPostos,{"7650","9GZDYC"})
aAdd(aPostos,{"5551","9GXZL2"})
aAdd(aPostos,{"5551","9GXZL2"})
aAdd(aPostos,{"5551","9GYOUJ"})
aAdd(aPostos,{"6861","9GZDYC"})
aAdd(aPostos,{"6861","9GZDYC"})
aAdd(aPostos,{"6757","9HBAR3"})
aAdd(aPostos,{"6807","9HCGD4"})
aAdd(aPostos,{"7313","9GYOOC"})
aAdd(aPostos,{"7313","9HCB26"})
aAdd(aPostos,{"7794","9GXHXH"})
aAdd(aPostos,{"7794","9GYO41"})
aAdd(aPostos,{"7794","9GZID9"})
aAdd(aPostos,{"14103","9GYU34"})
aAdd(aPostos,{"14103","9GZIYX"})
aAdd(aPostos,{"14103","9H6263"})
aAdd(aPostos,{"14103","9HCFOR"})
aAdd(aPostos,{"21997","9GYRPW"})
aAdd(aPostos,{"21997","9HADJH"})
aAdd(aPostos,{"22435","9GZRFD"})
aAdd(aPostos,{"29570","9GYHBG"})
aAdd(aPostos,{"29570","9GYHS5"})
aAdd(aPostos,{"29570","9GYNEP"})
aAdd(aPostos,{"29570","9GZSUZ"})
aAdd(aPostos,{"29570","9HAHJL"})
aAdd(aPostos,{"29570","9H6440"})
aAdd(aPostos,{"30092","9GYHBG"})
aAdd(aPostos,{"32695","9H4743"})
aAdd(aPostos,{"32695","9GZP36"})
aAdd(aPostos,{"32695","9HBNAC"})
aAdd(aPostos,{"33130","9GWZXM"})
aAdd(aPostos,{"33130","9HBZVE"})
aAdd(aPostos,{"33130","9GZDRP"})
aAdd(aPostos,{"33130","9H1406"})
aAdd(aPostos,{"36070","9GZDYC"})
aAdd(aPostos,{"37415","9GYHBG"})
aAdd(aPostos,{"37415","9HCAMB"})
aAdd(aPostos,{"38315","9HBFB6"})
aAdd(aPostos,{"38315","9HCLEA"})
aAdd(aPostos,{"43648","9GYTF8"})
aAdd(aPostos,{"44483","9HCOUF"})
aAdd(aPostos,{"44483","9HAECA"})
aAdd(aPostos,{"10817","9HAQZI"})
aAdd(aPostos,{"6515","9HCNVS"})
aAdd(aPostos,{"4649","9HAEPQ"})
aAdd(aPostos,{"4649","9GYE62"})
aAdd(aPostos,{"4649","9GYE83"})
aAdd(aPostos,{"4649","9GYEA3"})
aAdd(aPostos,{"4649","9GYEAO"})
aAdd(aPostos,{"4649","9HBNZ8"})
aAdd(aPostos,{"20909","9HBTV7"})
aAdd(aPostos,{"20909","9HAYPM"})
aAdd(aPostos,{"20909","9HAYQU"})
aAdd(aPostos,{"20909","9HAYR6"})
aAdd(aPostos,{"20909","9HAYRP"})
aAdd(aPostos,{"20909","9HAYOS"})
aAdd(aPostos,{"20909","9HAYQE"})
aAdd(aPostos,{"7317","9GZYC0"})
aAdd(aPostos,{"38253","9HCKQK"})
aAdd(aPostos,{"38253","9HCNII"})
aAdd(aPostos,{"54833","9HADI8"})
aAdd(aPostos,{"3808","9HCOHP"})
aAdd(aPostos,{"6058","9GYBQW"})
aAdd(aPostos,{"6058","9GYBQW"})
aAdd(aPostos,{"6058","9GYBQW"})
aAdd(aPostos,{"6058","9GYBQW"})
aAdd(aPostos,{"6058","9GYM14"})
aAdd(aPostos,{"8146","9GYMUD"})
aAdd(aPostos,{"8146","9GYR59"})
aAdd(aPostos,{"5829","9GYK47"})
aAdd(aPostos,{"46680","9GXVF1"})
aAdd(aPostos,{"46680","9GXVGV"})
aAdd(aPostos,{"46680","9HB127"})
aAdd(aPostos,{"37793","9HCTNC"})
aAdd(aPostos,{"8150","9HBFTS"})
aAdd(aPostos,{"8150","9HAVSU"})
aAdd(aPostos,{"8150","9HBFTS"})
aAdd(aPostos,{"8150","9HCKSW"})
aAdd(aPostos,{"19161","9H9797"})
aAdd(aPostos,{"19161","9HADSL"})
aAdd(aPostos,{"33435","9GZXBB"})
aAdd(aPostos,{"40711","9HAXPG"})
aAdd(aPostos,{"49490","9H3984"})
aAdd(aPostos,{"4907","9HBL83"})
aAdd(aPostos,{"7085","9GXWV4"})
aAdd(aPostos,{"7085","9GXWV4"})
aAdd(aPostos,{"8837","9H4362"})
aAdd(aPostos,{"14815","9HCGY3"})
aAdd(aPostos,{"14815","9GXJG2"})
aAdd(aPostos,{"14815","9GZHLM"})
aAdd(aPostos,{"14815","9GZHOG"})
aAdd(aPostos,{"14815","9HBNGN"})
aAdd(aPostos,{"14815","9HCGY3"})
aAdd(aPostos,{"14815","9GYSRU"})
aAdd(aPostos,{"14815","9HAOH2"})
aAdd(aPostos,{"19165","9HBXDD"})
aAdd(aPostos,{"19165","9GZWDJ"})
aAdd(aPostos,{"19165","9GZWEY"})
aAdd(aPostos,{"50360","9HBOG8"})
aAdd(aPostos,{"5317","9HBNUQ"})
aAdd(aPostos,{"5317","9HBON1"})
aAdd(aPostos,{"9939","9GXKA7"})
aAdd(aPostos,{"9939","9GXJKC"})
aAdd(aPostos,{"20987","9HCKYY"})
aAdd(aPostos,{"6185","9HAVGC"})
aAdd(aPostos,{"6185","9HAZMY"})
aAdd(aPostos,{"6185","9HAVGC"})
aAdd(aPostos,{"8001","9GVXKH"})
aAdd(aPostos,{"3813","9H3328"})
aAdd(aPostos,{"4741","9H9625"})
aAdd(aPostos,{"5463","9HBDAJ"})
aAdd(aPostos,{"8889","9GYFPS"})
aAdd(aPostos,{"8889","9GYIFI"})
aAdd(aPostos,{"8889","9GYOMD"})
aAdd(aPostos,{"5285","9HADWL"})
aAdd(aPostos,{"5285","9HAOFT"})
aAdd(aPostos,{"5285","9HAQ29"})
aAdd(aPostos,{"5285","9HCDCN"})
aAdd(aPostos,{"5285","9GZNOZ"})
aAdd(aPostos,{"5285","9H0807"})
aAdd(aPostos,{"5285","9H0902"})
aAdd(aPostos,{"5285","9H0940"})
aAdd(aPostos,{"17951","9GYW56"})
aAdd(aPostos,{"17951","9GZNQ3"})
aAdd(aPostos,{"17951","9HCDIA"})
aAdd(aPostos,{"42233","9GXA45"})
aAdd(aPostos,{"5323","9GZAH7"})
aAdd(aPostos,{"5323","9HBPBO"})
aAdd(aPostos,{"5323","9HBUB7"})
aAdd(aPostos,{"5323","9HCCD5"})
aAdd(aPostos,{"5323","9HCIGO"})
aAdd(aPostos,{"8371","9GZWJK"})
aAdd(aPostos,{"7774","9HAALG"})
aAdd(aPostos,{"7774","9HARUR"})
aAdd(aPostos,{"37910","9HAFDC"})
aAdd(aPostos,{"118","9HACUX"})
aAdd(aPostos,{"5012","9GYKL6"})
aAdd(aPostos,{"5012","9GZRGN"})
aAdd(aPostos,{"3781","9GZJNH"})
aAdd(aPostos,{"3781","9GXOBJ"})
aAdd(aPostos,{"6006","9HCQPB"})
aAdd(aPostos,{"6006","9HAYYZ"})
aAdd(aPostos,{"6006","9HCQPB"})
aAdd(aPostos,{"4535","9GZU59"})
aAdd(aPostos,{"30675","9HD079"})
aAdd(aPostos,{"26210","9GYXQ9"})
aAdd(aPostos,{"40751","9HBLZS"})
aAdd(aPostos,{"40751","9GZBZX"})
aAdd(aPostos,{"8393","9HBOVO"})
aAdd(aPostos,{"8393","9HC510"})
aAdd(aPostos,{"11928","9HCA84"})
aAdd(aPostos,{"8715","9HADE5"})
aAdd(aPostos,{"12965","9GYQUC"})
aAdd(aPostos,{"12965","9GYU01"})
aAdd(aPostos,{"12965","9GYWBB"})
aAdd(aPostos,{"37396","9GYWPB"})
aAdd(aPostos,{"41054","9HBYU7"})
aAdd(aPostos,{"44203","9GYJYR"})
aAdd(aPostos,{"44536","9HBQH2"})
aAdd(aPostos,{"14821","9GZF88"})
aAdd(aPostos,{"11503","9GYVQK"})
aAdd(aPostos,{"11503","9GYVQK"})
aAdd(aPostos,{"17245","9HCB92"})
aAdd(aPostos,{"24504","9HBH67"})
aAdd(aPostos,{"15687","9GZRRK"})
aAdd(aPostos,{"25996","9GYDYW"})
aAdd(aPostos,{"16471","9GZUWN"})
aAdd(aPostos,{"16471","9H2402"})
aAdd(aPostos,{"16471","9GZZEA"})
aAdd(aPostos,{"34749","9HAD05"})
aAdd(aPostos,{"34749","9HAD05"})
aAdd(aPostos,{"34749","9HBRCO"})
aAdd(aPostos,{"47283","9HAD05"})
aAdd(aPostos,{"18171","9HACUZ"})
aAdd(aPostos,{"18171","9HBW24"})
aAdd(aPostos,{"40369","9GYXWY"})
aAdd(aPostos,{"20857","9GYGKM"})
aAdd(aPostos,{"20857","9GYBP8"})
aAdd(aPostos,{"24478","9HBIED"})
aAdd(aPostos,{"24478","9HCWOP"})
aAdd(aPostos,{"25738","9HBFF0"})
aAdd(aPostos,{"40480","9GZLSV"})
aAdd(aPostos,{"40480","9HBYIJ"})
aAdd(aPostos,{"22265","9HADFF"})
aAdd(aPostos,{"22265","9HCLAS"})
aAdd(aPostos,{"22265","9GZEIB"})
aAdd(aPostos,{"22265","9GZYDA"})
aAdd(aPostos,{"21359","9GYAJM"})
aAdd(aPostos,{"20452","9GZRZ8"})
aAdd(aPostos,{"20452","9HBK23"})
aAdd(aPostos,{"41862","9GZOND"})
aAdd(aPostos,{"41862","9HBOCT"})
aAdd(aPostos,{"42245","9GZEV9"})
aAdd(aPostos,{"42245","9HANQF"})
aAdd(aPostos,{"42245","9HANE6"})
aAdd(aPostos,{"42245","9HAXB6"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"42621","9HBPS4"})
aAdd(aPostos,{"22263","9HAVUE"})
aAdd(aPostos,{"22263","9HCTS3"})
aAdd(aPostos,{"22263","9HCPAW"})
aAdd(aPostos,{"24588","9GYYGM"})
aAdd(aPostos,{"24586","9HAQ41"})
aAdd(aPostos,{"24646","9GZDYC"})
aAdd(aPostos,{"24646","9GZDYC"})
aAdd(aPostos,{"25850","9GXXFJ"})
aAdd(aPostos,{"25850","9GXXFJ"})
aAdd(aPostos,{"25850","9HCBHN"})
aAdd(aPostos,{"29852","9GZDYC"})
aAdd(aPostos,{"29852","9HCFXM"})
aAdd(aPostos,{"31089","9GXRRT"})
aAdd(aPostos,{"37577","9HBCZ1"})
aAdd(aPostos,{"41371","9GYMV5"})
aAdd(aPostos,{"41371","9GZWDK"})
aAdd(aPostos,{"41380","9HAGJ5"})
aAdd(aPostos,{"20797","9HBQTX"})
aAdd(aPostos,{"20999","9HATEH"})
aAdd(aPostos,{"20999","9HBTYE"})
aAdd(aPostos,{"20999","9HATEH"})
aAdd(aPostos,{"27738","9GYPWM"})
aAdd(aPostos,{"27738","9HBPS4"})
aAdd(aPostos,{"27738","9HCOB4"})
aAdd(aPostos,{"33712","9HBBYF"})
aAdd(aPostos,{"33712","9GZ835"})
aAdd(aPostos,{"33712","9GZRVR"})
aAdd(aPostos,{"33712","9HAHF4"})
aAdd(aPostos,{"33712","9HAPWM"})
aAdd(aPostos,{"33712","9HBC10"})
aAdd(aPostos,{"33712","9HBC83"})
aAdd(aPostos,{"33712","9HBSBN"})
aAdd(aPostos,{"35549","9GZKX0"})
aAdd(aPostos,{"35549","9GZZVF"})
aAdd(aPostos,{"35549","9GZSUC"})
aAdd(aPostos,{"35549","9HBMHI"})
aAdd(aPostos,{"42791","9GYWFF"})
aAdd(aPostos,{"42791","9GYWXU"})
aAdd(aPostos,{"42791","9HAFOM"})
aAdd(aPostos,{"44161","9HAPYD"})
aAdd(aPostos,{"44161","9GYMKJ"})
aAdd(aPostos,{"46577","9GYPCB"})
aAdd(aPostos,{"46577","9GYPDZ"})
aAdd(aPostos,{"46577","9GYOTZ"})
aAdd(aPostos,{"46577","9H9653"})
aAdd(aPostos,{"46577","9HBMM7"})
aAdd(aPostos,{"46577","9HBN68"})
aAdd(aPostos,{"46577","9HBN46"})
aAdd(aPostos,{"46577","9HBN79"})
aAdd(aPostos,{"46577","9HBMAW"})
aAdd(aPostos,{"50693","9HCPUU"})
aAdd(aPostos,{"54105","9GYOTG"})
aAdd(aPostos,{"54105","9HAHOE"})
aAdd(aPostos,{"31069","9HCGQ2"})
aAdd(aPostos,{"41653","9GXBHJ"})
aAdd(aPostos,{"20053","9HAAJ3"})
aAdd(aPostos,{"29769","9H8926"})
aAdd(aPostos,{"29769","9HANHT"})
aAdd(aPostos,{"37257","9GYVTD"})
aAdd(aPostos,{"38942","9GZBFJ"})
aAdd(aPostos,{"38942","9HABUK"})
aAdd(aPostos,{"42568","9GYOWJ"})
aAdd(aPostos,{"43813","9GZY38"})
aAdd(aPostos,{"46944","9HBKAC"})
aAdd(aPostos,{"21973","9H2400"})
aAdd(aPostos,{"21973","9H2400"})
aAdd(aPostos,{"21973","9H2400"})
aAdd(aPostos,{"33810","9H1844"})
aAdd(aPostos,{"34629","9H2994"})
aAdd(aPostos,{"29653","9HCZFS"})
aAdd(aPostos,{"44013","9GXSOU"})
aAdd(aPostos,{"46420","9GZJAM"})
aAdd(aPostos,{"46961","9HAFZW"})
aAdd(aPostos,{"46961","9HBGHZ"})
aAdd(aPostos,{"46961","9HDBXZ"})
aAdd(aPostos,{"46969","9GZNIU"})
aAdd(aPostos,{"46969","9HCNY0"})
aAdd(aPostos,{"48293","9GXHPF"})
aAdd(aPostos,{"34394","9GZE77"})
aAdd(aPostos,{"34394","9H7976"})
aAdd(aPostos,{"34394","9HAIWL"})
aAdd(aPostos,{"34394","9HAVVE"})
aAdd(aPostos,{"34394","9HBBSV"})
aAdd(aPostos,{"34394","9HBQU0"})
aAdd(aPostos,{"34394","9GXIPA"})
aAdd(aPostos,{"34394","9GYBVY"})
aAdd(aPostos,{"34394","9GZMF1"})
aAdd(aPostos,{"34394","9H1370"})
aAdd(aPostos,{"34394","9HAYUE"})
aAdd(aPostos,{"34394","9HAZT4"})
aAdd(aPostos,{"38989","9HASKT"})
aAdd(aPostos,{"38989","9GZ794"})
aAdd(aPostos,{"38989","9HAJJD"})
aAdd(aPostos,{"38989","9GYBNU"})
aAdd(aPostos,{"38989","9GYBUI"})
aAdd(aPostos,{"38989","9GZHN5"})
aAdd(aPostos,{"38989","9HAJNQ"})
aAdd(aPostos,{"35789","9HAG60"})
aAdd(aPostos,{"35789","9HAG60"})
aAdd(aPostos,{"46698","9H1298"})
aAdd(aPostos,{"47872","9HA648"})
aAdd(aPostos,{"44183","9GXTY6"})
aAdd(aPostos,{"31322","9H1207"})
aAdd(aPostos,{"30810","9HABES"})
aAdd(aPostos,{"31153","9GYWWX"})
aAdd(aPostos,{"31153","9GZUPF"})
aAdd(aPostos,{"31154","9GYONP"})
aAdd(aPostos,{"31159","9GZI23"})
aAdd(aPostos,{"31156","9GZJEJ"})
aAdd(aPostos,{"31174","9GYXJC"})
aAdd(aPostos,{"31169","9HCBQ7"})
aAdd(aPostos,{"31169","9HCBQ7"})
aAdd(aPostos,{"41704","9GZCRV"})
aAdd(aPostos,{"45440","9HAOEG"})
aAdd(aPostos,{"47048","9HAMES"})
aAdd(aPostos,{"37371","9GYYX3"})
aAdd(aPostos,{"37371","9GYUBF"})
aAdd(aPostos,{"37371","9GYZLN"})
aAdd(aPostos,{"37371","9GYYX3"})
aAdd(aPostos,{"37371","9HAOS1"})
aAdd(aPostos,{"37371","9HBXSG"})
aAdd(aPostos,{"37371","9HCJYD"})
aAdd(aPostos,{"37371","9HCOLT"})
aAdd(aPostos,{"46708","9GYTHH"})
aAdd(aPostos,{"42700","9GYTY5"})
aAdd(aPostos,{"47349","9HBML4"})
aAdd(aPostos,{"41272","9GYXT9"})
aAdd(aPostos,{"41272","9GZHAS"})
aAdd(aPostos,{"41272","9HABBE"})
aAdd(aPostos,{"41272","9HCWVI"})
aAdd(aPostos,{"41272","9H1212"})
aAdd(aPostos,{"41272","9H1548"})
aAdd(aPostos,{"41272","9HAEUR"})
aAdd(aPostos,{"47323","9H1270"})
aAdd(aPostos,{"47346","9GZE77"})
aAdd(aPostos,{"41293","9HCARB"})
aAdd(aPostos,{"42553","9HALC5"})
aAdd(aPostos,{"42553","9HCGEY"})
aAdd(aPostos,{"42553","9HBUQ3"})
aAdd(aPostos,{"42557","9HAVBL"})
aAdd(aPostos,{"42557","9HAVBL"})
aAdd(aPostos,{"42557","9HAVBL"})
aAdd(aPostos,{"41454","9HCGLX"})
aAdd(aPostos,{"43285","9GYP42"})
aAdd(aPostos,{"43285","9HCTKI"})
aAdd(aPostos,{"37630","9HCHPL"})
aAdd(aPostos,{"37630","9HCHPL"})
aAdd(aPostos,{"37630","9HCHPL"})
aAdd(aPostos,{"42293","9GYLLW"})
aAdd(aPostos,{"47903","9GYZGQ"})
aAdd(aPostos,{"47903","9GYZGQ"})
aAdd(aPostos,{"39209","9HACNG"})
aAdd(aPostos,{"43395","9GZDYC"})
aAdd(aPostos,{"43395","9HABU1"})
aAdd(aPostos,{"45797","9HCAI1"})
aAdd(aPostos,{"49464","9HAVE0"})
aAdd(aPostos,{"52805","9GYBN6"})
aAdd(aPostos,{"45913","9GYCR7"})
aAdd(aPostos,{"40229","9GZR53"})
aAdd(aPostos,{"40229","9HCRPY"})
aAdd(aPostos,{"40229","9GZZQL"})
aAdd(aPostos,{"40229","9HBUKM"})
aAdd(aPostos,{"45117","9HBW95"})
aAdd(aPostos,{"45117","9HCPCA"})
aAdd(aPostos,{"45117","9HAINU"})
aAdd(aPostos,{"45168","9GZYGS"})
aAdd(aPostos,{"52049","9HCIJS"})
aAdd(aPostos,{"40149","9HAZEX"})
aAdd(aPostos,{"40149","9HCCB1"})
aAdd(aPostos,{"40149","9HBJE8"})
aAdd(aPostos,{"47424","9HCHVX"})
aAdd(aPostos,{"51470","9HAUG1"})
aAdd(aPostos,{"55074","9GYMJH"})
aAdd(aPostos,{"55074","9HCWQP"})
aAdd(aPostos,{"49077","9GZ708"})
aAdd(aPostos,{"45924","9HA217"})
aAdd(aPostos,{"50643","9GYUEZ"})
aAdd(aPostos,{"44269","9HCXN0"})
aAdd(aPostos,{"44269","9GYT89"})
aAdd(aPostos,{"52810","9GYUX4"})
aAdd(aPostos,{"52810","9HARHR"})
aAdd(aPostos,{"42827","9H4932"})
aAdd(aPostos,{"42827","9GXHU9"})
aAdd(aPostos,{"42827","9GYJZK"})
aAdd(aPostos,{"43210","9HAXWD"})
aAdd(aPostos,{"45804","9HBIEH"})
aAdd(aPostos,{"47469","9GZJBX"})
aAdd(aPostos,{"52566","9H6973"})
aAdd(aPostos,{"52566","9HADM9"})
aAdd(aPostos,{"52566","9HCGQQ"})
aAdd(aPostos,{"52566","9H6973"})
aAdd(aPostos,{"52566","9HAUTH"})
aAdd(aPostos,{"52566","9HBNX8"})
aAdd(aPostos,{"42783","9GYOP7"})
aAdd(aPostos,{"42783","9HACDM"})
aAdd(aPostos,{"52372","9HAJTR"})
aAdd(aPostos,{"52410","9HBCJC"})
aAdd(aPostos,{"52410","9HCE69"})
aAdd(aPostos,{"52413","9HBDDQ"})
aAdd(aPostos,{"52413","9HBDDQ"})
aAdd(aPostos,{"52422","9HCOED"})
aAdd(aPostos,{"52487","9GZQYR"})
aAdd(aPostos,{"51703","9H4371"})
aAdd(aPostos,{"44947","9HACPF"})
aAdd(aPostos,{"35790","9GZFGJ"})
aAdd(aPostos,{"35790","9GYUM9"})
aAdd(aPostos,{"35790","9HALHY"})
aAdd(aPostos,{"46443","9HAFZP"})
aAdd(aPostos,{"45572","9HAPTN"})
aAdd(aPostos,{"45593","9GYWWP"})
aAdd(aPostos,{"45593","9GZJP7"})
aAdd(aPostos,{"45593","9HBZSM"})
aAdd(aPostos,{"45297","9HACNW"})
aAdd(aPostos,{"49218","9HCEEB"})
aAdd(aPostos,{"47943","9HBSX7"})
aAdd(aPostos,{"47943","9HCBRO"})
aAdd(aPostos,{"47943","9HCZLH"})
aAdd(aPostos,{"47943","9HBPEN"})
aAdd(aPostos,{"46194","9HAVSX"})
aAdd(aPostos,{"46194","9HBFR4"})
aAdd(aPostos,{"46015","9GYOS5"})
aAdd(aPostos,{"48103","9GZKA8"})
aAdd(aPostos,{"48103","9GYJZS"})
aAdd(aPostos,{"49818","9HAB23"})
aAdd(aPostos,{"51776","9GYWZG"})
aAdd(aPostos,{"50594","9GXZ08"})
aAdd(aPostos,{"51986","9GYYEV"})
aAdd(aPostos,{"51986","9GZNFQ"})
aAdd(aPostos,{"51986","9HAHW4"})
aAdd(aPostos,{"51986","9HASVW"})
aAdd(aPostos,{"54931","9GYP60"})
aAdd(aPostos,{"54931","9GYTUG"})
aAdd(aPostos,{"50126","9GYM86"})
aAdd(aPostos,{"50126","9H1362"})
aAdd(aPostos,{"49560","9GZFP7"})
aAdd(aPostos,{"52843","9GYADM"})
	

For Ni := 1 To Len(aPostos)
	
	dbSelectArea("SC5")
	SC5->(dbSetOrder(1))
	If SC5->(dbSeek(xFilial("SC5") + aPostos[Ni][2]))
		If Empty(SC5->C5_XPOSTO)
			RecLock("SC5",.F.)
				SC5->C5_XPOSTO := aPostos[Ni][1]
			SC5->(MsUnlock())
			aAdd(aLog,"Posto incluído: " + SC5->C5_XPOSTO + "/ Pedido: " + SC5->C5_NUM)
		Else
			aAdd(aLog,"Posto mantido: " + SC5->C5_XPOSTO + "/ Pedido: " + SC5->C5_NUM)
		EndIf
	EndIf
	
Next

Processa({|| MostraLog(aLog)},"Processando","Gerando Log",.F.)

Return

Static Function MostraLog(aLog)
Local oDlg
Local oFont 
Local cMemo := ""
Local Ni	:= 0

	ProcRegua(Len(aLog))

	For Ni := 1 To Len(aLog)
		IncProc()
		cMemo += aLog[Ni] + CHR(13) + CHR(10)
	Next

	DEFINE FONT oFont NAME "Courier New" SIZE 5,0   //6,15

	DEFINE MSDIALOG oDlg TITLE "cFullLog" From 3,0 to 340,417 PIXEL

	@ 5,5 GET oMemo  VAR cMemo MEMO SIZE 200,145 OF oDlg PIXEL 
	oMemo:bRClicked := {||AllwaysTrue()}
	oMemo:oFont:=oFont

	DEFINE SBUTTON  FROM 153,175 TYPE 1 ACTION oDlg:End() ENABLE OF oDlg PIXEL //Apaga
	//DEFINE SBUTTON  FROM 153,145 TYPE 13 ACTION (cFile:=cGetFile(cMask,OemToAnsi("Salvar")),If(cFile="",.t.,MemoWrite(cFile,cMemo)),oDlg:End()) ENABLE OF oDlg PIXEL 
	//DEFINE SBUTTON  FROM 153,115 TYPE 6 ACTION (PrintAErr(cFullLog),oDlg:End()) ENABLE OF oDlg PIXEL //Imprime e Apaga

	ACTIVATE MSDIALOG oDlg CENTER

Return


User FUNCTION CRPA060C()

	Local aPedidos := {}
	Local aLog		:= {}
	Local Ni	:= 0
	
	aAdd(aPedidos,"11109195")
aAdd(aPedidos,"11201477")
aAdd(aPedidos,"11201636")
aAdd(aPedidos,"11107558")
aAdd(aPedidos,"11186908")
aAdd(aPedidos,"11186625")
aAdd(aPedidos,"11125219")
aAdd(aPedidos,"11123258")
aAdd(aPedidos,"11123552")
aAdd(aPedidos,"11123648")
aAdd(aPedidos,"11123807")
aAdd(aPedidos,"11123890")
aAdd(aPedidos,"11123994")
aAdd(aPedidos,"11124401")
aAdd(aPedidos,"11124349")
aAdd(aPedidos,"11136822")
aAdd(aPedidos,"11193385")
aAdd(aPedidos,"11180421")
aAdd(aPedidos,"11085609")
aAdd(aPedidos,"11123388")
aAdd(aPedidos,"11124278")
aAdd(aPedidos,"11132452")
aAdd(aPedidos,"11224772")
aAdd(aPedidos,"11228992")
aAdd(aPedidos,"11127158")
aAdd(aPedidos,"11172828")
aAdd(aPedidos,"11266303")
aAdd(aPedidos,"11095748")
aAdd(aPedidos,"11156529")
aAdd(aPedidos,"11172641")
aAdd(aPedidos,"11123200")
aAdd(aPedidos,"11205366")
aAdd(aPedidos,"11104678")
aAdd(aPedidos,"11148663")
aAdd(aPedidos,"11200402")
aAdd(aPedidos,"11219474")
aAdd(aPedidos,"11139166")
aAdd(aPedidos,"11212400")
aAdd(aPedidos,"11111867")
aAdd(aPedidos,"11135739")
aAdd(aPedidos,"11153874")
aAdd(aPedidos,"11188291")
aAdd(aPedidos,"11192205")
aAdd(aPedidos,"11089834")
aAdd(aPedidos,"11270974")
aAdd(aPedidos,"11142472")
aAdd(aPedidos,"11170712")
aAdd(aPedidos,"11247802")
aAdd(aPedidos,"11098633")
aAdd(aPedidos,"11129029")
aAdd(aPedidos,"11170017")
aAdd(aPedidos,"11222449")
aAdd(aPedidos,"11239030")
aAdd(aPedidos,"11212855")
aAdd(aPedidos,"11172345")
aAdd(aPedidos,"11148014")
aAdd(aPedidos,"11189839")
aAdd(aPedidos,"11110792")
aAdd(aPedidos,"11201058")
aAdd(aPedidos,"11255260")
aAdd(aPedidos,"11143196")
aAdd(aPedidos,"11156696")
aAdd(aPedidos,"11163524")
aAdd(aPedidos,"11232646")
aAdd(aPedidos,"11122637")
aAdd(aPedidos,"11239443")
aAdd(aPedidos,"11153175")
aAdd(aPedidos,"11183887")
aAdd(aPedidos,"11084365")
aAdd(aPedidos,"11179180")
aAdd(aPedidos,"11257368")
aAdd(aPedidos,"11253927")
aAdd(aPedidos,"11120529")
aAdd(aPedidos,"11175113")
aAdd(aPedidos,"11219851")
aAdd(aPedidos,"11090514")
aAdd(aPedidos,"11169481")
aAdd(aPedidos,"11241646")
aAdd(aPedidos,"11126734")
aAdd(aPedidos,"11175243")
aAdd(aPedidos,"11106693")
aAdd(aPedidos,"11260366")
aAdd(aPedidos,"11240860")
aAdd(aPedidos,"11165388")
aAdd(aPedidos,"11243947")
aAdd(aPedidos,"11149878")
aAdd(aPedidos,"11156505")
aAdd(aPedidos,"11191548")
aAdd(aPedidos,"11212057")
aAdd(aPedidos,"11131328")
aAdd(aPedidos,"11203552")
aAdd(aPedidos,"11238997")
aAdd(aPedidos,"11137998")
aAdd(aPedidos,"11122036")
aAdd(aPedidos,"11230654")
aAdd(aPedidos,"11198808")
aAdd(aPedidos,"11136961")
aAdd(aPedidos,"11197138")
aAdd(aPedidos,"11223109")
aAdd(aPedidos,"11187157")
aAdd(aPedidos,"11254038")
aAdd(aPedidos,"11148501")
aAdd(aPedidos,"11170450")
aAdd(aPedidos,"11112721")
aAdd(aPedidos,"11130324")
aAdd(aPedidos,"11213593")
aAdd(aPedidos,"11248674")
aAdd(aPedidos,"11130112")
aAdd(aPedidos,"11243066")
aAdd(aPedidos,"11096958")
aAdd(aPedidos,"11129506")
aAdd(aPedidos,"11153017")
aAdd(aPedidos,"11136060")
aAdd(aPedidos,"11153852")
aAdd(aPedidos,"11178816")
aAdd(aPedidos,"11247999")
aAdd(aPedidos,"11133458")
aAdd(aPedidos,"11187297")
aAdd(aPedidos,"11162845")
aAdd(aPedidos,"11122707")
aAdd(aPedidos,"11128649")
aAdd(aPedidos,"11164567")
aAdd(aPedidos,"11191626")
aAdd(aPedidos,"11178963")
aAdd(aPedidos,"11177198")
aAdd(aPedidos,"11160476")
aAdd(aPedidos,"11226976")
aAdd(aPedidos,"11083240")
aAdd(aPedidos,"11240760")
aAdd(aPedidos,"11147766")
aAdd(aPedidos,"11174101")
aAdd(aPedidos,"11242541")
aAdd(aPedidos,"11218403")
aAdd(aPedidos,"11254151")
aAdd(aPedidos,"11135254")
aAdd(aPedidos,"11258069")
aAdd(aPedidos,"11188103")
aAdd(aPedidos,"11201966")
aAdd(aPedidos,"11256996")
aAdd(aPedidos,"11188638")
aAdd(aPedidos,"11118650")
aAdd(aPedidos,"11118698")
aAdd(aPedidos,"11118709")
aAdd(aPedidos,"11118741")
aAdd(aPedidos,"11227910")
aAdd(aPedidos,"11234231")
aAdd(aPedidos,"11210264")
aAdd(aPedidos,"11210304")
aAdd(aPedidos,"11210332")
aAdd(aPedidos,"11210326")
aAdd(aPedidos,"11210225")
aAdd(aPedidos,"11210282")
aAdd(aPedidos,"11170436")
aAdd(aPedidos,"11253526")
aAdd(aPedidos,"11256518")
aAdd(aPedidos,"11187265")
aAdd(aPedidos,"11257570")
aAdd(aPedidos,"11116092")
aAdd(aPedidos,"11127245")
aAdd(aPedidos,"11128178")
aAdd(aPedidos,"11132813")
aAdd(aPedidos,"11125144")
aAdd(aPedidos,"11108021")
aAdd(aPedidos,"11108169")
aAdd(aPedidos,"11211926")
aAdd(aPedidos,"11263232")
aAdd(aPedidos,"11219109")
aAdd(aPedidos,"11207137")
aAdd(aPedidos,"11253613")
aAdd(aPedidos,"11182319")
aAdd(aPedidos,"11187715")
aAdd(aPedidos,"11169491")
aAdd(aPedidos,"11209149")
aAdd(aPedidos,"11176800")
aAdd(aPedidos,"11224779")
aAdd(aPedidos,"11109773")
aAdd(aPedidos,"11149972")
aAdd(aPedidos,"11249439")
aAdd(aPedidos,"11099202")
aAdd(aPedidos,"11152151")
aAdd(aPedidos,"11152337")
aAdd(aPedidos,"11227191")
aAdd(aPedidos,"11134615")
aAdd(aPedidos,"11199090")
aAdd(aPedidos,"11237910")
aAdd(aPedidos,"11168366")
aAdd(aPedidos,"11168423")
aAdd(aPedidos,"11228264")
aAdd(aPedidos,"11227754")
aAdd(aPedidos,"11228548")
aAdd(aPedidos,"11096912")
aAdd(aPedidos,"11097008")
aAdd(aPedidos,"11253853")
aAdd(aPedidos,"11206659")
aAdd(aPedidos,"11211269")
aAdd(aPedidos,"11050562")
aAdd(aPedidos,"11176110")
aAdd(aPedidos,"11177806")
aAdd(aPedidos,"11216237")
aAdd(aPedidos,"11120435")
aAdd(aPedidos,"11123279")
aAdd(aPedidos,"11130034")
aAdd(aPedidos,"11187799")
aAdd(aPedidos,"11199063")
aAdd(aPedidos,"11200939")
aAdd(aPedidos,"11245367")
aAdd(aPedidos,"11158916")
aAdd(aPedidos,"11173444")
aAdd(aPedidos,"11173556")
aAdd(aPedidos,"11173612")
aAdd(aPedidos,"11138229")
aAdd(aPedidos,"11158960")
aAdd(aPedidos,"11245567")
aAdd(aPedidos,"11084507")
aAdd(aPedidos,"11144117")
aAdd(aPedidos,"11229198")
aAdd(aPedidos,"11234567")
aAdd(aPedidos,"11244326")
aAdd(aPedidos,"11250982")
aAdd(aPedidos,"11168591")
aAdd(aPedidos,"11184106")
aAdd(aPedidos,"11202881")
aAdd(aPedidos,"11189190")
aAdd(aPedidos,"11186603")
aAdd(aPedidos,"11125654")
aAdd(aPedidos,"11162952")
aAdd(aPedidos,"11154519")
aAdd(aPedidos,"11090148")
aAdd(aPedidos,"11260063")
aAdd(aPedidos,"11210632")
aAdd(aPedidos,"11165917")
aAdd(aPedidos,"11270339")
aAdd(aPedidos,"11139979")
aAdd(aPedidos,"11225777")
aAdd(aPedidos,"11145914")
aAdd(aPedidos,"11228826")
aAdd(aPedidos,"11241445")
aAdd(aPedidos,"11242042")
aAdd(aPedidos,"11187110")
aAdd(aPedidos,"11132541")
aAdd(aPedidos,"11136020")
aAdd(aPedidos,"11138306")
aAdd(aPedidos,"11138880")
aAdd(aPedidos,"11239634")
aAdd(aPedidos,"11125040")
aAdd(aPedidos,"11230461")
aAdd(aPedidos,"11149283")
aAdd(aPedidos,"11137819")
aAdd(aPedidos,"11243141")
aAdd(aPedidos,"11220469")
aAdd(aPedidos,"11163365")
aAdd(aPedidos,"11118592")
aAdd(aPedidos,"11166803")
aAdd(aPedidos,"11175184")
aAdd(aPedidos,"11171608")
aAdd(aPedidos,"11186749")
aAdd(aPedidos,"11231393")
aAdd(aPedidos,"11186646")
aAdd(aPedidos,"11236650")
aAdd(aPedidos,"11140220")
aAdd(aPedidos,"11121296")
aAdd(aPedidos,"11116014")
aAdd(aPedidos,"11221765")
aAdd(aPedidos,"11266553")
aAdd(aPedidos,"11218527")
aAdd(aPedidos,"11156901")
aAdd(aPedidos,"11239177")
aAdd(aPedidos,"11114706")
aAdd(aPedidos,"11163424")
aAdd(aPedidos,"11223664")
aAdd(aPedidos,"11159941")
aAdd(aPedidos,"11228123")
aAdd(aPedidos,"11148986")
aAdd(aPedidos,"11198367")
aAdd(aPedidos,"11197899")
aAdd(aPedidos,"11208634")
aAdd(aPedidos,"11229787")
aAdd(aPedidos,"11207169")
aAdd(aPedidos,"11263411")
aAdd(aPedidos,"11258401")
aAdd(aPedidos,"11140701")
aAdd(aPedidos,"11200954")
aAdd(aPedidos,"11110343")
aAdd(aPedidos,"11243428")
aAdd(aPedidos,"11248352")
aAdd(aPedidos,"11104198")
aAdd(aPedidos,"11216070")
aAdd(aPedidos,"11128193")
aAdd(aPedidos,"11168367")
aAdd(aPedidos,"11190508")
aAdd(aPedidos,"11230972")
aAdd(aPedidos,"11204402")
aAdd(aPedidos,"11234370")
aAdd(aPedidos,"11131459")
aAdd(aPedidos,"11257333")
aAdd(aPedidos,"11214992")
aAdd(aPedidos,"11143427")
aAdd(aPedidos,"11163543")
aAdd(aPedidos,"11191475")
aAdd(aPedidos,"11200766")
aAdd(aPedidos,"11215040")
aAdd(aPedidos,"11215108")
aAdd(aPedidos,"11232424")
aAdd(aPedidos,"11155719")
aAdd(aPedidos,"11172289")
aAdd(aPedidos,"11164554")
aAdd(aPedidos,"11226173")
aAdd(aPedidos,"11138492")
aAdd(aPedidos,"11139182")
aAdd(aPedidos,"11189695")
aAdd(aPedidos,"11200849")
aAdd(aPedidos,"11127781")
aAdd(aPedidos,"11130731")
aAdd(aPedidos,"11130811")
aAdd(aPedidos,"11130318")
aAdd(aPedidos,"11178123")
aAdd(aPedidos,"11226327")
aAdd(aPedidos,"11226908")
aAdd(aPedidos,"11226917")
aAdd(aPedidos,"11226939")
aAdd(aPedidos,"11225889")
aAdd(aPedidos,"11259149")
aAdd(aPedidos,"11130314")
aAdd(aPedidos,"11191821")
aAdd(aPedidos,"11249159")
aAdd(aPedidos,"11085981")
aAdd(aPedidos,"11184007")
aAdd(aPedidos,"11181636")
aAdd(aPedidos,"11198026")
aAdd(aPedidos,"11137927")
aAdd(aPedidos,"11145142")
aAdd(aPedidos,"11185534")
aAdd(aPedidos,"11130420")
aAdd(aPedidos,"11169877")
aAdd(aPedidos,"11223744")
aAdd(aPedidos,"11175182")
aAdd(aPedidos,"11149899")
aAdd(aPedidos,"11149848")
aAdd(aPedidos,"11269515")
aAdd(aPedidos,"11105181")
aAdd(aPedidos,"11154072")
aAdd(aPedidos,"11190090")
aAdd(aPedidos,"11219722")
aAdd(aPedidos,"11273406")
aAdd(aPedidos,"11158697")
aAdd(aPedidos,"11257104")
aAdd(aPedidos,"11096159")
aAdd(aPedidos,"11148140")
aAdd(aPedidos,"11180530")
aAdd(aPedidos,"11193220")
aAdd(aPedidos,"11207220")
aAdd(aPedidos,"11214767")
aAdd(aPedidos,"11230974")
aAdd(aPedidos,"11098163")
aAdd(aPedidos,"11116278")
aAdd(aPedidos,"11157443")
aAdd(aPedidos,"11174082")
aAdd(aPedidos,"11210427")
aAdd(aPedidos,"11211515")
aAdd(aPedidos,"11203610")
aAdd(aPedidos,"11143398")
aAdd(aPedidos,"11193813")
aAdd(aPedidos,"11115988")
aAdd(aPedidos,"11116223")
aAdd(aPedidos,"11152192")
aAdd(aPedidos,"11193968")
aAdd(aPedidos,"11190163")
aAdd(aPedidos,"11174000")
aAdd(aPedidos,"11183165")
aAdd(aPedidos,"11106649")
aAdd(aPedidos,"11173912")
aAdd(aPedidos,"11184928")
aAdd(aPedidos,"11139155")
aAdd(aPedidos,"11166538")
aAdd(aPedidos,"11130087")
aAdd(aPedidos,"11152798")
aAdd(aPedidos,"11154023")
aAdd(aPedidos,"11139763")
aAdd(aPedidos,"11243729")
aAdd(aPedidos,"11146684")
aAdd(aPedidos,"11198991")
aAdd(aPedidos,"11196856")
aAdd(aPedidos,"11141323")
aAdd(aPedidos,"11136194")
aAdd(aPedidos,"11141978")
aAdd(aPedidos,"11199518")
aAdd(aPedidos,"11238492")
aAdd(aPedidos,"11252732")
aAdd(aPedidos,"11257728")
aAdd(aPedidos,"11135320")
aAdd(aPedidos,"11135953")
aAdd(aPedidos,"11226308")
aAdd(aPedidos,"11140088")
aAdd(aPedidos,"11151772")
aAdd(aPedidos,"11184799")
aAdd(aPedidos,"11266812")
aAdd(aPedidos,"11173917")
aAdd(aPedidos,"11174035")
aAdd(aPedidos,"11188800")
aAdd(aPedidos,"11173964")
aAdd(aPedidos,"11242721")
aAdd(aPedidos,"11195649")
aAdd(aPedidos,"11248731")
aAdd(aPedidos,"11235160")
aAdd(aPedidos,"11206476")
aAdd(aPedidos,"11249020")
aAdd(aPedidos,"11130590")
aAdd(aPedidos,"11263123")
aAdd(aPedidos,"11250200")
aAdd(aPedidos,"11126752")
aAdd(aPedidos,"11141796")
aAdd(aPedidos,"11186372")
aAdd(aPedidos,"11185497")
aAdd(aPedidos,"11242375")
aAdd(aPedidos,"11206561")
aAdd(aPedidos,"11115939")
aAdd(aPedidos,"11117201")
aAdd(aPedidos,"11162644")
aAdd(aPedidos,"11261212")
aAdd(aPedidos,"11172082")
aAdd(aPedidos,"11234949")
aAdd(aPedidos,"11236701")
aAdd(aPedidos,"11258465")
aAdd(aPedidos,"11192869")
aAdd(aPedidos,"11170627")
aAdd(aPedidos,"11251095")
aAdd(aPedidos,"11210944")
aAdd(aPedidos,"11244235")
aAdd(aPedidos,"11222811")
aAdd(aPedidos,"11250442")
aAdd(aPedidos,"11205557")
aAdd(aPedidos,"11127749")
aAdd(aPedidos,"11266635")
aAdd(aPedidos,"11143305")
aAdd(aPedidos,"11182757")
aAdd(aPedidos,"11136302")
aAdd(aPedidos,"11267603")
aAdd(aPedidos,"11135008")
aAdd(aPedidos,"11136983")
aAdd(aPedidos,"11202385")
aAdd(aPedidos,"11177239")
aAdd(aPedidos,"11098961")
aAdd(aPedidos,"11125095")
aAdd(aPedidos,"11209435")
aAdd(aPedidos,"11221770")
aAdd(aPedidos,"11153997")
aAdd(aPedidos,"11179544")
aAdd(aPedidos,"11187397")
aAdd(aPedidos,"11249176")
aAdd(aPedidos,"11206069")
aAdd(aPedidos,"11227838")
aAdd(aPedidos,"11130120")
aAdd(aPedidos,"11186013")
aAdd(aPedidos,"11194181")
aAdd(aPedidos,"11215480")
aAdd(aPedidos,"11246320")
aAdd(aPedidos,"11216371")
aAdd(aPedidos,"11257446")
aAdd(aPedidos,"11162559")
aAdd(aPedidos,"11149965")
aAdd(aPedidos,"11186434")
aAdd(aPedidos,"11149544")
aAdd(aPedidos,"11136587")
aAdd(aPedidos,"11195889")
aAdd(aPedidos,"11190099")
aAdd(aPedidos,"11200631")
aAdd(aPedidos,"11139129")
aAdd(aPedidos,"11154555")
aAdd(aPedidos,"11240648")
aAdd(aPedidos,"11186378")
aAdd(aPedidos,"11246516")
aAdd(aPedidos,"11233236")
aAdd(aPedidos,"11243795")
aAdd(aPedidos,"11269733")
aAdd(aPedidos,"11229266")
aAdd(aPedidos,"11207140")
aAdd(aPedidos,"11218991")
aAdd(aPedidos,"11130259")
aAdd(aPedidos,"11155027")
aAdd(aPedidos,"11125115")
aAdd(aPedidos,"11184679")
aAdd(aPedidos,"11139225")
aAdd(aPedidos,"11112151")
aAdd(aPedidos,"11140633")
aAdd(aPedidos,"11158576")
aAdd(aPedidos,"11192088")
aAdd(aPedidos,"11204003")
aAdd(aPedidos,"11130608")
aAdd(aPedidos,"11135798")
aAdd(aPedidos,"11127388")
aAdd(aPedidos,"11174076")
aAdd(aPedidos,"11150271")
aAdd(aPedidos,"11114491")

	dbSelectArea("SC5")
	SC5->(dbOrderNickname("PEDSITE"))
	
	dbSelectArea("SC6")
	SC6->(dbSetOrder(1))

	For Ni := 1 To Len(aPedidos)
	
		If SC5->(dbSeek(xFilial("SC5") + aPedidos[Ni]))
			If SC6->(dbSeek(xFilial("SC6") + SC5->C5_NUM))
	
				While SC6->(!EoF()) .And. SC6->C6_NUM == SC5->C5_NUM
	
					If (SC6->C6_XOPER == "53" .OR. SC6->C6_XOPER == "62" .Or. SC6->C6_XOPER == "01") .AND. !Empty(SC5->C5_XPOSTO) .AND. !Empty(SC5->C5_XNPSITE)//Venda Avulsa
						
						//nCounter++
						
						dbSelectArea("SF2")
						SF2->(dbSetOrder(1))
						SF2->(dbSeek(xFilial("SF2") + SC6->C6_NOTA + SC6->C6_SERIE))
						
						//Campos adicionados para a gravação de informações perinentes a midia avulsa
						SZ5->(DbselectArea("SZ5"))
						
						Reclock('SZ5',.T.)
						SZ5->Z5_EMISSAO := SF2->F2_EMISSAO
						SZ5->Z5_VALOR   := SC6->C6_VALOR
						SZ5->Z5_PRODUTO := SC6->C6_PRODUTO
						SZ5->Z5_DESPRO  := SC6->C6_DESCRI
						SZ5->Z5_CODVOU  := SC6->C6_XNUMVOU
						SZ5->Z5_PRODGAR := SC6->C6_PROGAR
						SZ5->Z5_TIPO    := "ENTHAR"                           //REMUNERA O POSTO/AR PELA ENTREGA DA MÍDIA
						SZ5->Z5_TIPODES := "ENTREGA HARDWARE AVULSO"
						SZ5->Z5_VALORHW := SC6->C6_VALOR
						SZ5->Z5_PEDIDO  := SC6->C6_NUM
						SZ5->Z5_ITEMPV  := SC6->C6_ITEM
						SZ5->Z5_ROTINA  := "M460FIM"
						SZ5->Z5_CODPOS  := SC5->C5_XPOSTO
						SZ5->Z5_TIPMOV  := SC5->C5_TIPMOV
						SZ5->Z5_TABELA  := SC5->C5_TABELA
						SZ5->Z5_PEDSITE := SC5->C5_XNPSITE
						
						SZ3->(DbSetOrder(6))
						If SZ3->(DbSeek(xFilial("SZ3") + "4" + SZ5->Z5_CODPOS))
							SZ5->Z5_DESPOS	:= SZ3->Z3_DESENT
							SZ5->Z5_REDE    := SZ3->Z3_REDE
							SZ5->Z5_DESCAR	:= SZ3->Z3_DESAR
						EndIf
						
						SZ5->(MsUnlock())
						aAdd(aLog, "Incluir :" + SC6->C6_NUM + "/" + SC6->C6_ITEM + " / Recno SZ5: " + cValToChar(SZ5->(Recno())) ) 
					EndIf
				
					SC6->(dbSkip())
				EndDo
			EndIf
		EndIf
	Next
	
	Processa({|| MostraLog(aLog)},"Processando","Gerando Log",.F.)
	
Return

User Function CR60FIXDATE()

    Local aPergs    := {}
    Local aPedidos  := {}
    Local Ni

    Private aRet    := {}

    aAdd(aPergs, {11, "Pedidos", "", '.T.', '.T.', .T.})

    If !Parambox(aPergs, "Ajusta Data", @aRet)
        Alert("Processo interrompido.")
        Return
    EndIf

    aPedidos := StrToArray(aRet[1], CHR(13) + CHR(10))

    For Ni := 1 To Len(aPedidos)
        
        dbSelectArea("SZ5")
        
        dbSelectArea("SC5")
        dbSelectArea("SC6")

        SZ5->(dbSetOrder(3))
        SZ6->(dbSetOrder(1))


        SC5->(dbOrderNickname("PEDSITE"))
        If SC5->(dbSeek(xFilial("SC5") + aPedidos[Ni]))

            If SZ5->(dbSeek(xFilial("SZ5") + SC5->C5_NUM))

                If SC6->(dbSeek(xFilial("SC6") + SC5->C5_NUM + SZ5->Z5_ITEMPV))

                    dbSelectArea("SF2")
                    SF2->(dbSetOrder(1))
                    SF2->(dbSeek(xFilial("SF2") + SC6->C6_NOTA + SC6->C6_SERIE))

                    RecLock("SZ5", .F.)
                        SZ5->Z5_DATVER := SF2->F2_EMISSAO
                        SZ5->Z5_EMISSAO := SF2->F2_EMISSAO
                    SZ5->(MsUnlock())

					dbSelectARea("SZ6")
					SZ6->(dbSetOrder(4))
					If SZ6->(dbSeek(xFilial("SZ6") + aPedidos[Ni]))

						While SZ6->(!EoF()) .And. SZ6->Z6_FILIAL + AllTrim(SZ6->Z6_PEDSITE) == xFilial("SZ6") + aPedidos[Ni]
							RecLock("SZ6",.F.)
								SZ6->Z6_VERIFIC := SF2->F2_EMISSAO
							SZ6->(MsUnlock())
							SZ6->(dbSkip())
						EndDo

					EndIf

                EndIF

            EndIf

        EndIf

    Next

Return

User Function CR060Posto()

	Local aPergs    := {}
    Local aPedidos  := {}
    Local Ni

    Private aRet    := {}

    aAdd(aPergs, {11, "Pedidos", "", '.T.', '.T.', .T.})

    If !Parambox(aPergs, "Ajusta Data", @aRet)
        Alert("Processo interrompido.")
        Return
    EndIf

    aPedidos := StrToArray(aRet[1], CHR(13) + CHR(10))

	For Ni := 1 To Len(aPedidos)

		dbSelectArea("SZ5")
		SZ5->(dbSetOrder(1)) 
		If SZ5->(dbSeek(xFilial("SZ5") + aPedidos[Ni]))
			
			dbSelectArea("SC6")
			SC6->(dbsetOrder(16))
			If SC6->(dbSeek(xFilial("SC6") + aPedidos[Ni]))

				dbSelectArea("SC5")
				SC5->(dbSetOrder(1))
				If SC5->(dbSeek(xFilial("SC5") + SC6->C6_NUM))

					RecLock("SC5",.F.)
						SC5->C5_XPOSTO := SZ5->Z5_CODPOS
					SC5->(MsUnlock())
					
				EndIf
				
			EndIf

		EndIf

	Next

Return

User Function CR060PGAR()

	Local aPergs    := {}
    Local aPedidos  := {}
    Local Ni
	Local aLog		:= {}

    Private aRet    := {}

    aAdd(aPergs, {11, "Pedidos", "", '.T.', '.T.', .T.})

    If !Parambox(aPergs, "Pedido GAR", @aRet)
        Alert("Processo interrompido.")
        Return
    EndIf

    aPedidos := StrToArray(aRet[1], CHR(13) + CHR(10))

	For Ni := 1 To Len(aPedidos)

		dbSelectArea("SZ5")
		SZ5->(dbSetOrder(1)) 
		If SZ5->(dbSeek(xFilial("SZ5") + aPedidos[Ni]))
			
			dbSelectArea("SC6")
			SC6->(dbsetOrder(16))
			If SC6->(dbSeek(xFilial("SC6") + aPedidos[Ni]))

				dbSelectArea("SC5")
				SC5->(dbSetOrder(1))
				If SC5->(dbSeek(xFilial("SC5") + SC6->C6_NUM))

					aAdd(aLog, SZ5->Z5_PEDGAR + ";" + SC5->C5_XNPSITE)
					
				EndIf
				
			EndIf

		EndIf

	Next

	MostraLog(aLog)

Return

User Function CR060ZERA()

	Local aPergs    := {}
    Local aPedidos  := {}
    Local Ni
	Local aLog		:= {}

    Private aRet    := {}

    aAdd(aPergs, {11, "Pedidos", "", '.T.', '.T.', .T.})

    If !Parambox(aPergs, "Pedido GAR", @aRet)
        Alert("Processo interrompido.")
        Return
    EndIf

    aPedidos := StrToArray(aRet[1], CHR(13) + CHR(10))

	For Ni := 1 To Len(aPedidos)

		dbSelectArea("SZ6")
		SZ6->(dbSetOrder(1)) 
		If SZ6->(dbSeek(xFilial("SZ6") + aPedidos[Ni]))
			
			While SZ6->(!EoF()) .And. SZ6->Z6_FILIAL + AllTrim(SZ6->Z6_PEDGAR) == xFilial("SZ6") + aPedidos[Ni]

				RecLock("SZ6",.F.)
					SZ6->Z6_VALCOM := 0
				SZ6->(MsUnlock())

				aAdd(aLog, SZ6->Z6_PEDGAR + " zerado")

				SZ6->(dbSkip())
								
			EndDo

		EndIf

	Next

	MostraLog(aLog)

Return

