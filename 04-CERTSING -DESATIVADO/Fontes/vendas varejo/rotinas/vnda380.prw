#Include 'Protheus.ch'
#Include 'TopConn.ch'

/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณVNDA380 บAutor  ณDarcio R. Sporl     บ Data ณ  15/06/11   บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDesc.     ณFuncao que retorna o numero do endereco e tira o numero do  บฑฑ
ฑฑบ          ณendereco.                                                   บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Opvs x Certisign                                           บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
User Function VNDA380(cEndereco)
Local cEnd		:= ""
Local cNumEnd	:= ""
Local cNumero	:= ""
Local nPosNum	:= 0
Local nI		:= 0
	
nPosNum := 0
cNumEnd := AllTrim(cEndereco)
			
For nI := 1 To Len(cNumEnd)
	If Type(SubStr(cNumEnd,Len(cNumEnd) + 1 - nI ,1)) == "N"
		nPosNum := nPosNum + 1
	Else
		Exit
	EndIf
Next nI
			
cNumero	:= AllTrim(SubStr(cNumEnd, Len(cNumEnd) + 1 - nPosNum, nPosNum))
cEnd	:= AllTrim(StrTran(cNumEnd, cNumero, ""))
cEnd	:= AllTrim(StrTran(cEnd, ",", ""))

Return({cEnd, cNumero})