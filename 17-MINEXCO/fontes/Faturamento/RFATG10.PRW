#include "protheus.ch"
/*


Ŀ
Programa   RFATG10   Autor  Ricardo Correa de Souza  Data  01/04/2011 
                            MVG Consultoria Ltda                      
Ĵ
Descricao  Valida a Chapa (Apenas uma Vez por Pedido)                     
Ĵ
Observacao                                                                
Ĵ
Uso        Minexco  Industria e Comercio Ltda                             
Ĵ
             ATUALIZACOES SOFRIDAS DESDE A CONSTRUAO INICIAL              
Ĵ
Programador     Data                Motivo da Alteracao                  
Ĵ
                                                                         
ٱ


*/

User Function RFATG10()

//Local	cProduto 	:= aCols[n,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_PRODUTO"})]
Local	cLotectl 	:= aCols[n,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_LOTECTL"})]
                              
For i:=1 to Len(aCols)
	If i <> n
//		If  acols[i,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_PRODUTO"})] == cProduto
		If  acols[i,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_LOTECTL"})] == cLotectl		
//			MsgAlert("O produto "+Alltrim(acols[i,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_PRODUTO"})])+" j est cadastrado neste pedido.","Validao Produto","Alert")
			MsgAlert("O Lote "+Alltrim(acols[i,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_LOTECTL"})])+" com a Chapa "+Alltrim(acols[i,Ascan(aHeader,{|x| Alltrim(x[2])=="C6_X_LOTEF"})])+" j est cadastrado neste pedido.","Validao da Chapa","Alert")
			cLotectl	:=	Space(10)
		EndIf
    EndIf
Next
     
Return(cLotectl)

