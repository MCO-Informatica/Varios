#INCLUDE "PROTHEUS.CH"
#INCLUDE "TBICONN.CH"

/*

Ŀ
Programa    AtuMailCli Autor    Luiz Alberto  Data  11/11/2015
Ĵ
Descricao   Atualizao Campo Email Depto Financeiro do Cliente
ٱ

*/
User Function AtuMailCli()
Local aArea := GetArea()
Local cEmail := SA1->A1_EMAIL1
Local oEdit1
Local _oDlgDt	// Dialog Principal

DEFINE MSDIALOG _oDlgDt TITLE "Email Dpto Financeiro Cliente" FROM C(266),C(315) TO C(339),C(600) PIXEL Style DS_MODALFRAME 
_oDlgDt:lEscClose := .F. //No permite sair ao usuario se precionar o ESC
// Cria Componentes Padroes do Sistema
@ C(005),C(015) MsGet oEdit1 Var cEmail Valid(!Empty(cEmail)) Size C(100),C(009) COLOR CLR_BLACK PIXEL OF _oDlgDt
@ C(006),C(003) Say "Email: " Size C(037),C(006) COLOR CLR_BLACK PIXEL OF _oDlgDt
@ C(020),C(025) Button "&Confirme" Size C(037),C(012) ACTION (_oDlgDt:End()) PIXEL OF _oDlgDt
ACTIVATE MSDIALOG _oDlgDt CENTERED

If !Empty(cEmail)
	If RecLock("SA1",.f.)
		SA1->A1_EMAIL1 := cEmail
		SA1->(MsUnlock())
	Endif
Endif                   

RestArea(aArea)
Return .T.


/*

Ŀ
Programa      C()    Autores  Norbert/Ernani/Mansano  Data 10/05/2005
Ĵ
Descricao   Funcao responsavel por manter o Layout independente da       
            resolucao horizontal do Monitor do Usuario.                  
ٱ

*/
Static Function C(nTam)
Local nHRes	:=	oMainWnd:nClientWidth	// Resolucao horizontal do monitor
If nHRes == 640	// Resolucao 640x480 (soh o Ocean e o Classic aceitam 640)
	nTam *= 0.8
ElseIf (nHRes == 798).Or.(nHRes == 800)	// Resolucao 800x600
	nTam *= 1
Else	// Resolucao 1024x768 e acima
	nTam *= 1.28
EndIf

//Ŀ
//Tratamento para tema "Flat"
//
If "MP8" $ oApp:cVersion
	If (Alltrim(GetTheme()) == "FLAT") .Or. SetMdiChild()
		nTam *= 0.90
	EndIf
EndIf
Return Int(nTam)
