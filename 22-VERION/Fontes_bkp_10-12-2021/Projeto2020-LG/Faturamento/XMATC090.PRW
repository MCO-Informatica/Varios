#INCLUDE "MATC090.CH"
#INCLUDE "PROTHEUS.CH"

/*/


Ŀ
Funo     MATC090   Rev.   Edson Maricate         Data 10.01.2001
Ĵ
Descrio  Consulta Nota Fiscal de Saida.                             
Ĵ
 Uso       Generico                                                   
ٱ


/*/
User Function XMATC090()
//Ŀ
// Define Variaveis                                     
//
Local aCores    := {}

IF cPaisLoc == "BRA"
	aCores    := {	{  'F2_TIPO=="N"'	 , 'DISABLE'},;		// NF Normal
						{  'F2_TIPO=="P"'	 , 'BR_AZUL'},;		// NF de Compl. IPI
						{  'F2_TIPO=="I"'	 , 'BR_MARRON'},;	// NF de Compl. ICMS
						{  'F2_TIPO=="C"'	 , 'BR_PINK'},;		// NF de Compl. Preco/Frete
						{  'F2_TIPO=="B"'	 , 'BR_CINZA'},;	// NF de Beneficiamento
						{  'F2_TIPO=="D"'  , 'BR_AMARELO'} }	// NF de Devolucao
Else
	AAdd(aCores,{ 	'F2_TIPO	==	"N" 	.And. F2_TIPODOC	==	"01"', 'DISABLE'})		// NF Normal
	AAdd(aCores,{  'F2_TIPO	==	"C"	.And. F2_TIPODOC	$	"02/03"'	, 'BR_PINK'})		// NF de Compl. Preco/Frete
	AAdd(aCores,{  'F2_TIPO	==	"B"	'										, 'BR_CINZA'})		// NF de Beneficiamento
	AAdd(aCores,{  'F2_TIPO	==	"D"	.And. F2_TIPODOC	$	"06/07"' , 'BR_AMARELO'}) 	// NF de Devolucao
	AAdd(aCores,{  'F2_TIPO	==	"D"	.And. F2_TIPODOC	==	"61"' 	, 'BR_AZUL'})		// Remito de devolucao
	AAdd(aCores,{  'F2_TIPO	==	"N"	.And. F2_TIPODOC	==	"50"' 	, 'BR_MARRON'})	// Remito 
	AAdd(aCores,{  'F2_TIPO	==	"B"	.And. F2_TIPODOC	==	"54"'    , 'BR_PRETO'}) 	// Remito transferencia
Endif

Private aRotina := MenuDef()
						
//Ŀ
// Define o cabecalho da tela de atualizacoes           
//
PRIVATE cCadastro := IIf(cPaisLoc=="BRA",STR0004,STR0011) //"Consulta Nota Fiscal de Saida" ## "Consulta Documentos de Saida"
//Ŀ
// Endereca a funcao de BROWSE                          
//
mBrowse(6,1,22,75,"SF2",,,,,,aCores)

Return(.T.)

/*/


Ŀ
Programa  MenuDef    Autor  Marco Bianchi          Data 01/09/2006
Ĵ
Descrio  Utilizacao de menu Funcional                               
                                                                      
                                                                      
Ĵ
Retorno   Array com opcoes da rotina.                                 
Ĵ
ParametrosParametros do array a Rotina:                               
          1. Nome a aparecer no cabecalho                             
          2. Nome da Rotina associada                                 
          3. Reservado                                                
          4. Tipo de Transao a ser efetuada:                        
          		1 - Pesquisa e Posiciona em um Banco de Dados         
              2 - Simplesmente Mostra os Campos                       
              3 - Inclui registros no Bancos de Dados                 
              4 - Altera o registro corrente                          
              5 - Remove o registro corrente do Banco de Dados        
          5. Nivel de acesso                                          
          6. Habilita Menu Funcional                                  
Ĵ
   DATA    Programador   Manutencao efetuada                         
Ĵ
                                                                     
ٱ


/*/

Static Function MenuDef()
     
Private aRotina := {	{ STR0001,"AxPesqui"		,0,1,0,.F.},;		// "Pesquisar"
							{ STR0002,"MC090Visual"	,0,2,0,NIL},;		// "Visualizar"
							{ STR0003,"MC090Legend"	,0,5,0,NIL} }	 	// "Legenda"

If ExistBlock("MC090MNU")
	ExecBlock("MC090MNU",.F.,.F.)
EndIf

Return(aRotina)